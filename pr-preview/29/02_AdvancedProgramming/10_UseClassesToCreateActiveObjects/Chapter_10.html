<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Chapter 10: Using Classes to Create Active Objects – Beginning to Code with Python: Notes, Examples and Exercises</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-fd21d93db373728c2f8fcda4b672d2ec.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Beginning to Code with Python: Notes, Examples and Exercises</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../02_AdvancedProgramming/09_UsingClasses/Chapter_09.html">Advanced Programming</a></li><li class="breadcrumb-item"><a href="../../02_AdvancedProgramming/10_UseClassesToCreateActiveObjects/Chapter_10.html">Chapter 10: Using Classes to Create Active Objects</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../../index.html" class="sidebar-logo-link">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Programming Fundamentals</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../01_ProgrammingFundamentals/02_PythonAndProgramming/Chapter_02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 2: Python and Programming</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../01_ProgrammingFundamentals/03_PythonProgramStructure/Chapter_03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 3: Python Program Structure</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../01_ProgrammingFundamentals/04_WorkingWithVariables/Chapter_04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 4: Working With Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../01_ProgrammingFundamentals/05_MakingDecisions/Chapter_05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 5: Making Decisions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../01_ProgrammingFundamentals/06_RepeatingActionsWithLoops/Chapter_06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 6: Repeating Actions with Loops</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../01_ProgrammingFundamentals/07_UsingFunctions/Chapter_07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 7: Using Functions to Simplify Programs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../01_ProgrammingFundamentals/08_StoringCollectionsOfData/Chapter_08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 8: Storing Collections of Data</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Advanced Programming</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../02_AdvancedProgramming/09_UsingClasses/Chapter_09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 9: Use Classes to Store Data</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../02_AdvancedProgramming/09_UsingClasses/Chapter_09_ExtensionExercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extended Exercises for Chapter 9</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../02_AdvancedProgramming/10_UseClassesToCreateActiveObjects/Chapter_10.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Chapter 10: Using Classes to Create Active Objects</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../02_AdvancedProgramming/11_ObjectBasedSolutionDesign/Chapter_11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 11: Object-based Solution Design</span></a>
  </div>
</li>
          <li class="sidebar-item">
 <span class="menu-text">02_AdvancedProgramming/12_PythonApplications/Chapter12_.qmd</span>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#notes" id="toc-notes" class="nav-link active" data-scroll-target="#notes">Notes</a>
  <ul>
  <li><a href="#create-a-time-tracker" id="toc-create-a-time-tracker" class="nav-link" data-scroll-target="#create-a-time-tracker">Create a Time Tracker</a>
  <ul>
  <li><a href="#add-a-data-attribute-to-a-class" id="toc-add-a-data-attribute-to-a-class" class="nav-link" data-scroll-target="#add-a-data-attribute-to-a-class">Add a Data Attribute to a Class</a>
  <ul>
  <li><a href="#create-a-cohesive-object" id="toc-create-a-cohesive-object" class="nav-link" data-scroll-target="#create-a-cohesive-object">Create a Cohesive Object</a></li>
  </ul></li>
  <li><a href="#create-method-attributes-for-a-class" id="toc-create-method-attributes-for-a-class" class="nav-link" data-scroll-target="#create-method-attributes-for-a-class">Create Method Attributes for a Class</a>
  <ul>
  <li><a href="#code-analysis-the-get_hours_worked-method" id="toc-code-analysis-the-get_hours_worked-method" class="nav-link" data-scroll-target="#code-analysis-the-get_hours_worked-method">Code Analysis: The <code>get_hours_worked</code> Method</a></li>
  </ul></li>
  <li><a href="#add-validation-to-methods" id="toc-add-validation-to-methods" class="nav-link" data-scroll-target="#add-validation-to-methods">Add Validation to Methods</a>
  <ul>
  <li><a href="#create-class-variables" id="toc-create-class-variables" class="nav-link" data-scroll-target="#create-class-variables">Create Class Variables</a>
  <ul class="collapse">
  <li><a href="#code-analysis-using-class-variables" id="toc-code-analysis-using-class-variables" class="nav-link" data-scroll-target="#code-analysis-using-class-variables">Code Analysis: Using class variables</a></li>
  </ul></li>
  <li><a href="#create-a-static-method-to-validate-values" id="toc-create-a-static-method-to-validate-values" class="nav-link" data-scroll-target="#create-a-static-method-to-validate-values">Create a Static Method to Validate Values</a>
  <ul class="collapse">
  <li><a href="#code-analysis-creating-static-validation-methods" id="toc-code-analysis-creating-static-validation-methods" class="nav-link" data-scroll-target="#code-analysis-creating-static-validation-methods">Code Analysis: Creating Static Validation Methods</a></li>
  </ul></li>
  <li><a href="#return-status-messages-from-a-validation-method" id="toc-return-status-messages-from-a-validation-method" class="nav-link" data-scroll-target="#return-status-messages-from-a-validation-method">Return Status Messages from a Validation Method</a></li>
  <li><a href="#raise-an-exception-to-indicate-an-error" id="toc-raise-an-exception-to-indicate-an-error" class="nav-link" data-scroll-target="#raise-an-exception-to-indicate-an-error">Raise an Exception to indicate an Error</a></li>
  <li><a href="#make-something-happen-raising-exceptions-from-code" id="toc-make-something-happen-raising-exceptions-from-code" class="nav-link" data-scroll-target="#make-something-happen-raising-exceptions-from-code">Make Something Happen: Raising Exceptions from Code</a></li>
  <li><a href="#extract-an-exception-error-message" id="toc-extract-an-exception-error-message" class="nav-link" data-scroll-target="#extract-an-exception-error-message">Extract an Exception Error Message</a></li>
  <li><a href="#make-something-happen-catching-exceptions" id="toc-make-something-happen-catching-exceptions" class="nav-link" data-scroll-target="#make-something-happen-catching-exceptions">Make Something Happen: Catching Exceptions</a></li>
  <li><a href="#code-analysis-raising-and-dealing-with-exceptions" id="toc-code-analysis-raising-and-dealing-with-exceptions" class="nav-link" data-scroll-target="#code-analysis-raising-and-dealing-with-exceptions">Code Analysis: Raising and Dealing with Exceptions</a></li>
  </ul></li>
  <li><a href="#protect-a-data-attribute-against-damage" id="toc-protect-a-data-attribute-against-damage" class="nav-link" data-scroll-target="#protect-a-data-attribute-against-damage">Protect a Data Attribute against Damage</a>
  <ul>
  <li><a href="#make-something-happen-protecting-data-attributes-in-a-class" id="toc-make-something-happen-protecting-data-attributes-in-a-class" class="nav-link" data-scroll-target="#make-something-happen-protecting-data-attributes-in-a-class">Make Something Happen: Protecting Data Attributes in a Class</a></li>
  </ul></li>
  <li><a href="#protected-methods" id="toc-protected-methods" class="nav-link" data-scroll-target="#protected-methods">Protected Methods</a></li>
  </ul></li>
  <li><a href="#create-class-properties" id="toc-create-class-properties" class="nav-link" data-scroll-target="#create-class-properties">Create Class Properties</a>
  <ul>
  <li><a href="#code-analysis-properties-in-classes" id="toc-code-analysis-properties-in-classes" class="nav-link" data-scroll-target="#code-analysis-properties-in-classes">Code Analysis: Properties in Classes</a></li>
  <li><a href="#make-something-happen-investigating-properties" id="toc-make-something-happen-investigating-properties" class="nav-link" data-scroll-target="#make-something-happen-investigating-properties">Make Something Happen: Investigating Properties</a></li>
  </ul></li>
  <li><a href="#evolve-class-design" id="toc-evolve-class-design" class="nav-link" data-scroll-target="#evolve-class-design">Evolve Class Design</a>
  <ul>
  <li><a href="#code-analysis-managing-the-billing-amount" id="toc-code-analysis-managing-the-billing-amount" class="nav-link" data-scroll-target="#code-analysis-managing-the-billing-amount">Code Analysis: Managing the Billing Amount</a></li>
  <li><a href="#manage-class-versions" id="toc-manage-class-versions" class="nav-link" data-scroll-target="#manage-class-versions">Manage Class Versions</a>
  <ul>
  <li><a href="#add-a-version-attribute-to-a-class" id="toc-add-a-version-attribute-to-a-class" class="nav-link" data-scroll-target="#add-a-version-attribute-to-a-class">Add a version attribute to a class</a></li>
  <li><a href="#check-version-numbers" id="toc-check-version-numbers" class="nav-link" data-scroll-target="#check-version-numbers">Check Version Numbers</a></li>
  <li><a href="#upgrade-a-class" id="toc-upgrade-a-class" class="nav-link" data-scroll-target="#upgrade-a-class">Upgrade a Class</a></li>
  <li><a href="#make-something-happen-explore-version-management" id="toc-make-something-happen-explore-version-management" class="nav-link" data-scroll-target="#make-something-happen-explore-version-management">Make Something Happen: Explore Version Management</a></li>
  </ul></li>
  <li><a href="#the-__str__-method-in-a-class" id="toc-the-__str__-method-in-a-class" class="nav-link" data-scroll-target="#the-__str__-method-in-a-class">The <code>__str__</code> Method in a Class</a>
  <ul>
  <li><a href="#python-string-formatting" id="toc-python-string-formatting" class="nav-link" data-scroll-target="#python-string-formatting">Python String Formatting</a></li>
  <li><a href="#make-something-happen-adventures-with-string-formatting" id="toc-make-something-happen-adventures-with-string-formatting" class="nav-link" data-scroll-target="#make-something-happen-adventures-with-string-formatting">Make Something Happen: Adventures with String Formatting</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#session-tracking-in-time-tracker" id="toc-session-tracking-in-time-tracker" class="nav-link" data-scroll-target="#session-tracking-in-time-tracker">Session Tracking in Time Tracker</a>
  <ul>
  <li><a href="#code-analysis-creating-a-session-class" id="toc-code-analysis-creating-a-session-class" class="nav-link" data-scroll-target="#code-analysis-creating-a-session-class">Code Analysis: Creating a Session Class</a></li>
  <li><a href="#the-python-map-function" id="toc-the-python-map-function" class="nav-link" data-scroll-target="#the-python-map-function">The Python <code>map</code> Function</a>
  <ul>
  <li><a href="#make-something-happen-investigating-the-map-function-and-iteration" id="toc-make-something-happen-investigating-the-map-function-and-iteration" class="nav-link" data-scroll-target="#make-something-happen-investigating-the-map-function-and-iteration">Make Something Happen: Investigating the <code>map</code> Function and Iteration</a></li>
  </ul></li>
  <li><a href="#the-python-join-method" id="toc-the-python-join-method" class="nav-link" data-scroll-target="#the-python-join-method">The Python <code>join</code> Method</a>
  <ul>
  <li><a href="#make-something-happen-investigating-the-join-function" id="toc-make-something-happen-investigating-the-join-function" class="nav-link" data-scroll-target="#make-something-happen-investigating-the-join-function">Make Something Happen: Investigating the <code>join</code> Function</a></li>
  </ul></li>
  <li><a href="#exercise-playlist-storage-app" id="toc-exercise-playlist-storage-app" class="nav-link" data-scroll-target="#exercise-playlist-storage-app">Exercise: Playlist Storage App</a></li>
  </ul></li>
  <li><a href="#make-music-with-snaps" id="toc-make-music-with-snaps" class="nav-link" data-scroll-target="#make-music-with-snaps">Make Music with Snaps</a>
  <ul>
  <li><a href="#code-analysis-the-note-class" id="toc-code-analysis-the-note-class" class="nav-link" data-scroll-target="#code-analysis-the-note-class">Code Analysis: The <code>Note</code> Class</a></li>
  <li><a href="#make-something-happen-make-your-own-music" id="toc-make-something-happen-make-your-own-music" class="nav-link" data-scroll-target="#make-something-happen-make-your-own-music">Make Something Happen: Make Your Own Music</a></li>
  <li><a href="#exercise-simple-tune-creator" id="toc-exercise-simple-tune-creator" class="nav-link" data-scroll-target="#exercise-simple-tune-creator">Exercise: Simple Tune Creator</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  <li><a href="#questions-and-answers" id="toc-questions-and-answers" class="nav-link" data-scroll-target="#questions-and-answers">Questions and Answers</a></li>
  </ul>
<div class="quarto-code-links"><h2>Code Links</h2><ul><li><a href="https://github.com/flempriere/BeginToCodeWithPython/" target="_blank"><i class="bi bi-github"></i>GitHub Repo</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../02_AdvancedProgramming/09_UsingClasses/Chapter_09.html">Advanced Programming</a></li><li class="breadcrumb-item"><a href="../../02_AdvancedProgramming/10_UseClassesToCreateActiveObjects/Chapter_10.html">Chapter 10: Using Classes to Create Active Objects</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Chapter 10: Using Classes to Create Active Objects</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="notes" class="level2">
<h2 class="anchored" data-anchor-id="notes">Notes</h2>
<section id="create-a-time-tracker" class="level3">
<h3 class="anchored" data-anchor-id="create-a-time-tracker">Create a Time Tracker</h3>
<ul>
<li>Program’s tend to evolve in scope over time
<ul>
<li>Sometimes due to scope underestimation</li>
<li>Also because customers tend to request new features</li>
</ul></li>
<li>Consider the <a href="../../02_AdvancedProgramming/09_UsingClasses/Chapter_09.html#make-a-tiny-contacts-app">Tiny Contacts</a>
<ul>
<li>Client now wants to functionality to track the time spent with a client</li>
</ul></li>
<li>As usual start with the interface,</li>
</ul>
<pre class="text"><code>Time Tracker

1. New Contact
2. Find Contact
3. Edit Contact
4. Add Session
5. Exit Program

Enter your command:</code></pre>
<p>We want to now storyboard out the new <code>Add Session</code> option</p>
<pre class="text"><code>Enter your command: 4
Add Hours
Enter the Contact Name: Rob
Name: Rob Miles
Previous Hours worked: 0
Session Length: 3
Updated hours worked: 3.0</code></pre>
<p>We also want to update the <code>Find Contact</code> option to include the hours,</p>
<pre class="text"><code>Find Contact
Enter the Contact Name: Rob
Name: Rob Miles
Address: 18 Pussycat Mews, London, NE1 410S
Telephone: 1234 56789
Hours worked: 3.0</code></pre>
<section id="add-a-data-attribute-to-a-class" class="level4">
<h4 class="anchored" data-anchor-id="add-a-data-attribute-to-a-class">Add a Data Attribute to a Class</h4>
<ul>
<li>We need to store the hours worked</li>
<li>Simplest approach is to redefine the <code>Contact</code> class
<ul>
<li>Add an <code>hours_worked</code> field</li>
</ul></li>
</ul>
<div id="c7ff8467" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Contact:</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Contact with a name, address and telephone number.</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Tracks the hours worked with a client</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Attributes</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">    name : str</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">        Contact Name</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">    address : str</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">        Contact's postal or street address.</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">    telephone : str</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co">        Contact phone number (stored as a string).</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">    hours_worked : int | float</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co">        Hours worked with a Contact, initialised to 0</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co">    Examples</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co">    --------</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co">    &gt;&gt;&gt; Contact("Rob Miles", "18 Pussycat Mews, London, NE1 410S", "+44(1234) 56789")</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co">    &lt;Contact ...&gt;</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name, address, telephone):</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="co">        Create a new `Contact` instance</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="co">        ----------</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="co">        name : str</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="co">            Contact Name</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="co">        address : str</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a><span class="co">            Contact's postal or street address.</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a><span class="co">        telephone : str</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="co">            Contact phone number (stored as a string).</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.name <span class="op">=</span> name</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.address <span class="op">=</span> address</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.telephone <span class="op">=</span> telephone</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.hours_worked <span class="op">=</span> <span class="dv">0</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<ul>
<li><p>Defaulted to <code>0</code> as part of the constructor</p>
<ul>
<li>We might discuss this with the client, it’s possible a contact might have some initial consult hours</li>
</ul></li>
<li><p>From here we can add a new <code>add_session</code> function (see the <a href="./Examples/01_TimeTracker/TimeTracker.py">complete updated code</a>, in our version which supports duplicate names in the search)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> add_session():</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>      <span class="co">"""</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">      Prompts the user to add hours worked to contacts matching a search</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">      Returns</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">      -------</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">      None</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">      See Also</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">      --------</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">      find_contacts : returns contacts matching a search name</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">      """</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(<span class="st">"add session"</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>      search_name <span class="op">=</span> read_text(<span class="st">"Enter the contact name: "</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>      contact <span class="op">=</span> find_contact(search_name)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> contact <span class="op">!=</span> <span class="va">None</span>:</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>          <span class="co">#found a contact</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>          <span class="bu">print</span>(<span class="st">"Name: "</span>, contact.name)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>          <span class="bu">print</span>(<span class="st">"Previous hours worked:"</span>, contact.hours_worked)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>          session_length <span class="op">=</span> BTCInput.read_float_ranged(prompt<span class="op">=</span><span class="st">"Session length: "</span>, min_value<span class="op">=</span><span class="fl">0.5</span>, max_value<span class="op">=</span><span class="fl">3.5</span>)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>          contact.hours_worked <span class="op">=</span> contact.hours_worked <span class="op">+</span> session_length</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>          <span class="bu">print</span>(<span class="st">"Updated hours worked:"</span>, contact.hours_worked)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span>:</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>          <span class="bu">print</span>(<span class="st">"This name was not found"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p>Don’t forget we also have to update how we display contacts for the <code>Find Contact</code> functionality (or in our case the <code>display_contact</code>) function.</p>
<div id="01f361af" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> display_contact(contact):</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>      <span class="co">"""</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">      Displays the Contact details for the supplied contact</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">      Parameters</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">      ----------</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">      contact : Contact</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">          contact to display</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">      Returns</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">      -------</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">      None</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">      See Also</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">      --------</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">      display_contacts : Displays all contacts matching a search name</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co">      """</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(<span class="st">"Name:"</span>, contact.name)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(<span class="st">"Address:"</span>, contact.address)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(<span class="st">"Telephone:"</span>, contact.telephone)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(<span class="st">"Hours worked for this Contact:"</span>, contact.hours_worked, <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div></li>
<li><p>If we create a new <code>Contact</code> object then we can see how this looks,</p>
<div id="ac1e7479" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>  contact <span class="op">=</span> Contact(name<span class="op">=</span><span class="st">"Alice"</span>, address<span class="op">=</span><span class="st">"Bob St"</span>, telephone<span class="op">=</span><span class="st">"555"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  display_contact(contact)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  contact.hours_worked <span class="op">=</span> <span class="fl">5.0</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  display_contact(contact)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Name: Alice
Address: Bob St
Telephone: 555
Hours worked for this Contact: 0 

Name: Alice
Address: Bob St
Telephone: 555
Hours worked for this Contact: 5.0 
</code></pre>
</div>
</div></li>
</ul>
<section id="create-a-cohesive-object" class="level5">
<h5 class="anchored" data-anchor-id="create-a-cohesive-object">Create a Cohesive Object</h5>
<ul>
<li>When extending a program you should always look at its design</li>
<li>Code <em>rots</em> as it gets older
<ul>
<li>Gets harder to maintain and understand</li>
</ul></li>
<li>Want to make the design as clear and simple as possible</li>
<li>Like a builder we want to make houses out of walls, walls out of bricks and bricks out of clay
<ul>
<li>i.e.&nbsp;clear progression in scale and responsibility</li>
</ul></li>
<li>A technique for this is called <em>object-oriented design</em>
<ul>
<li>Objects are designed to be <em>cohesive</em></li>
<li>A cohesive object should contain all the attributes and methods to work with its domain</li>
</ul></li>
<li>For the <code>Contact</code> object we want it to be responsible for all contact information
<ul>
<li>Currently not very cohesive</li>
<li>Time Tracker works directly on <code>Contact</code> object attributes</li>
</ul></li>
<li>Business logic that applies to a <code>Contact</code> is outside the function
<ul>
<li>e.g.&nbsp;in the <code>add_session</code> function, we have hardcoded a minimum session time of half an hour and a maximum session time of three and half hours</li>
<li>This is problematic
<ol type="1">
<li>Because the numbers are just written there as opposed to being defined as constants with meaning (they are <em>magic constants</em>)</li>
<li>This data validation is external to the data storage object itself, the <code>Contact</code></li>
</ol></li>
<li>We also perform the act of updating the <code>Contact</code>’s hours worked, outside the <code>Contact</code> object</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>  session_length <span class="op">=</span> BTCInput.read_float_ranged(prompt<span class="op">=</span><span class="st">"Session length: "</span>, min_value<span class="op">=</span><span class="fl">0.5</span>, max_value<span class="op">=</span><span class="fl">3.5</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  contact.hours_worked <span class="op">=</span> contact.hours_worked <span class="op">+</span> session_length</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li>The magic constant problem is one issue,
<ul>
<li>If we were to use the <code>Contact</code> as a library object in another application, (like a graphical version) then we would have to maintain the validation code in two separate places</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Keep Business Rules in Business Objects</strong></p>
<p>The issue here is we have defined <em>business rules</em> (things our customer asks the system to do) outside of the <em>business objects</em> (things created to implement the customer’s system).</p>
</div>
</div>
<ul>
<li>A solution is to make the <code>Contact</code> object responsible for validating the session length
<ul>
<li>Any application that uses the <code>Contact</code> object will naturally use its internal validation</li>
<li>Only one location to change now</li>
</ul></li>
</ul>
</section>
</section>
<section id="create-method-attributes-for-a-class" class="level4">
<h4 class="anchored" data-anchor-id="create-method-attributes-for-a-class">Create Method Attributes for a Class</h4>
<ul>
<li><p>Any python code can access <code>hours_worked</code> in a <code>Contact</code></p>
<ul>
<li>Really only need <code>hours_worked</code> to be accessed to,
<ol type="1">
<li>Display time spent with a contact</li>
<li>Add the length of a session to <code>hours_worked</code></li>
</ol></li>
</ul></li>
<li><p>Python objects can hold method attributes</p>
<ul>
<li>Functions bound to the object</li>
</ul></li>
<li><p>Let us ask an object to do something</p></li>
<li><p>E.g. the <code>string</code> object has the method <code>upper</code> (seen in <a href="../../01_ProgrammingFundamentals/05_MakingDecisions/Chapter_05.html#compare-strings-in-programs">Chapter 5</a>)</p></li>
<li><p>Let us define two method attributes for <code>Contact</code></p>
<ul>
<li>Removes the need to directly access the attribute</li>
</ul></li>
<li><p>Start by defining a method to access the hours worked</p></li>
</ul>
<div id="6271dd73" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Contact:</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Contact with a name, address and telephone number.</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Tracks the hours worked with a client</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Attributes</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">    name : str</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">        Contact Name</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">    address : str</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">        Contact's postal or street address</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">    telephone : str</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">        Contact phone number (stored as a string)</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co">    hours_worked : int | float</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co">        Hours worked with a Contact, initialised to 0</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co">    Examples</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co">    --------</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co">    &gt;&gt;&gt; Contact("Rob Miles", "18 Pussycat Mews, London, NE1 410S", "+44(1234) 56789")</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co">    &lt;Contact ...&gt;</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name, address, telephone):</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="co">        Create a new `Contact` instance</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="co">        ----------</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="co">        name : str</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="co">            Contact Name</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a><span class="co">        address : str</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a><span class="co">            Contact's postal or street address.</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a><span class="co">        telephone : str</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="co">            Contact phone number (stored as a string).</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.name <span class="op">=</span> name</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.address <span class="op">=</span> address</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.telephone <span class="op">=</span> telephone</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.hours_worked <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_hours_worked(<span class="va">self</span>):</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a><span class="co">        Get the hours worked for this contact</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.hours_worked</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="code-analysis-the-get_hours_worked-method" class="level5">
<h5 class="anchored" data-anchor-id="code-analysis-the-get_hours_worked-method">Code Analysis: The <code>get_hours_worked</code> Method</h5>
<p><em>Consider the following questions regarding the</em> <code>get_hours_worked</code> <em>function</em></p>
<ol type="1">
<li><p><em>What is the parameter</em> <code>self</code> <em>used to accomplish?</em></p>
<ul>
<li><p>A method is part of an object</p></li>
<li><p><code>self</code> tells the method which object it is a part of</p></li>
<li><p>The code sample below shows how the method doesn’t need an additional reference to the <code>Contact</code> it refers to</p>
<div id="b0b2d53e" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set up</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  rob <span class="op">=</span> Contact(<span class="st">"Rob"</span>, <span class="st">"A St"</span>, <span class="st">"1"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  rob.hours_worked <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  jim <span class="op">=</span> Contact(<span class="st">"Jim"</span>, <span class="st">"B St"</span>, <span class="st">"555"</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  jim.hours_worked <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># demonstration</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  rob_work <span class="op">=</span> rob.get_hours_worked()</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  jim_work <span class="op">=</span> jim.get_hours_worked()</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> rob_work <span class="op">&gt;</span> jim_work:</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(<span class="st">"More work for rob"</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>:</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(<span class="st">"More work for jim"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>More work for jim</code></pre>
</div>
</div></li>
</ul></li>
<li><p><em>Is the</em> <code>get_hours_worked</code> <em>method stored when we save contact information in a file</em></p>
<ul>
<li>No, if we use <a href="../../02_AdvancedProgramming/09_UsingClasses/Chapter_09.html#save-contacts-in-a-file-using-pickle"><code>pickle</code></a> to store a contact list, the method attributes are not stored. Pickle only stores the data attributes</li>
</ul></li>
<li><p><em>Can a program still access the</em> <code>hours_worked</code> <em>attribute of a</em> <code>Contact</code> <em>class</em></p>
<ul>
<li>Yes, it can. Using method attributes to get data doesn’t stop a program accessing the data directly</li>
<li>We simply remove the desire to</li>
<li>Later chapters look at techniques for enforcing this more robustly</li>
</ul></li>
</ol>
<ul>
<li><p>We can create a second method to handle adding a session to a <code>Contact</code></p>
<div id="581474f4" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># existing class definition</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">class</span> Contact:</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>      <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name, address, telephone):</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.name <span class="op">=</span> name</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.address <span class="op">=</span> address</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.telephone <span class="op">=</span> telephone</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.hours_worked <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>      <span class="kw">def</span> get_hours_worked(<span class="va">self</span>):</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>          <span class="co">"""</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co">          Gets the hours worked for this contact</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">          Returns</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co">          -------</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">          int | float</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co">              hours worked for this contact</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co">          """</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>          <span class="cf">return</span> <span class="va">self</span>.hours_worked</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>      <span class="co"># new method</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>      <span class="kw">def</span> add_session(<span class="va">self</span>, session_length):</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>          <span class="co">"""</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="co">          Adds a session (in hours) to the Contacts hours</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="co">          Parameters</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="co">          ----------</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="co">          session_length : int | float</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="co">              time spent on session in hours</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="co">          Returns</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="co">          -------</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a><span class="co">          None</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="co">          """</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.hours_worked <span class="op">=</span> <span class="va">self</span>.hours_worked <span class="op">+</span> session_length</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div></li>
<li><p>Takes two parameters</p>
<ol type="1">
<li><code>self</code> - the object the method is attached to
<ul>
<li>Here the <code>Contact</code> being updated</li>
</ul></li>
<li><code>session_length</code>
<ul>
<li>The length of the session to be added</li>
</ul></li>
</ol></li>
</ul>
<p>You can see the above implementation integrated into <a href="./Examples/02_TimeTrackerWithMethods/TimeTrackerWithMethods.py">our TimeTracker implementation</a>. Aside from defining these new functions we have to update the file scope <code>add_session</code> function (distinct from the class scope <code>add_session</code> method) and the <code>display_contact</code> functions to use the new methods</p>
</section>
</section>
<section id="add-validation-to-methods" class="level4">
<h4 class="anchored" data-anchor-id="add-validation-to-methods">Add Validation to Methods</h4>
<ul>
<li><p>Currently <code>add_session</code> would allow function calls like,</p>
<div id="2626cbd5" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>  rob <span class="op">=</span> Contact(<span class="st">"Rob"</span>, <span class="st">"A St"</span>, <span class="st">"555"</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  rob.add_session(<span class="op">-</span><span class="dv">10</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(rob.get_hours_worked())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>-10</code></pre>
</div>
</div></li>
<li><p>Legal call</p>
<ul>
<li>Makes no logical sense</li>
<li>Can’t work negative hours</li>
</ul></li>
<li><p>At the moment the validation is performed in the global <code>add_session</code> function</p>
<ul>
<li>Suppose this was maintained by another team</li>
<li>They could change it, and break your code</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Think Carefully about Valid Input</strong></p>
<p>You should think carefully about what is valid input for any function, especially when you restrict it. As observed here, a negative number of hours doesn’t make sense on the surface. However, it might make sense in the case of,</p>
<ol type="1">
<li>Correcting an overestimated number of hours</li>
<li>The Client wants to give a client a discounted number of hours</li>
</ol>
</div>
</div>
<ul>
<li>We want to move the validation inside the <code>Contact</code> object
<ul>
<li>Want <code>add_session</code> to reject hours that are less than half-an-hour or greater than three and a half</li>
</ul></li>
<li>We could add these as variables for each instance of a <code>Contact</code>
<ul>
<li>But they’re the same for every instance</li>
<li>Would be nice to have a way to define it once for the class</li>
</ul></li>
</ul>
<section id="create-class-variables" class="level5">
<h5 class="anchored" data-anchor-id="create-class-variables">Create Class Variables</h5>
<ul>
<li>A class variable is data not attached to a specific object instance</li>
<li>Can define the min and max hours as a class variable
<ul>
<li>No longer magic constants</li>
<li>Accessible by all <code>Contact</code> instances</li>
</ul>
<div id="cc1c7806" class="cell" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">class</span> Contact:</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>      <span class="co">"""</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co">      Contact with a name, address and telephone number.</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">      Tracks the hours worked with a client</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co">      Attributes</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">      ----------</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co">      name : str</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co">          Contact Name</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co">      address : str</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co">          Contact's postal or street address.</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co">      telephone : str</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co">          Contact phone number (stored as a string).</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co">      hours_worked : int | float</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co">          Hours worked with a Contact, initialised to 0</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="co">      Class Attributes</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="co">      ----------------</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="co">      min_session_length : Final[int | float]</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="co">          minimum length of a billable session</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="co">      max_session_length : Final[int | float]</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="co">          maximum length of a billable session</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a><span class="co">      Examples</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a><span class="co">      --------</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="co">      &gt;&gt;&gt; Contact("Rob Miles", "18 Pussycat Mews, London, NE1 410S", "+44(1234) 56789")</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a><span class="co">      &lt;Contact ...&gt;</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a><span class="co">      """</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>      min_session_length <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>      max_session_length <span class="op">=</span> <span class="fl">3.5</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>      <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name, address, telephone):</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>          <span class="co">"""</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a><span class="co">          Create a new `Contact` instance</span></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a><span class="co">          Parameters</span></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a><span class="co">          ----------</span></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a><span class="co">          name : str</span></span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a><span class="co">              Contact Name</span></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a><span class="co">          address : str</span></span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a><span class="co">              Contact's postal or street address.</span></span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a><span class="co">          telephone : str</span></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a><span class="co">              Contact phone number (stored as a string).</span></span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a><span class="co">          """</span></span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.name <span class="op">=</span> name</span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.address <span class="op">=</span> address</span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.telephone <span class="op">=</span> telephone</span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.hours_worked <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>          <span class="kw">def</span> get_hours_worked(<span class="va">self</span>):</span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>              <span class="co">"""</span></span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a><span class="co">              Gets the hours worked for this contact</span></span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a><span class="co">              Returns</span></span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a><span class="co">              -------</span></span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a><span class="co">              int | float</span></span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a><span class="co">                  hours worked for this contact</span></span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a><span class="co">              """</span></span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a>              <span class="cf">return</span> <span class="va">self</span>.hours_worked</span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a>          <span class="co"># new method</span></span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a>          <span class="kw">def</span> add_session(<span class="va">self</span>, session_length):</span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a>              <span class="co">"""</span></span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a><span class="co">              Adds a session (in hours) to the Contacts hours</span></span>
<span id="cb16-68"><a href="#cb16-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-69"><a href="#cb16-69" aria-hidden="true" tabindex="-1"></a><span class="co">              Parameters</span></span>
<span id="cb16-70"><a href="#cb16-70" aria-hidden="true" tabindex="-1"></a><span class="co">              ----------</span></span>
<span id="cb16-71"><a href="#cb16-71" aria-hidden="true" tabindex="-1"></a><span class="co">              session_length : int | float</span></span>
<span id="cb16-72"><a href="#cb16-72" aria-hidden="true" tabindex="-1"></a><span class="co">                  time spent on session in hours</span></span>
<span id="cb16-73"><a href="#cb16-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-74"><a href="#cb16-74" aria-hidden="true" tabindex="-1"></a><span class="co">              Returns</span></span>
<span id="cb16-75"><a href="#cb16-75" aria-hidden="true" tabindex="-1"></a><span class="co">              -------</span></span>
<span id="cb16-76"><a href="#cb16-76" aria-hidden="true" tabindex="-1"></a><span class="co">              None</span></span>
<span id="cb16-77"><a href="#cb16-77" aria-hidden="true" tabindex="-1"></a><span class="co">              """</span></span>
<span id="cb16-78"><a href="#cb16-78" aria-hidden="true" tabindex="-1"></a>              <span class="cf">if</span> session_length <span class="op">&lt;</span> Contact.min_session_length <span class="kw">or</span> session_length <span class="op">&gt;</span> Contact.max_session_length:</span>
<span id="cb16-79"><a href="#cb16-79" aria-hidden="true" tabindex="-1"></a>                  <span class="cf">return</span></span>
<span id="cb16-80"><a href="#cb16-80" aria-hidden="true" tabindex="-1"></a>              <span class="va">self</span>.hours_worked <span class="op">=</span> <span class="va">self</span>.hours_worked <span class="op">+</span> session_length</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div></li>
<li><code>add_session</code> now silently rejects invalid <code>session_length</code> values</li>
<li>The idiom of first checking for invalid input and performing a <code>return</code> if encountered is called an <em>early return</em> and is a common technique
<ul>
<li>Reduces the need for indentation on the happy path - the error free path</li>
</ul></li>
<li>Observe we have to prefix the class variables with the class name as a namespace</li>
<li>The <code>Final</code> label in the docstring indicates that the session length variables are expected to be constant and should not be modified by a consuming program</li>
</ul>
<section id="code-analysis-using-class-variables" class="level6">
<h6 class="anchored" data-anchor-id="code-analysis-using-class-variables">Code Analysis: Using class variables</h6>
<p><em>Build your understanding of class variables by answering the following questions about their use-cases</em></p>
<ol type="1">
<li><p><em>Should I use a class variable to hold the age of a contact?</em></p>
<ul>
<li>No.&nbsp;Each contact will have an age, so the age must be a data attribute unique to each object instance</li>
</ul></li>
<li><p><em>Should I use a class variable to hold the maximum age of a contact?</em></p>
<ul>
<li>Yes, we don’t need to store a copy of this value for every <code>Contact</code> instance, so it can be a class variable</li>
</ul></li>
<li><p><em>Should I use a class variable to hold the price per hour that the lawyer will charge?</em></p>
<ul>
<li>It depends, if the lawyer charges the same for every client then it may be reasonable</li>
<li>If the lawyer wishes to charge different contacts different rates, then we would have to store it as a data attribute
<ul>
<li>In that case we might store the minimum and maximum hourly rate as class variables</li>
</ul></li>
</ul></li>
</ol>
</section>
</section>
<section id="create-a-static-method-to-validate-values" class="level5">
<h5 class="anchored" data-anchor-id="create-a-static-method-to-validate-values">Create a Static Method to Validate Values</h5>
<ul>
<li><p>Cohesion generally means objects shouldn’t expose attributes for external clients</p></li>
<li><p>Ideally clients interact with a <code>Contact</code> via method calls</p>
<ul>
<li>e.g.&nbsp;<code>get_hours_worked</code> and <code>add_session</code></li>
<li>Eliminates direct dependency on <code>hours_worked</code> data attribute</li>
</ul></li>
<li><p>In the same vein, we don’t want users to directly interact with class variables</p>
<ul>
<li>e.g.&nbsp;<code>max_session_length</code> and <code>min_session_length</code> are used for internal validation</li>
<li>External client should have no reason to directly modify them</li>
</ul></li>
<li><p>Could create a method, <code>validate_session_length</code></p>
<ul>
<li>Receive a <code>session_length</code> argument</li>
<li>Return <code>True</code> if valid, else <code>False</code></li>
</ul></li>
<li><p>Validation information (<code>max_session_length</code> and <code>min_session_length</code>) is held at the class level</p>
<ul>
<li>Would be nice to also have this validation method at the class level too</li>
</ul></li>
<li><p>We can create class level methods through a <em>Static Method</em></p>
<ul>
<li>Static methods can be considered as methods defined on a class rather than an object instance</li>
</ul></li>
<li><p>We can define one as below,</p>
<div id="93fe3233" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">class</span> Contact:</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>      <span class="co">"""</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">      Contact with a name, address and telephone number.</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">      Tracks the hours worked with a client</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">      Attributes</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">      ----------</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co">      name : str</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">          Contact Name</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co">      address : str</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co">          Contact's postal or street address.</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co">      telephone : str</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co">          Contact phone number (stored as a string).</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co">      hours_worked : int | float</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co">          Hours worked with a Contact, initialised to 0</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="co">      Class Attributes</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co">      ----------------</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co">      min_session_length : Final[int | float]</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="co">          minimum length of a billable session</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="co">      max_session_length : Final[int | float]</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="co">          maximum length of a billable session</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="co">      Examples</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="co">      --------</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a><span class="co">      &gt;&gt;&gt; Contact("Rob Miles", "18 Pussycat Mews, London, NE1 410S", "+44(1234) 56789")</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="co">      &lt;Contact ...&gt;</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="co">      """</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>      min_session_length <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>      max_session_length <span class="op">=</span> <span class="fl">3.5</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">@staticmethod</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>      <span class="kw">def</span> valid_session_length(session_length):</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>          <span class="co">"""</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a><span class="co">          Check a session length is valid</span></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a><span class="co">          Parameters</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a><span class="co">          ----------</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a><span class="co">          session_length : int | float</span></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a><span class="co">              length of a consult session in hours</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a><span class="co">          Returns</span></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a><span class="co">          -------</span></span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a><span class="co">          bool</span></span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a><span class="co">              `True` if the session length is valid else `False`</span></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a><span class="co">          """</span></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>              session_length <span class="op">&lt;</span> Contact.min_session_length</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>              <span class="kw">or</span> session_length <span class="op">&gt;</span> Contact.max_session_length</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>          ):</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>              <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>          <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>      <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name, address, telephone):</span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>          <span class="co">"""</span></span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a><span class="co">          Create a new `Contact` instance</span></span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a><span class="co">          Parameters</span></span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a><span class="co">          ----------</span></span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a><span class="co">          name : str</span></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a><span class="co">              Contact Name</span></span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a><span class="co">          address : str</span></span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a><span class="co">              Contact's postal or street address.</span></span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a><span class="co">          telephone : str</span></span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a><span class="co">              Contact phone number (stored as a string).</span></span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a><span class="co">          """</span></span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.name <span class="op">=</span> name</span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.address <span class="op">=</span> address</span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.telephone <span class="op">=</span> telephone</span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.hours_worked <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a>      <span class="kw">def</span> get_hours_worked(<span class="va">self</span>):</span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a>          <span class="co">"""</span></span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a><span class="co">          Gets the hours worked for this contact</span></span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a><span class="co">          Returns</span></span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a><span class="co">          -------</span></span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a><span class="co">          int | float</span></span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a><span class="co">              hours worked for this contact</span></span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a><span class="co">          """</span></span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a>          <span class="cf">return</span> <span class="va">self</span>.hours_worked</span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a>      <span class="co"># new method</span></span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a>      <span class="kw">def</span> add_session(<span class="va">self</span>, session_length):</span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a>          <span class="co">"""</span></span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a><span class="co">          Adds a session (in hours) to the Contacts hours</span></span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a><span class="co">          Parameters</span></span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a><span class="co">          ----------</span></span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a><span class="co">          session_length : int | float</span></span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a><span class="co">              time spent on session in hours</span></span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a><span class="co">          Returns</span></span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a><span class="co">          -------</span></span>
<span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a><span class="co">          None</span></span>
<span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a><span class="co">          See Also</span></span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a><span class="co">          --------</span></span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a><span class="co">          Contact.valid_session_length : checks a session length is valid</span></span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a><span class="co">          """</span></span>
<span id="cb17-103"><a href="#cb17-103" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> <span class="kw">not</span> Contact.valid_session_length(session_length):</span>
<span id="cb17-104"><a href="#cb17-104" aria-hidden="true" tabindex="-1"></a>              <span class="cf">return</span></span>
<span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.hours_worked <span class="op">=</span> <span class="va">self</span>.hours_worked <span class="op">+</span> session_length</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div></li>
<li><p>The <code>@staticmethod</code> tag above the definition of <code>valid_session_length</code> is called a <em>decorator</em></p></li>
<li><p>A decorator <em>wraps</em> a function to modify how it works</p></li>
<li><p>Decorators are added by writing <code>@</code> followed by the decorator name above the function to be wrapped</p>
<ul>
<li>You can wrap a function with multiple decorators</li>
</ul></li>
<li><p>The <code>@staticmethod</code> decorator is a python language built-in</p>
<ul>
<li>Converts a method into a static method</li>
<li>Static methods can exist even without an instance of the given class</li>
</ul></li>
<li><p>Static methods can be called directly from the class e.g.</p>
<div id="25ae22a3" class="cell" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(Contact.valid_session_length(<span class="dv">5</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>False</code></pre>
</div>
</div></li>
</ul>
<section id="code-analysis-creating-static-validation-methods" class="level6">
<h6 class="anchored" data-anchor-id="code-analysis-creating-static-validation-methods">Code Analysis: Creating Static Validation Methods</h6>
<p><em>Input validation is a very common use-case for static methods. Consider the following questions to understand static validation methods</em></p>
<ol type="1">
<li><p><em>Why does the</em> <code>valid_session_length</code> <em>method not have a</em> <code>self</code> <em>parameter?</em></p>
<ul>
<li><code>self</code> refers to a particular object instance</li>
<li>static methods are not associated with an instance
<ul>
<li>Associated with the class</li>
<li>Thus no <code>self</code> to refer to</li>
</ul></li>
</ul></li>
<li><p><em>Why does the</em> <code>valid_session_length</code> <em>method not print a message to the user communicating that the session length is invalid?</em></p>
<ul>
<li><code>valid_session_length</code> only has responsibility for checking if a session length is valid</li>
<li>How to handle an <em>invalid</em> session length is the responsibility of the caller
<ul>
<li>e.g.&nbsp;a text-based vs graphical interface may want to handle this differently
<ul>
<li>e.g.&nbsp;display text vs a window</li>
</ul></li>
</ul></li>
<li>This concept of making a function responsible for one thing is called either
<ul>
<li>The <em>single responsibility principle</em>,</li>
<li>or more generally <em>separation of concerns</em></li>
</ul></li>
<li>Here a <code>Contact</code> object performs behaviours that modify or capture a the state of a clients interactions with a client
<ul>
<li>How the user responds to those states is not its responsibility</li>
</ul></li>
</ul></li>
<li><p><em>What does a decorator do?</em></p>
<ul>
<li>A decorator is a function that <em>wraps</em> another function</li>
<li>They can do some work, call a function then do some clean-up</li>
</ul></li>
<li><p><em>Can I create my own decorators?</em></p>
<ul>
<li>Yes</li>
<li>They are beyond the scope of this book though</li>
</ul></li>
<li><p><em>How do I know when to create a static method in a class?</em></p>
<ul>
<li>You want to create behaviour associated with a class, <em>but</em>
<ul>
<li>Independent of specific instance of a class</li>
</ul></li>
</ul></li>
</ol>
</section>
</section>
<section id="return-status-messages-from-a-validation-method" class="level5">
<h5 class="anchored" data-anchor-id="return-status-messages-from-a-validation-method">Return Status Messages from a Validation Method</h5>
<ul>
<li><code>add_session</code> prevents invalid session lengths being added to a <code>Contact</code></li>
<li>Currently user has no way of knowing if a session was added
<ul>
<li>Mistakes might be missed</li>
<li>Records then lost</li>
</ul></li>
<li>Need to indicate if <code>add_session</code> succeeded</li>
<li>Can do so by returning a <em>status flag</em> from <code>add_session</code> rather than <code>None</code>
<ul>
<li><code>True</code> indicates session added</li>
<li><code>False</code> indicates session failed</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> add_session(<span class="va">self</span>, session_length):</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">"""</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co">  Adds a session (in hours) to the Contacts hours</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co">  Parameters</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co">  ----------</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co">  session_length : int | float</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co">      time spent on session in hours</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co">  Returns</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co">  -------</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="co">  bool</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co">      `True` if session successfully added, else `False`</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co">  See Also</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="co">  --------</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="co">  Contact.valid_session_length : checks a session length is valid</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="co">  """</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="kw">not</span> Contact.valid_session_length(session_length):</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>  <span class="va">self</span>.hours_worked <span class="op">=</span> <span class="va">self</span>.hours_worked <span class="op">+</span> session_length</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="va">True</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li>The calling program can then check the status
<ul>
<li>Behave as appropriate on error</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>  session_length <span class="op">=</span> BTCInput.read_float(prompt<span class="op">=</span><span class="st">"Session Length: "</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> contact.add_session(session_length):</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(<span class="st">"Updated hours succeeded"</span>, contact.get_hours_worked())</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>:</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(<span class="st">"Add hours failed"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li>The above uses the status
<ul>
<li>On success the new hours are reported</li>
<li>On failure, the user is notified of the error</li>
</ul></li>
<li>The full implementation is given in <a href="./Examples/05_TimeTrackerWithStatusReporting/TimeTrackerWithStatusReporting.py">TimeTrackerWithStatusReporting.py</a></li>
<li>The problem with status messages is that the user can ignore them, e.g.&nbsp;the below variation of the previous example, ignores the return value</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>   contact.add_session(BTCInput.read_float(prompt<span class="op">=</span><span class="st">"Session Length: "</span>))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>   <span class="bu">print</span>(<span class="st">"Updated hours:"</span>, contact.get_hours_worked())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Thus no guarantee that failure will be handled</li>
</ul>
</section>
<section id="raise-an-exception-to-indicate-an-error" class="level5">
<h5 class="anchored" data-anchor-id="raise-an-exception-to-indicate-an-error">Raise an Exception to indicate an Error</h5>
<ul>
<li>Exceptions force the caller to deal with them
<ul>
<li>Unhandled exceptions crash the program</li>
</ul></li>
<li>Exceptions are designed for when an error occurs where continuing makes no sense
<ul>
<li><p>e.g.&nbsp;converting strings to numbers</p></li>
<li><p>meaningless to continue with an unconverted number</p></li>
<li><p><em>Unless</em> the caller specifies what to do in that case</p></li>
<li><p>So this causes an exception</p>
<div id="4491ce62" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>  x <span class="op">=</span> <span class="bu">int</span>(<span class="st">"Rob"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ValueError</span>                                Traceback (most recent call last)
<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[11]</span><span class="ansi-green-fg">, line 1</span>
<span class="ansi-green-fg">----&gt; </span><span class="ansi-green-fg">1</span> x = <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">int</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-fg ansi-yellow-bg">"</span><span class="ansi-yellow-fg ansi-yellow-bg">Rob</span><span class="ansi-yellow-fg ansi-yellow-bg">"</span><span class="ansi-yellow-bg">)</span>

<span class="ansi-red-fg">ValueError</span>: invalid literal for int() with base 10: 'Rob'</pre>
</div>
</div>
</div></li>
</ul></li>
<li>We can make our on code throw exceptions
<ul>
<li>We use the <code>raise</code> keyword</li>
</ul>
<div id="a1d9601b" class="cell" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> add_session(<span class="va">self</span>, session_length):</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>      <span class="co">"""</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co">      Adds a session (in hours) to the Contacts hours</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co">      Parameters</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co">      ----------</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co">      session_length : int | float</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co">          time spent on session in hours</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co">      Returns</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co">      -------</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="co">      None</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="co">      Raises</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="co">      ------</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="co">      Exception</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="co">          Raised if invalid session length passed</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="co">      See Also</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="co">      --------</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="co">      Contact.valid_session_length : checks a session length is valid</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="co">      """</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> <span class="kw">not</span> Contact.valid_session_length(session_length):</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>          <span class="cf">raise</span> <span class="pp">Exception</span>(<span class="st">"Invalid Session Length"</span>)</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>      <span class="va">self</span>.hours_worked <span class="op">=</span> <span class="va">self</span>.hours_worked <span class="op">+</span> session_length</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div></li>
<li><code>Contact</code>’s <code>add_session</code> now raises an <code>Exception</code> if the session length is invalid</li>
<li>Exception somewhat like a message
<ul>
<li>Tells the program what went wrong</li>
</ul></li>
<li><code>Exception</code> class provides behaviours for exceptions
<ul>
<li>Takes a string as an initializer argument</li>
<li>string should describe the error</li>
</ul></li>
<li>Once raised, the exception is either,
<ol type="1">
<li>handled by an <code>Except</code> handler inside a <code>try</code> block</li>
<li>Stops the program with an error</li>
</ol></li>
<li>The complete integration of the above is given byy <a href="./Examples/06_TimeTrackerWithException/TimeTrackerWithException.py">TimeTrackerWithException.py</a></li>
</ul>
</section>
<section id="make-something-happen-raising-exceptions-from-code" class="level5">
<h5 class="anchored" data-anchor-id="make-something-happen-raising-exceptions-from-code">Make Something Happen: Raising Exceptions from Code</h5>
<p><em>Investigate how exceptions are raised using the sample program <a href="./Examples/06_TimeTrackerWithException/TimeTrackerWithException.py">Time Tracker with Exception</a></em></p>
<p>Start a python interpreter and run the example program above, select option <span class="math inline">\(1\)</span> on the menu, and enter the following,</p>
<div id="29999871" class="cell" data-execution_count="13">
<div class="cell-output cell-output-stdout">
<div class="ansi-escaped-output">
<pre>Time Tracker



1. New Contact

2. Find Contact

3. Edit Contact

4. Add Session

5. Exit Program



Enter your command: <span class="ansi-red-fg">1</span>

Create new contact

Enter the contact name: <span class="ansi-red-fg"> Rob Miles</span>

Enter the contact address: <span class="ansi-red-fg"> 18 Pussycat Mews, London, NE1 410S</span>

Enter the contact phone: <span class="ansi-red-fg"> 1234 56789 </span>
</pre>
</div>
</div>
</div>
<p>Now add a session lasting 2 hours to the contact using option 4:</p>
<div id="fe46d0e0" class="cell" data-execution_count="14">
<div class="cell-output cell-output-stdout">
<div class="ansi-escaped-output">
<pre>Enter your command: <span class="ansi-red-fg"> 4</span>

add session

Enter the contact name: <span class="ansi-red-fg"> Rob Miles</span>

Name: Rob Miles

Previous hours worked: 0

Session Length: <span class="ansi-red-fg"> 2</span>

Updated hours worked: 2.0
</pre>
</div>
</div>
</div>
<p>This should work because <span class="math inline">\(2\)</span> is a valid session length, now repeat but attempt to add a session length of <span class="math inline">\(4\)</span>, which should be invalid,</p>
<div id="f487864d" class="cell" data-execution_count="15">
<div class="cell-output cell-output-stdout">
<div class="ansi-escaped-output">
<pre>Enter your command: <span class="ansi-red-fg"> 4</span>

add session

Enter the contact name: <span class="ansi-red-fg"> Rob Miles</span>

Name: Rob Miles

Previous hours worked: 2.0

Session Length: <span class="ansi-red-fg"> 4</span>
</pre>
</div>
</div>
</div>
<div id="aceb3822" class="cell" data-execution_count="16">
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">Exception</span>                                 Traceback (most recent call last)
<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[16]</span><span class="ansi-green-fg">, line 3</span>
<span class="ansi-green-fg">      1</span> rob = Contact(<span class="ansi-yellow-fg">"</span><span class="ansi-yellow-fg">Rob Miles</span><span class="ansi-yellow-fg">"</span>, <span class="ansi-yellow-fg">"</span><span class="ansi-yellow-fg">18 Pussycat Mews, London, NE1 410S</span><span class="ansi-yellow-fg">"</span>, <span class="ansi-yellow-fg">"</span><span class="ansi-yellow-fg">1234 56789</span><span class="ansi-yellow-fg">"</span>)
<span class="ansi-green-fg">      2</span> add_session(rob, <span class="ansi-green-fg">2</span>)
<span class="ansi-green-fg">----&gt; </span><span class="ansi-green-fg">3</span> <span class="ansi-yellow-bg">add_session</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">rob</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-green-fg ansi-yellow-bg">4</span><span class="ansi-yellow-bg">)</span>

<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[12]</span><span class="ansi-green-fg">, line 24</span>, in <span class="ansi-cyan-fg">add_session</span><span class="ansi-blue-fg">(self, session_length)</span>
<span class="ansi-green-fg">      2</span> <span style="font-style:italic" class="ansi-yellow-fg">"""</span>
<span class="ansi-green-fg">      3</span> <span style="font-style:italic" class="ansi-yellow-fg">Adds a session (in hours) to the Contacts hours</span>
<span class="ansi-green-fg">      4</span> 
<span class="ansi-green-fg">   (...)</span><span class="ansi-green-fg">     21</span> <span style="font-style:italic" class="ansi-yellow-fg">Contact.valid_session_length : checks a session length is valid</span>
<span class="ansi-green-fg">     22</span> <span style="font-style:italic" class="ansi-yellow-fg">"""</span>
<span class="ansi-green-fg">     23</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="font-weight:bold;color:rgb(175,0,255)">not</span> Contact.valid_session_length(session_length):
<span class="ansi-green-fg">---&gt; </span><span class="ansi-green-fg">24</span>     <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> <span style="font-weight:bold;color:rgb(215,95,95)">Exception</span>(<span class="ansi-yellow-fg">"</span><span class="ansi-yellow-fg">Invalid Session Length</span><span class="ansi-yellow-fg">"</span>)
<span class="ansi-green-fg">     25</span> <span style="color:rgb(0,135,0)">self</span>.hours_worked = <span style="color:rgb(0,135,0)">self</span>.hours_worked + session_length

<span class="ansi-red-fg">Exception</span>: Invalid Session Length</pre>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Our implementation will look slightly different to the above (which is the book code) because it has additional logic for handling duplicates. But follow the steps and the prompts and you should get roughly the same process</p>
</div>
</div>
</section>
<section id="extract-an-exception-error-message" class="level5">
<h5 class="anchored" data-anchor-id="extract-an-exception-error-message">Extract an Exception Error Message</h5>
<ul>
<li>Now that we can raise exceptions, how do we handle them?</li>
<li>We’ve seen that we control jumps to an appropriate <code>except</code> but what if we want to access the message in the exception?
<ul>
<li>We can use the <code>as</code> keyword to assign the exception a variable label</li>
<li>We modify the user call to the <code>Contact</code> object, <code>add_session</code> as, (see the full implementation as <a href="./Examples/07_TimeTrackerWithExceptionHandler/TimeTrackerWithExceptionHandler.py">TimeTrackerWithExceptionHandler.py</a>)</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>  hours_worked <span class="op">=</span> BTCInput.read_float(prompt<span class="op">=</span><span class="st">"Enter hours spent: "</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">try</span>:</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>      contact.add_session(hours_worked)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(<span class="st">"Updated hours succeeded:"</span>, contact.get_hours_worked())</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(<span class="st">"Add failed:"</span>, e)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li>The main change is rather than just going <code>except Exception:</code> we add a <code>as e</code>
<ul>
<li>Defines a variable <code>e</code> that stores the exception</li>
<li><code>e</code> exists for the scope of the <code>except</code> block</li>
</ul></li>
<li>Passing an exception to <code>print</code> prints our the message associated with the exception</li>
<li>A representative use might look like,</li>
</ul>
<div id="2f78266c" class="cell" data-execution_count="17">
<div class="cell-output cell-output-stdout">
<div class="ansi-escaped-output">
<pre>Enter your command: <span class="ansi-red-fg"> 4</span>

add session

Enter the contact name: <span class="ansi-red-fg"> Rob Miles</span>

Name: Rob Miles

Previous hours worked: 2.0

Session Length: <span class="ansi-red-fg"> -1</span>

Add failed: Invalid Session Length
</pre>
</div>
</div>
</div>
</section>
<section id="make-something-happen-catching-exceptions" class="level5">
<h5 class="anchored" data-anchor-id="make-something-happen-catching-exceptions">Make Something Happen: Catching Exceptions</h5>
<p><em>Repeat the steps in the <a href="#make-something-happen-raising-exceptions-from-code">previous example</a> but this time use the new code in <a href="./Examples/07_TimeTrackerWithExceptionHandler/TimeTrackerWithExceptionHandler.py">Time Tracker with Exception Handler</a>. You should find the program runs and the errors are captured without causing a crash</em></p>
</section>
<section id="code-analysis-raising-and-dealing-with-exceptions" class="level5">
<h5 class="anchored" data-anchor-id="code-analysis-raising-and-dealing-with-exceptions">Code Analysis: Raising and Dealing with Exceptions</h5>
<p><em>Consider the following questions about dealing with exceptions</em></p>
<ol type="1">
<li><p><em>Why does this version of the program not check the result returned by</em> <code>add_session</code><em>?</em></p>
<ul>
<li>This implementation of <code>add_session</code> returns <code>None</code></li>
<li>Instead an exception is raised to indicate a failure state</li>
<li>There is therefore nothing to check</li>
</ul></li>
<li><p><em>Isn’t raising an exception and stopping the program when something goes wrong a bit harsh?</em></p>
<ul>
<li>Depends on your philosophy</li>
<li>Generally you want to avoid <em>silent errors</em></li>
<li>i.e.&nbsp;errors that are undetected by the user</li>
<li>Exceptions force the user to handle the error rather than silently ignore it</li>
<li>If the user wants to avoid exception handling, they can explicitly use <code>validate_session_length</code></li>
</ul></li>
<li><p><em>Can a method be resumed once it has raised an exception?</em></p>
<ul>
<li>No</li>
<li>Exceptions immediately terminate the normal control flow</li>
<li>The user can always call the function again</li>
</ul></li>
<li><p><em>Why would you want to create your own types of exceptions?</em></p>
<ul>
<li>Allows any errors returned to be descriptive to your specific code</li>
<li>e.g.&nbsp;if your program relies on a specific file being loaded you might want a more descriptive error message than the standard <code>FileException</code> provides</li>
<li>Error management and reporting should be decided early in a program</li>
</ul></li>
<li><p><em>Should I always use exceptions to indicate something has gone wrong?</em></p>
<ul>
<li>Depends
<ul>
<li>You may not care about handling all types of errors</li>
</ul></li>
<li>Exceptions ensure errors are dealt with
<ul>
<li>User can customise the error handling in response to exception</li>
<li>e.g.&nbsp;for a text-based vs GUI interface</li>
</ul></li>
</ul></li>
<li><p><em>Why have we made</em> <code>add_session</code> <em>work like this? The program worked before we made this change</em></p>
<ul>
<li>Technically correct
<ul>
<li>Old code used the error status to validate code</li>
</ul></li>
<li>Arguably cleaner with the new error handling
<ul>
<li>Knowledge about the <code>Contact</code> class has been centralised in the <code>Contact</code> class itself</li>
<li>No need to have external variables storing information about valid session length or doing the validation</li>
</ul></li>
<li>Typically a good idea to put all knowledge about a classes behaviour in the class itself</li>
</ul></li>
</ol>
</section>
</section>
<section id="protect-a-data-attribute-against-damage" class="level4">
<h4 class="anchored" data-anchor-id="protect-a-data-attribute-against-damage">Protect a Data Attribute against Damage</h4>
<ul>
<li>Client no longer needs to directly interact with <code>hours_worked</code></li>
<li>However, client can still modify <code>hours_worked</code>
<ul>
<li>Programmer could accidentally change the value</li>
<li>Could also intentionally change it to break the code</li>
</ul></li>
<li>Ideally we want to prevent it being directly modified</li>
</ul>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Python protects against mistakes, not attacks</strong></p>
<p>Python provides features to help protect data attributes against accidental modifications. However, they don’t stop a programmer who intentionally (and perhaps maliciously) decides they want to modify the data attributes.</p>
<p>There is no mechanism in the python language to prevent another programmer adding code that changes <code>hours_worked</code> in the <code>Contact</code> object</p>
</div>
</div>
<ul>
<li>By convention, python dictates that an attribute name starting with <code>_</code> should not be used outside the class
<ul>
<li><p>Also referred to as being <em>internal</em> to the class</p></li>
<li><p>e.g.&nbsp;<code>_hours_worked</code> means that the variable should not be touched</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> get_hours_worked(<span class="va">self</span>):</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>      <span class="co">"""</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co">      Gets the hours worked for this contact</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co">      Returns</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co">      -------</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co">      int | float</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co">          hours worked for this contact</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co">      """</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="va">self</span>._hours_worked</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
</ul></li>
<li>Above we provide a <code>get_hours_worked</code> method to get the value of <code>_hours_worked</code>
<ul>
<li><code>_</code> indicates not to modify <code>hours_worked</code> itself</li>
</ul></li>
<li>No actual protection for <code>_hours_worked</code>
<ul>
<li>Could still be ignored by a programmer</li>
</ul></li>
<li>Can get greater security through, <em>name-mangling</em>
<ul>
<li>starting a variable name with double underscores <code>__</code></li>
</ul></li>
<li><em>name-mangling</em> makes it harder to access and modify the variable</li>
</ul>
<section id="make-something-happen-protecting-data-attributes-in-a-class" class="level5">
<h5 class="anchored" data-anchor-id="make-something-happen-protecting-data-attributes-in-a-class">Make Something Happen: Protecting Data Attributes in a Class</h5>
<p><em>Follow the following steps to examine how to make a python class secure. Open a python interpreter and enter the statements below</em></p>
<div id="26b3169e" class="cell" data-execution_count="18">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Secret:</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>._secret <span class="op">=</span> <span class="dv">99</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.__top_secret <span class="op">=</span> <span class="dv">100</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The above creates a class <code>Secret</code> which has two attributes, <code>_secret</code> and <code>__top_secret</code></p>
<p><em>Create an instance of the</em> <code>Secret</code> <em>class</em></p>
<div id="64db7662" class="cell" data-execution_count="19">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> Secret()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The above creates a new instance of a <code>Secret</code> class and stores it with the variable <code>x</code>.</p>
<p><em>Try to access the</em> <code>_secret</code> <em>attribute on</em> <code>x</code></p>
<div id="047962fd" class="cell" data-execution_count="20">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>    x._secret</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>99</code></pre>
</div>
</div>
<p>Even though we said that <code>_</code> indicates we should not access the data attribute, we can see that nothing stops us from doing so</p>
<p><em>Now try to access the</em> <code>__top_secret</code> <em>attribute</em></p>
<div id="808c7e73" class="cell" data-execution_count="21">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>    x.__top_secret</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[21]</span><span class="ansi-green-fg">, line 1</span>
<span class="ansi-green-fg">----&gt; </span><span class="ansi-green-fg">1</span> <span class="ansi-yellow-bg">x</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">__top_secret</span>

<span class="ansi-red-fg">AttributeError</span>: 'Secret' object has no attribute '__top_secret'</pre>
</div>
</div>
</div>
<p>This time we get an <code>AttributeError</code> which suggests that there is no <code>__top_secret</code> attribute associated with the <code>Secret</code> class</p>
<p><em>However, Python has performed some “name-mangling” to the name</em> <code>__top_secret</code><em>. Inside the</em> <code>Secret</code> <em>class we can refer to</em> <code>__top_secret</code><em>. Outside the class, the variable name is prepended with the class name (and an underscore). So we can still access it, as the below proves</em></p>
<div id="05cc9f7e" class="cell" data-execution_count="22">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>    x._Secret__top_secret</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>100</code></pre>
</div>
</div>
<p>Name-mangling thus secures us against accidental attribute use, however any one who knows the name mangling scheme and our attributes can still modify the data attribute if they want to</p>
<p>There are programs that check against this kind of bad code behaviour. One example is <a href="https://www.pylint.org/">pylint</a></p>
</section>
</section>
<section id="protected-methods" class="level4">
<h4 class="anchored" data-anchor-id="protected-methods">Protected Methods</h4>
<ul>
<li>Our current methods for the <code>Contact</code> class are all intended to be used by clients
<ul>
<li>Referred to as <em>public</em> methods</li>
</ul></li>
<li>We might also want to protect methods in a class</li>
<li>Can use <code>_</code> prefix to indicate that it should not be used</li>
<li>Or <code>__</code> prefix to name mangle</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Writing secure code is all about workflow</strong></p>
<p>Making a secure program is all about establishing a workflow to generate quality code. For example, using prototypes to make sure that a customer agrees with the direction of a program early in the development</p>
<p>The next step is to sensible design and tools like pylint to make sure we’re writing good quality code.</p>
</div>
</div>
</section>
</section>
<section id="create-class-properties" class="level3">
<h3 class="anchored" data-anchor-id="create-class-properties">Create Class Properties</h3>
<ul>
<li>We’ve talked about protecting <code>hours_spent</code> for our <code>Contact</code></li>
<li>We should add more business logic to ensure that name, address and telephone items are sensible
<ul>
<li>As a purely toy example, lets say they must each be <span class="math inline">\(4\)</span> characters long</li>
</ul></li>
<li>Realistically they would be discussed and confirmed with the customer</li>
</ul>
<div id="40345e8b" class="cell" data-execution_count="23">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Contact:</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    __min_text_length <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">@staticmethod</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> valid_text(text):</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co">        Validates text to be stored in the contact storage</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="co">        ----------</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="co">        text : str</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="co">            text string to store</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="co">        -------</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="co">        bool</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="co">            `True` if the text is valid, else `False`</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(text) <span class="op">&lt;</span> Contact.__min_text_length:</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<ul>
<li>Above mirrors <code>valid_session_length</code></li>
<li>Called to validate text to be stored in a <code>Contact</code></li>
<li>We could then name mangle <code>name</code>, <code>address</code>, <code>telephone</code></li>
<li>Supply methods to get and set these attributes
<ul>
<li>e.g.&nbsp;<code>set_name</code> and <code>get_name</code> for example</li>
</ul></li>
<li>Python has a built-in way for providing read and write access to protected data</li>
<li>This is called a <em>Property</em>
<ul>
<li>Properties preserve simple access, while allowing us to implement validation</li>
</ul></li>
</ul>
<section id="code-analysis-properties-in-classes" class="level4">
<h4 class="anchored" data-anchor-id="code-analysis-properties-in-classes">Code Analysis: Properties in Classes</h4>
<div id="01165100" class="cell" data-execution_count="24">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Contact:</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    __min_text_length <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">@staticmethod</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> valid_text(text):</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co">        Validates text to be stored in the contact storage</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co">        Valid input must be have a length greater than or</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co">        equal to `Contact.__min_text_length`</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="co">        ----------</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="co">        text : str</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="co">            text string to store</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="co">        -------</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a><span class="co">        bool</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="co">            `True` if the text is valid, else `False`</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(text) <span class="op">&lt;</span> Contact.__min_text_length:</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span>  <span class="co"># decorator makes name a property</span></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> name(<span class="va">self</span>):  <span class="co"># name of property function to get the name</span></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a><span class="co">        name : str</span></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a><span class="co">            Contact Name</span></span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a><span class="co">        Raises</span></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a><span class="co">        ------</span></span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a><span class="co">        Exception</span></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a><span class="co">            raised if new name is invalid</span></span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a><span class="co">        See Also</span></span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a><span class="co">        --------</span></span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a><span class="co">        Contact.valid_text : validates text input</span></span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.__name  <span class="co"># return private attribute containing the name</span></span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">@name.setter</span>  <span class="co"># decorator to identify the setter for name</span></span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> name(<span class="va">self</span>, name):</span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> Contact.validate_text(name):</span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">Exception</span>(<span class="st">"Invalid name"</span>)</span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__name <span class="op">=</span> name</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><em>The code above shows how to implement a property for</em> <code>name</code> <em>in the</em> <code>Contact</code> <em>class. The property implements validation and rejects invalid names. Work through the following questions to understand properties</em></p>
<ol type="1">
<li><p><em>How does the value being set in the property get into the</em> <code>setter</code><em>?</em></p>
<ul>
<li><code>setter</code> is called with two parameters</li>
<li><code>self</code> refers to the object on which the <code>setter</code> is being called</li>
<li>The second is the proposed value to set the property to
<ul>
<li>Here it is setting the <code>name</code> attribute</li>
</ul></li>
</ul></li>
<li><p><em>How does the program know which</em> <code>setter</code> <em>method to call for a particular property?</em></p>
<ul>
<li>The <code>setter</code> decorator has the format <code>property.setter</code>
<ul>
<li>Associates a <code>setter</code> to a property</li>
</ul></li>
</ul></li>
<li><p><em>Must the</em> <code>setter</code> <em>method raise an exception if the value is being set is not valid?</em></p>
<ul>
<li>No</li>
<li><code>setter</code> could ignore invalid values, or assign a default</li>
<li>Exceptions allow us to inform the user that the set has failed
<ul>
<li>And also forces the user to deal with the error</li>
</ul></li>
</ul></li>
<li><p><em>Do we need to perform the same validation for all properties in a class?</em></p>
<ul>
<li>No</li>
<li>We could test that telephone is purely numeric (for example)
<ul>
<li>This is not a good idea for real telephone numbers</li>
</ul></li>
<li>We could ensure address matches a certain structure for a valid address</li>
</ul></li>
<li><p><em>Must a property have a</em> <code>setter</code><em>?</em></p>
<ul>
<li>No</li>
<li>Properties without a <code>setter</code> are <em>read-only</em></li>
<li>They cannot be modified</li>
<li>We could use this to remove the <code>get_hours_worked</code> method
<ul>
<li>Use a property instead</li>
</ul></li>
</ul></li>
</ol>
</section>
<section id="make-something-happen-investigating-properties" class="level4">
<h4 class="anchored" data-anchor-id="make-something-happen-investigating-properties">Make Something Happen: Investigating Properties</h4>
<p><em>Investigate how properties work. Open up the python interpreter and enter the statements below</em></p>
<div id="67cc4a4e" class="cell" data-execution_count="25">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Prop:</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> x(<span class="va">self</span>):</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"got property x"</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.__x</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">@x.setter</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> x(<span class="va">self</span>, x):</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"set property x:"</span>, x)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__x <span class="op">=</span> x</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>This creates a new class <code>Prop</code> with a property <code>x</code> that has a <code>setter</code></p>
<p><em>Now create an instance of this class as below</em></p>
<div id="9ea59748" class="cell" data-execution_count="26">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>    test <span class="op">=</span> Prop()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><em>Put a value for</em> <code>x</code> <em>into the</em> <code>test</code> <em>instance</em></p>
<div id="bed2521f" class="cell" data-execution_count="27">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>    test.x <span class="op">=</span> <span class="dv">99</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>set property x: 99</code></pre>
</div>
</div>
<p>When python executes the above, it runs the setter method for the property. As we can see from the output above.</p>
<p><em>Now try to read the property</em></p>
<div id="47384af2" class="cell" data-execution_count="28">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(test.x)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>got property x
99</code></pre>
</div>
</div>
<p>When reading the property, python runs the property method, as indicated above</p>
<p><em>We can combine getting and setting in complex expressions, execute the following</em></p>
<div id="9a9e1de8" class="cell" data-execution_count="29">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>    test.x <span class="op">=</span> test.x <span class="op">+</span> <span class="dv">1</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>got property x
set property x: 100</code></pre>
</div>
</div>
<p>We can see that first the getter is called to get the current value of <code>x</code>, then the setter is called to update it to the expression on the right</p>
<p>To convert the <code>Contact</code> class to use properties for <code>name</code>, <code>telephone</code> and <code>address</code> we have to add properties and then setters</p>
<ul>
<li>The relevant changes to the <code>Contact</code> class are then,</li>
</ul>
<div id="bbfd8a4d" class="cell" data-execution_count="30">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Contact:</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Contact with a name, address and telephone number.</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Tracks the hours worked with a client</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Attributes</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="co">    name : str</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="co">        Contact Name</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="co">    address : str</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="co">        Contact's postal or street address.</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="co">    telephone : str</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="co">        Contact phone number (stored as a string).</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="co">    Examples</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="co">    --------</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a><span class="co">    &gt;&gt;&gt; Contact("Rob Miles", "18 Pussycat Mews, London, NE1 410S", "+44(1234) 56789")</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="co">    &lt;Contact ...&gt;</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>    __min_session_length <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>    __max_session_length <span class="op">=</span> <span class="fl">3.5</span></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">@staticmethod</span></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> valid_session_length(session_length):</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a><span class="co">        Check a session length is valid</span></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters</span></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a><span class="co">        ----------</span></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a><span class="co">        session_length : int | float</span></span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a><span class="co">            length of a consult session in hours</span></span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns</span></span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a><span class="co">        -------</span></span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a><span class="co">        bool</span></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a><span class="co">            `True` if the session length is valid else `False`</span></span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (</span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a>            session_length <span class="op">&lt;</span> Contact.__min_session_length</span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a>            <span class="kw">or</span> session_length <span class="op">&gt;</span> Contact.__max_session_length</span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a>        ):</span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a>    __min_text_length <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">@staticmethod</span></span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> valid_text(text):</span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a><span class="co">        Validates text to be stored in the contact storage</span></span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a><span class="co">        Valid input must be have a length greater than or</span></span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a><span class="co">        equal to `Contact.__min_text_length`</span></span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-57"><a href="#cb44-57" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters</span></span>
<span id="cb44-58"><a href="#cb44-58" aria-hidden="true" tabindex="-1"></a><span class="co">        ----------</span></span>
<span id="cb44-59"><a href="#cb44-59" aria-hidden="true" tabindex="-1"></a><span class="co">        text : str</span></span>
<span id="cb44-60"><a href="#cb44-60" aria-hidden="true" tabindex="-1"></a><span class="co">            text string to store</span></span>
<span id="cb44-61"><a href="#cb44-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-62"><a href="#cb44-62" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns</span></span>
<span id="cb44-63"><a href="#cb44-63" aria-hidden="true" tabindex="-1"></a><span class="co">        -------</span></span>
<span id="cb44-64"><a href="#cb44-64" aria-hidden="true" tabindex="-1"></a><span class="co">        bool</span></span>
<span id="cb44-65"><a href="#cb44-65" aria-hidden="true" tabindex="-1"></a><span class="co">            `True` if the text is valid, else `False`</span></span>
<span id="cb44-66"><a href="#cb44-66" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb44-67"><a href="#cb44-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(text) <span class="op">&lt;</span> Contact.__min_text_length:</span>
<span id="cb44-68"><a href="#cb44-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb44-69"><a href="#cb44-69" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb44-70"><a href="#cb44-70" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb44-71"><a href="#cb44-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-72"><a href="#cb44-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb44-73"><a href="#cb44-73" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> name(<span class="va">self</span>):</span>
<span id="cb44-74"><a href="#cb44-74" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb44-75"><a href="#cb44-75" aria-hidden="true" tabindex="-1"></a><span class="co">        name : str</span></span>
<span id="cb44-76"><a href="#cb44-76" aria-hidden="true" tabindex="-1"></a><span class="co">            Contact Name</span></span>
<span id="cb44-77"><a href="#cb44-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-78"><a href="#cb44-78" aria-hidden="true" tabindex="-1"></a><span class="co">        Raises</span></span>
<span id="cb44-79"><a href="#cb44-79" aria-hidden="true" tabindex="-1"></a><span class="co">        ------</span></span>
<span id="cb44-80"><a href="#cb44-80" aria-hidden="true" tabindex="-1"></a><span class="co">        Exception</span></span>
<span id="cb44-81"><a href="#cb44-81" aria-hidden="true" tabindex="-1"></a><span class="co">            raised if new name is invalid</span></span>
<span id="cb44-82"><a href="#cb44-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-83"><a href="#cb44-83" aria-hidden="true" tabindex="-1"></a><span class="co">        See Also</span></span>
<span id="cb44-84"><a href="#cb44-84" aria-hidden="true" tabindex="-1"></a><span class="co">        --------</span></span>
<span id="cb44-85"><a href="#cb44-85" aria-hidden="true" tabindex="-1"></a><span class="co">        Contact.valid_text : validates text input</span></span>
<span id="cb44-86"><a href="#cb44-86" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb44-87"><a href="#cb44-87" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.__name</span>
<span id="cb44-88"><a href="#cb44-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-89"><a href="#cb44-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">@name.setter</span></span>
<span id="cb44-90"><a href="#cb44-90" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> name(<span class="va">self</span>, name):</span>
<span id="cb44-91"><a href="#cb44-91" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> Contact.valid_text(name):</span>
<span id="cb44-92"><a href="#cb44-92" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">Exception</span>(<span class="st">"Invalid name"</span>)</span>
<span id="cb44-93"><a href="#cb44-93" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__name <span class="op">=</span> name</span>
<span id="cb44-94"><a href="#cb44-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-95"><a href="#cb44-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb44-96"><a href="#cb44-96" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> address(<span class="va">self</span>):</span>
<span id="cb44-97"><a href="#cb44-97" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb44-98"><a href="#cb44-98" aria-hidden="true" tabindex="-1"></a><span class="co">        address : str</span></span>
<span id="cb44-99"><a href="#cb44-99" aria-hidden="true" tabindex="-1"></a><span class="co">            Contact Address</span></span>
<span id="cb44-100"><a href="#cb44-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-101"><a href="#cb44-101" aria-hidden="true" tabindex="-1"></a><span class="co">        Raises</span></span>
<span id="cb44-102"><a href="#cb44-102" aria-hidden="true" tabindex="-1"></a><span class="co">        ------</span></span>
<span id="cb44-103"><a href="#cb44-103" aria-hidden="true" tabindex="-1"></a><span class="co">        Exception</span></span>
<span id="cb44-104"><a href="#cb44-104" aria-hidden="true" tabindex="-1"></a><span class="co">            raised if new address is invalid</span></span>
<span id="cb44-105"><a href="#cb44-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-106"><a href="#cb44-106" aria-hidden="true" tabindex="-1"></a><span class="co">        See Also</span></span>
<span id="cb44-107"><a href="#cb44-107" aria-hidden="true" tabindex="-1"></a><span class="co">        --------</span></span>
<span id="cb44-108"><a href="#cb44-108" aria-hidden="true" tabindex="-1"></a><span class="co">        Contact.valid_text : validates text input</span></span>
<span id="cb44-109"><a href="#cb44-109" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb44-110"><a href="#cb44-110" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.__address</span>
<span id="cb44-111"><a href="#cb44-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-112"><a href="#cb44-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">@address.setter</span></span>
<span id="cb44-113"><a href="#cb44-113" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> address(<span class="va">self</span>, address):</span>
<span id="cb44-114"><a href="#cb44-114" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> Contact.valid_text(address):</span>
<span id="cb44-115"><a href="#cb44-115" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">Exception</span>(<span class="st">"Invalid address"</span>)</span>
<span id="cb44-116"><a href="#cb44-116" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__address <span class="op">=</span> address</span>
<span id="cb44-117"><a href="#cb44-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-118"><a href="#cb44-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb44-119"><a href="#cb44-119" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> telephone(<span class="va">self</span>):</span>
<span id="cb44-120"><a href="#cb44-120" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb44-121"><a href="#cb44-121" aria-hidden="true" tabindex="-1"></a><span class="co">        telephone : str</span></span>
<span id="cb44-122"><a href="#cb44-122" aria-hidden="true" tabindex="-1"></a><span class="co">            Contact Telephone</span></span>
<span id="cb44-123"><a href="#cb44-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-124"><a href="#cb44-124" aria-hidden="true" tabindex="-1"></a><span class="co">        Raises</span></span>
<span id="cb44-125"><a href="#cb44-125" aria-hidden="true" tabindex="-1"></a><span class="co">        ------</span></span>
<span id="cb44-126"><a href="#cb44-126" aria-hidden="true" tabindex="-1"></a><span class="co">        Exception</span></span>
<span id="cb44-127"><a href="#cb44-127" aria-hidden="true" tabindex="-1"></a><span class="co">            raised if new telephone is invalid</span></span>
<span id="cb44-128"><a href="#cb44-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-129"><a href="#cb44-129" aria-hidden="true" tabindex="-1"></a><span class="co">        See Also</span></span>
<span id="cb44-130"><a href="#cb44-130" aria-hidden="true" tabindex="-1"></a><span class="co">        --------</span></span>
<span id="cb44-131"><a href="#cb44-131" aria-hidden="true" tabindex="-1"></a><span class="co">        Contact.valid_text : validates text input</span></span>
<span id="cb44-132"><a href="#cb44-132" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb44-133"><a href="#cb44-133" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.__telephone</span>
<span id="cb44-134"><a href="#cb44-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-135"><a href="#cb44-135" aria-hidden="true" tabindex="-1"></a>    <span class="at">@telephone.setter</span></span>
<span id="cb44-136"><a href="#cb44-136" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> telephone(<span class="va">self</span>, telephone):</span>
<span id="cb44-137"><a href="#cb44-137" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> Contact.valid_text(telephone):</span>
<span id="cb44-138"><a href="#cb44-138" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">Exception</span>(<span class="st">"Invalid telephone"</span>)</span>
<span id="cb44-139"><a href="#cb44-139" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__telephone <span class="op">=</span> telephone</span>
<span id="cb44-140"><a href="#cb44-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-141"><a href="#cb44-141" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name, address, telephone):</span>
<span id="cb44-142"><a href="#cb44-142" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb44-143"><a href="#cb44-143" aria-hidden="true" tabindex="-1"></a><span class="co">        Create a new Contact instance</span></span>
<span id="cb44-144"><a href="#cb44-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-145"><a href="#cb44-145" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters</span></span>
<span id="cb44-146"><a href="#cb44-146" aria-hidden="true" tabindex="-1"></a><span class="co">        ----------</span></span>
<span id="cb44-147"><a href="#cb44-147" aria-hidden="true" tabindex="-1"></a><span class="co">        name : str</span></span>
<span id="cb44-148"><a href="#cb44-148" aria-hidden="true" tabindex="-1"></a><span class="co">            Contact Name</span></span>
<span id="cb44-149"><a href="#cb44-149" aria-hidden="true" tabindex="-1"></a><span class="co">        address : str</span></span>
<span id="cb44-150"><a href="#cb44-150" aria-hidden="true" tabindex="-1"></a><span class="co">            Contact's postal or street address.</span></span>
<span id="cb44-151"><a href="#cb44-151" aria-hidden="true" tabindex="-1"></a><span class="co">        telephone : str</span></span>
<span id="cb44-152"><a href="#cb44-152" aria-hidden="true" tabindex="-1"></a><span class="co">            Contact phone number (stored as a string).</span></span>
<span id="cb44-153"><a href="#cb44-153" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb44-154"><a href="#cb44-154" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.name <span class="op">=</span> name</span>
<span id="cb44-155"><a href="#cb44-155" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.address <span class="op">=</span> address</span>
<span id="cb44-156"><a href="#cb44-156" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.telephone <span class="op">=</span> telephone</span>
<span id="cb44-157"><a href="#cb44-157" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__hours_worked <span class="op">=</span> <span class="dv">0</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<ul>
<li>The great thing about properties is they can be effectively drop in for traditional attributes
<ul>
<li>We make the attributes themselves name mangled</li>
<li>Define properties to mask the original names</li>
</ul></li>
<li>No need to update the downstream calling code
<ul>
<li>property syntax matches the traditional access pattern</li>
</ul></li>
<li>The complete integration is seen in <a href="./Examples/09_TimeTrackerWithProperties/TimeTrackerWithProperties.py">TimeTrackerWithProperties.py</a></li>
</ul>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Failures in property code can be confusing</strong></p>
<p>The <a href="./Examples/09_TimeTrackerWithProperties/TimeTrackerWithProperties.py">example program</a> implements the name, address and telephone number elements of a contact as properties. Setting a property to an invalid value will cause an exception. The initializer looks like,</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name, address, telephone):</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.name <span class="op">=</span> name</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.address <span class="op">=</span> address</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.telephone <span class="op">=</span> telephone</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__hours_worked <span class="op">=</span> <span class="dv">0</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>These statements look like normal variable assignments, nothing here indicates that these steps can fail. However, the following statement fails,</p>
<div id="a961b4f4" class="cell" data-execution_count="31">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>    rob <span class="op">=</span> Contact(name<span class="op">=</span><span class="st">"Rob"</span>, address<span class="op">=</span><span class="st">"18 Pussycat Mews, London NE1 410S"</span>, telephone<span class="op">=</span><span class="st">"1234 56789"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">Exception</span>                                 Traceback (most recent call last)
<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[31]</span><span class="ansi-green-fg">, line 1</span>
<span class="ansi-green-fg">----&gt; </span><span class="ansi-green-fg">1</span> rob = <span class="ansi-yellow-bg">Contact</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-fg ansi-yellow-bg">"</span><span class="ansi-yellow-fg ansi-yellow-bg">Rob</span><span class="ansi-yellow-fg ansi-yellow-bg">"</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">address</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-fg ansi-yellow-bg">"</span><span class="ansi-yellow-fg ansi-yellow-bg">18 Pussycat Mews, London NE1 410S</span><span class="ansi-yellow-fg ansi-yellow-bg">"</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">telephone</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-fg ansi-yellow-bg">"</span><span class="ansi-yellow-fg ansi-yellow-bg">1234 56789</span><span class="ansi-yellow-fg ansi-yellow-bg">"</span><span class="ansi-yellow-bg">)</span>

<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[30]</span><span class="ansi-green-fg">, line 154</span>, in <span class="ansi-cyan-fg">Contact.__init__</span><span class="ansi-blue-fg">(self, name, address, telephone)</span>
<span class="ansi-green-fg">    141</span> <span style="font-weight:bold;color:rgb(0,135,0)">def</span><span style="color:rgb(188,188,188)"> </span><span class="ansi-blue-fg">__init__</span>(<span style="color:rgb(0,135,0)">self</span>, name, address, telephone):
<span class="ansi-green-fg">    142</span> <span style="color:rgb(188,188,188)">    </span><span style="font-style:italic" class="ansi-yellow-fg">"""</span>
<span class="ansi-green-fg">    143</span> <span style="font-style:italic" class="ansi-yellow-fg">    Create a new Contact instance</span>
<span class="ansi-green-fg">    144</span> 
<span class="ansi-green-fg">   (...)</span><span class="ansi-green-fg">    152</span> <span style="font-style:italic" class="ansi-yellow-fg">        Contact phone number (stored as a string).</span>
<span class="ansi-green-fg">    153</span> <span style="font-style:italic" class="ansi-yellow-fg">    """</span>
<span class="ansi-green-fg">--&gt; </span><span class="ansi-green-fg">154</span>     <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">name</span> = name
<span class="ansi-green-fg">    155</span>     <span style="color:rgb(0,135,0)">self</span>.address = address
<span class="ansi-green-fg">    156</span>     <span style="color:rgb(0,135,0)">self</span>.telephone = telephone

<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[30]</span><span class="ansi-green-fg">, line 92</span>, in <span class="ansi-cyan-fg">Contact.name</span><span class="ansi-blue-fg">(self, name)</span>
<span class="ansi-green-fg">     89</span> <span style="color:rgb(175,0,255)">@name</span>.setter
<span class="ansi-green-fg">     90</span> <span style="font-weight:bold;color:rgb(0,135,0)">def</span><span style="color:rgb(188,188,188)"> </span><span class="ansi-blue-fg">name</span>(<span style="color:rgb(0,135,0)">self</span>, name):
<span class="ansi-green-fg">     91</span>     <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="font-weight:bold;color:rgb(175,0,255)">not</span> Contact.valid_text(name):
<span class="ansi-green-fg">---&gt; </span><span class="ansi-green-fg">92</span>         <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> <span style="font-weight:bold;color:rgb(215,95,95)">Exception</span>(<span class="ansi-yellow-fg">"</span><span class="ansi-yellow-fg">Invalid name</span><span class="ansi-yellow-fg">"</span>)
<span class="ansi-green-fg">     93</span>     <span style="color:rgb(0,135,0)">self</span>.__name = name

<span class="ansi-red-fg">Exception</span>: Invalid name</pre>
</div>
</div>
</div>
<p>The above raises an exception because the value <code>Rob</code> passed for the <code>name</code> property is too short. <code>__init__</code> attempts to set <code>name</code> which calls the setter, and the property code raises an exception.</p>
<p>Programmers may expect methods or functions to cause exceptions but they typically do not expect statements that look like variable assignments. When implementing properties you need to be clear about how they work and how to handle failure.</p>
<p>We could extend our previous <a href="#make-something-happen-catching-exceptions">error handling code</a> to add additional exception handlers to handle invalid assignments</p>
</div>
</div>
</section>
</section>
<section id="evolve-class-design" class="level3">
<h3 class="anchored" data-anchor-id="evolve-class-design">Evolve Class Design</h3>
<blockquote class="blockquote">
<p>Scenario</p>
<p>The lawyer likes your program but would now like to use it for billing. The program should track both the hours worked for a client and the the billing amount owed by each contact</p>
<p>Prices are calculated as follows, for every session worked there is - A $30 flat case fee - A $50 hourly fee</p>
<p>For example a one hour session would cost $80</p>
<p>The client wants the billing amount to be automatically updated each time they add a session. Displaying a contact should then also display the billing amount</p>
<pre class="text"><code>Name: Rob Miles
Address: 18 Pussycat Mews, London, NE1 410S
Telephone: 1234 56789
Hours on the case: 2.0
Billing amount: 130.0</code></pre>
</blockquote>
<section id="code-analysis-managing-the-billing-amount" class="level4">
<h4 class="anchored" data-anchor-id="code-analysis-managing-the-billing-amount">Code Analysis: Managing the Billing Amount</h4>
<p><em>Work through the following questions to understand how we design managing the billing amount</em></p>
<ol type="1">
<li><p><em>How would we store the billing amount for a contact?</em></p>
<ul>
<li>Store as a data attribute on a <code>Contact</code> object</li>
<li>Manage like <code>__hours_worked</code> with validators</li>
<li>Let’s call it <code>__billing_amount</code></li>
</ul></li>
<li><p><em>Why does</em> <code>__billing_amount</code> <em>have two leading underscores in the name?</em></p>
<ul>
<li><p>Indicates the variable is private to the class</p></li>
<li><p>Provides name-mangling to reduce chance for accidental use</p></li>
<li><p>Provide access via a read-only property</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>  <span class="at">@property</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> billing_amount(<span class="va">self</span>):</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="va">self</span>.__billing_amount</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p>We omit a setter, the property cannot be directly modified</p></li>
<li><p>Can then access the property as we would expect</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">"Rob owes:"</span>, rob.billing_amount)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p>Same output might look like,</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>  <span class="co">#| echo: false</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">"Rob owes:"</span>, <span class="fl">130.0</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
</ul></li>
<li><p><em>What would the statement calculating the billable amount for a session look like?</em></p>
<ul>
<li><p>At it’s most basic the statement might look like,</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>  amount_to_bill <span class="op">=</span> <span class="dv">30</span> <span class="op">+</span> (<span class="dv">50</span> <span class="op">*</span> session_length)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p><code>session_length</code> value is multiplied by the hourly rate (<span class="math inline">\(50\)</span>)</p></li>
<li><p>flat fee <span class="math inline">\(30\)</span> is added to the total</p></li>
<li><p>Can then add this to the billing amount</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>  <span class="va">self</span>.__billing_amount <span class="op">=</span> <span class="va">self</span>.billing_amount <span class="op">+</span> amount_to_bill</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p>Observe that this approach means that each session incurs the same <span class="math inline">\(30\)</span> case opening fee</p></li>
<li><p>It’s possible multiple sessions might be spent on the same case</p>
<ul>
<li>Might not incur the <span class="math inline">\(30\)</span> fee each time</li>
<li>This would be something to confirm with the client</li>
</ul></li>
</ul></li>
<li><p><em>Is it sensible to just use the values</em> <span class="math inline">\(30\)</span> <em>and</em> <span class="math inline">\(50\)</span> <em>in this code?</em></p>
<ul>
<li><p>No</p></li>
<li><p>They are magic constants</p></li>
<li><p>Better to make them internal class variables of the <code>Contact</code> class</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">class</span> Contact</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>      __open_fee <span class="op">=</span> <span class="dv">30</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>      __hourly_fee <span class="op">=</span> <span class="dv">50</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p>Observe that we flag them as private, they are internals for the class</p></li>
<li><p>The new amount to bill statement is then,</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>  amount_to_bill <span class="op">=</span> Contact.__open_fee <span class="op">+</span> (Contact.__hourly_fee <span class="op">*</span> session_length)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
</ul></li>
<li><p><em>Where should the above statement go?</em></p>
<ul>
<li><p>Adjusting the billing is something that occurs when we add a session</p></li>
<li><p>Makes sense to go in the <code>add_session</code> code of the <code>Contact</code> class</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> add_session(<span class="va">self</span>, session_length):</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>      <span class="co">"""</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="co">      Adds a session (in hours) to the Contacts hours</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="co">      Updates the Contact's session hours and calculates</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="co">      the billable amount owed</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="co">      Parameters</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="co">      ----------</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="co">      session_length : int | float</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="co">          time spent on session in hours</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="co">      Returns</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a><span class="co">      -------</span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a><span class="co">      None</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a><span class="co">      Raises</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a><span class="co">      ------</span></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a><span class="co">      Exception</span></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a><span class="co">          Raised if invalid session length passed</span></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a><span class="co">      See Also</span></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a><span class="co">      --------</span></span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a><span class="co">      Contact.valid_session_length : checks a session length is valid</span></span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a><span class="co">      """</span></span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> <span class="kw">not</span> Contact.validate_session_length(session_length):</span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>          <span class="cf">raise</span> <span class="pp">Exception</span>(<span class="st">"Invalid session length"</span>)</span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a>      <span class="va">self</span>.__hours_worked <span class="op">=</span> <span class="va">self</span>.__hours_worked <span class="op">+</span> session_length</span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>      amount_to_bill <span class="op">=</span> Contact.__open_fee <span class="op">+</span> (Contact.__hourly_fee <span class="op">*</span> session_length)</span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a>      <span class="va">self</span>.__billing_amount <span class="op">=</span> <span class="va">self</span>.__billing_amount <span class="op">+</span> amount_to_bill</span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p>Billing amount is updated <em>after</em> we have validated and updated the hours worked</p></li>
</ul></li>
</ol>
<ul>
<li>We change the <code>display_contact</code> method to add the billing amount</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> display_contact(contact):</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Displays the Contact details for the supplied contact</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="co">    contact : Contact</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="co">        contact to display</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a><span class="co">    None</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a><span class="co">    See Also</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a><span class="co">    --------</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a><span class="co">    display_contacts : Displays all contacts matching a search name</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Name:"</span>, contact.name)</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Address:"</span>, contact.address)</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Telephone:"</span>, contact.telephone)</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Hours worked for this Contact:"</span>, contact.get_hours_worked(), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Amount to bill:"</span>, contact.billing_amount)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>The complete program can be found in <a href="./Examples/11_TimeTrackerWithBillingAmount/TimeTrackerWithBillingAmount.py">Time Tracker with Billing Amount</a></li>
</ul>
</section>
<section id="manage-class-versions" class="level4">
<h4 class="anchored" data-anchor-id="manage-class-versions">Manage Class Versions</h4>
<ul>
<li>The new program works, but it has a problem</li>
<li>Contacts saved under the old system, won’t work
<ul>
<li><p>They will load</p></li>
<li><p>But whe we try to display or add a session we’ll get an error, like</p>
<div id="0f2ed867" class="cell" data-execution_count="32">
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[32]</span><span class="ansi-green-fg">, line 1</span>
<span class="ansi-green-fg">----&gt; </span><span class="ansi-green-fg">1</span> <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> <span style="font-weight:bold;color:rgb(215,95,95)">AttributeError</span>(<span class="ansi-yellow-fg">"</span><span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">Contact</span><span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg"> object has no attribute </span><span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">_Contact__billing_amount</span><span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">"</span>)

<span class="ansi-red-fg">AttributeError</span>: 'Contact' object has no attribute '_Contact__billing_amount'</pre>
</div>
</div>
</div></li>
</ul></li>
<li>This occurs because the program attempts to access the <code>__billing_access</code> attribute</li>
<li>Old versions of the <code>Contact</code> class didn’t have this
<ul>
<li>So error occurs</li>
</ul></li>
<li>Same might occur if we make more modifications in the future</li>
</ul>
<section id="add-a-version-attribute-to-a-class" class="level5">
<h5 class="anchored" data-anchor-id="add-a-version-attribute-to-a-class">Add a version attribute to a class</h5>
<ul>
<li>We can solve this by <em>versioning</em> a class</li>
<li>Add a version attribute to each class
<ul>
<li>Simply a numeric attribute</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name, address, telephone):</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>      <span class="co">"""</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co">      Create a new `Contact` instance</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="co">      Parameters</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="co">      ----------</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="co">      name : str</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="co">          Contact Name</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="co">      address : str</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="co">          Contact's postal or street address.</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a><span class="co">      telephone : str</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a><span class="co">          Contact phone number (stored as a string).</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a><span class="co">      """</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>      <span class="va">self</span>.name <span class="op">=</span> name</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>      <span class="va">self</span>.address <span class="op">=</span> address</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>      <span class="va">self</span>.telephone <span class="op">=</span> telephone</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>      <span class="va">self</span>.__hours_worked <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>      <span class="va">self</span>.__billing_amount <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>      <span class="va">self</span>.__version <span class="op">=</span> <span class="dv">1</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li>version is set as a private variable</li>
</ul>
</section>
<section id="check-version-numbers" class="level5">
<h5 class="anchored" data-anchor-id="check-version-numbers">Check Version Numbers</h5>
<ul>
<li><p>Then create a method to check the version of a <code>Contact</code></p>
<ul>
<li>Let’s us check that a <code>Contact</code> object matches the current version</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> check_version(<span class="va">self</span>):</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>      <span class="co">"""</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="co">      Check the version of a `Contact` instance</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="co">      Upgrades the instance to the most recent version</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="co">      if required</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="co">      Returns</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="co">      -------</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="co">      None</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="co">      """</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>      <span class="cf">pass</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p>Leave it as a stub for now</p></li>
<li><p>We want to use it when we load contacts to check versions</p></li>
<li><p>Updated <code>load_contacts</code> is below</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> load_contacts(file_name):</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">"""</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="co">  Loads the contacts from the given file</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="co">  Contacts are stored in binary as a pickled file</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="co">  Parameters</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="co">  ----------</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="co">  file_name : str</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="co">      string giving the path to the file where the contacts data is stored</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="co">  Returns</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="co">  -------</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a><span class="co">  None</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a><span class="co">      Contact detail is loaded into the global `contacts` value</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a><span class="co">  Raises</span></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a><span class="co">  ------</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a><span class="co">      Exceptions if contacts failed to load</span></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a><span class="co">  See Also</span></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a><span class="co">  --------</span></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a><span class="co">  save_contacts : saves contacts to a pickled file</span></span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a><span class="co">  """</span></span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>  <span class="kw">global</span> contacts</span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">"Load contacts"</span>)</span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">with</span> <span class="bu">open</span>(file_name, <span class="st">"rb"</span>) <span class="im">as</span> input_file:</span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>      contacts <span class="op">=</span> pickle.load(input_file)</span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update version of loaded contacts if required</span></span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> contact <span class="kw">in</span> contacts:</span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a>      contact.check_version()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
</ul>
</section>
<section id="upgrade-a-class" class="level5">
<h5 class="anchored" data-anchor-id="upgrade-a-class">Upgrade a Class</h5>
<ul>
<li><p>Now we want to write code to upgrade a <code>Contact</code></p></li>
<li><p>For our version <span class="math inline">\(1\)</span>, we want to upgrade any class that <em>does not</em> have a <code>__billing_amount</code> attribute</p></li>
<li><p>In future we might define a version <span class="math inline">\(2\)</span>, then we would redefine the <code>check_version</code> method to upgrade any class that isn’t version <span class="math inline">\(2\)</span></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> check_version(<span class="va">self</span>):</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">"""</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co">  Check the version of a `Contact` instance</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="co">  Upgrades the instance to the most recent version</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="co">  if required</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="co">  Returns</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="co">  -------</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="co">  None</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="co">  """</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">try</span>:</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.__version <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.__billing_amount <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.__version <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">except</span> <span class="pp">AttributeError</span>:</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>      <span class="va">self</span>.__billing_amount <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>      <span class="va">self</span>.__version <span class="op">=</span> <span class="dv">1</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p>We first attempt to check the version number</p></li>
<li><p>If it’s not the current version (<span class="math inline">\(1\)</span>) we upgrade the class</p>
<ul>
<li>Add a <code>.__billing_amount</code> attribute defaulted to zero</li>
<li>Upgrade the version number</li>
</ul></li>
<li><p>Use a <code>try...except</code> block to catch the <code>AttributeError</code> if the version doesn’t exist (i.e.&nbsp;for old instances pre-versioning)</p>
<ul>
<li>Perform the upgrade</li>
</ul></li>
</ul>
</section>
<section id="make-something-happen-explore-version-management" class="level5">
<h5 class="anchored" data-anchor-id="make-something-happen-explore-version-management">Make Something Happen: Explore Version Management</h5>
<p><em>To get a better understanding of versioning, work through the following steps</em></p>
<p><em>Start by running the program <a href="./Examples/10_TimeTrackerWithPropertiesAndExceptionHandling/TimeTrackerWithPropertiesAndExceptionHandling.py">TimeTrackerWithPropertiesAndExceptionHandling.py</a>. Create a new contact as below</em></p>
<div id="20d96d8a" class="cell" data-execution_count="33">
<div class="cell-output cell-output-stdout">
<div class="ansi-escaped-output">
<pre>Enter your command: <span class="ansi-red-fg">1</span>

Create new contact

Enter the contact name: <span class="ansi-red-fg">Rob Miles</span>

Enter the contact address: <span class="ansi-red-fg">18 Pussycat Mews, London, NE1 410S</span>

Enter the contact phone: <span class="ansi-red-fg">1234 56789</span>
</pre>
</div>
</div>
</div>
<p>This creates a new contact, which looks like, (use Find Contact)</p>
<div id="a9164712" class="cell" data-execution_count="34">
<div class="cell-output cell-output-stdout">
<pre><code>Name: Rob Miles
Address: 18 Pussycat Mews, London, NE1 410S
Telephone: 1234 56789
Hours on the case: 0</code></pre>
</div>
</div>
<p>As we can see this version is missing the billable hours information</p>
<p><em>Exit the program so the contact is saved. Now load this pickle file with <a href="./Examples/12_TimeTrackerWithVersion/TimeTrackerWithVersion.py">TimeTrackerWithVersion.py</a></em></p>
<p>This should load the contact (which is unversioned), and upgrade it to the versioned variant with a billing amount</p>
<p><em>Attempt to display this contact, you should see something like</em></p>
<div id="a77b7534" class="cell" data-execution_count="35">
<div class="cell-output cell-output-stdout">
<pre><code>Name: Rob Miles
Address: 18 Pussycat Mews, London, NE1 410S
Telephone: 1234 56789
Hours on the case: 0
Amount to bill: 0</code></pre>
</div>
</div>
<p>As we can see, the amount to bill is now correctly displayed</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Add version management when you design data storage</strong></p>
<p>When starting a project you should consider which items are being stored and if they need version management. For example in the Time Tracker program we expect that the client will request changes to the features, so we should consider versioning it from the start</p>
<p>Every time a new version of a program is installed, we then have to go through the process of updating the underlying data to the new version</p>
<p>When writing a program for a customer, you should consider how long it will take to write code that deal with data updates (or migrations). This can make trivial programs significantly more complex</p>
</div>
</div>
</section>
</section>
<section id="the-__str__-method-in-a-class" class="level4">
<h4 class="anchored" data-anchor-id="the-__str__-method-in-a-class">The <code>__str__</code> Method in a Class</h4>
<ul>
<li><p>Each time we add a new attribute to the <code>Contact</code> class we have to modify <code>display_contact</code></p></li>
<li><p>Would be nice just to be able to print a <code>Contact</code> directly</p></li>
<li><p>However, doing so, we find the output is pretty useless (using the mock below)</p>
<div id="cb3d882f" class="cell" data-execution_count="36">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">class</span> Contact:</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>      <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name, address, telephone):</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.name <span class="op">=</span> name</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.address <span class="op">=</span> address</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.telephone <span class="op">=</span> telephone</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  contact <span class="op">=</span> Contact(<span class="st">"Rob Miles"</span>, <span class="st">"Pussycat Mews"</span>, <span class="st">"1234"</span>)</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> display_contact(contact):</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(contact)</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  display_contact(contact)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;__main__.Contact object at 0x7f92d4e27c50&gt;</code></pre>
</div>
</div></li>
<li><p>default for objects is the class name following by the memory address of the object</p></li>
<li><p>python objects have a <code>__str__</code> method</p>
<ul>
<li>Used whenever the an object needs to be converted to a string</li>
</ul></li>
<li><p>To change the default behaviour for our objects we need to redefine <code>__str__</code></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">class</span> Contact:</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>      ...</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>      <span class="kw">def</span> <span class="fu">__str__</span>(<span class="va">self</span>):</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>          <span class="cf">return</span> <span class="st">"Name: "</span> <span class="op">+</span> <span class="va">self</span>.name <span class="op">+</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="op">\</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Address: "</span> <span class="op">+</span> <span class="va">self</span>.address <span class="op">+</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="op">\</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Telephone: "</span> <span class="op">+</span> <span class="va">self</span>.telephone <span class="op">+</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="op">\</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Hours on the case: "</span> <span class="op">+</span> <span class="bu">str</span>(<span class="va">self</span>.hours_worked) <span class="op">+</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="op">\</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Amount to bill: "</span> <span class="op">+</span> <span class="bu">str</span>(<span class="va">self</span>.billing_amount)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p>The <code>\</code> character above is used to continue the string onto a new line</p></li>
<li><p>printing now, we get what we expect</p>
<div id="c5c664b7" class="cell" data-execution_count="38">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>  display_contact(contact)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Name: Rob Miles
Address: Pussycat Mews
Telephone: 1234
Hours on the case: 0
Amount to bill: 0</code></pre>
</div>
</div></li>
</ul>
<section id="python-string-formatting" class="level5">
<h5 class="anchored" data-anchor-id="python-string-formatting">Python String Formatting</h5>
<ul>
<li>Writing the string as a series of concatenations isn’t the cleanest</li>
<li>Difficult to maintain and ensure correctness as we modify the class</li>
<li>We can use <code>format</code> to create a formatted string
<ul>
<li>Lets us write a shorter string</li>
<li><code>format</code> is a string method</li>
<li><code>format</code> takes in values as arguments and injects them into the string</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">class</span> Contact:</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>      ...</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>      <span class="kw">def</span> <span class="fu">__str__</span>(<span class="va">self</span>):</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>          template <span class="op">=</span> <span class="st">"""Name: </span><span class="sc">{0}</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="st">Address: </span><span class="sc">{1}</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="st">Telephone: </span><span class="sc">{2}</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="st">Hours on the case: </span><span class="sc">{3}</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="st">Amount to bill: </span><span class="sc">{4}</span><span class="st">"""</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>          <span class="cf">return</span> template.<span class="bu">format</span>(<span class="va">self</span>.name, <span class="va">self</span>.address, <span class="va">self</span>.telephone, <span class="va">self</span>.hours_worked, <span class="va">self</span>.billing_amount)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li>Values in format are inserted at marked points in the string</li>
<li>Marked points are <code>{n}</code> where <span class="math inline">\(n\)</span> is the index of the argument to substitute
<ul>
<li>Starting from <span class="math inline">\(0\)</span></li>
</ul></li>
</ul>
</section>
<section id="make-something-happen-adventures-with-string-formatting" class="level5">
<h5 class="anchored" data-anchor-id="make-something-happen-adventures-with-string-formatting">Make Something Happen: Adventures with String Formatting</h5>
<p><em>Open the python interpreter and work through the following steps to understand how string formatting works</em></p>
<p><em>Enter the statements below</em></p>
<div id="03870dd1" class="cell" data-execution_count="39">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>name <span class="op">=</span> <span class="st">"Rob Miles"</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>age <span class="op">=</span> <span class="dv">21</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The above creates two variables <code>name</code> and <code>age</code></p>
<p><em>Now create the following template string</em></p>
<div id="da7ea581" class="cell" data-execution_count="40">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>template <span class="op">=</span> <span class="st">"My name is </span><span class="sc">{0}</span><span class="st"> and my age is </span><span class="sc">{1}</span><span class="st">"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The just creates a string called <code>template</code>, <code>{0}</code> and <code>{1}</code> are two placeholder indicators for the <code>format</code> function</p>
<p><em>Now call the</em> <code>format</code> <em>method on</em> <code>template</code></p>
<div id="abe1c090" class="cell" data-execution_count="41">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>template.<span class="bu">format</span>(name, age)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>'My name is Rob Miles and my age is 21'</code></pre>
</div>
</div>
<p>As we can see the placeholder values have been substituted with the values of the <code>name</code> and <code>age</code> value</p>
<p><em>We can add additional formatting information. Redefine and format the template as follows</em></p>
<div id="fbdd9451" class="cell" data-execution_count="42">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>template <span class="op">=</span> <span class="st">"My name is </span><span class="sc">{0:20}</span><span class="st"> and my age is </span><span class="sc">{1:10}</span><span class="st">"</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>template.<span class="bu">format</span>(name, age)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>'My name is Rob Miles            and my age is         21'</code></pre>
</div>
</div>
<p>We write the placeholder as <code>{n:w}</code> where <span class="math inline">\(n\)</span> is the index of the placeholder. <span class="math inline">\(w\)</span> is the width value, as you can see from above, the value is still substituted but then spaces are added to pad out to the width. This is useful for defining columns. We use a <code>:</code> to separate the <em>format specifiers</em> from the placeholder index</p>
<p>For floating point values you can also specify the number of decimal places to be printed</p>
<div id="c4b2ed44" class="cell" data-execution_count="43">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>template <span class="op">=</span> <span class="st">"My name is </span><span class="sc">{0:20}</span><span class="st"> and my age is </span><span class="sc">{1:10.2f}</span><span class="st">"</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>template.<span class="bu">format</span>(name, age)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>'My name is Rob Miles            and my age is      21.00'</code></pre>
</div>
</div>
<p>The above now prints the age with two decimal places. The full details of the string formatting mini language can be found at the <a href="https://docs.python.org/3/library/string.html#format-string-syntax">python docs</a></p>
<p>You can find the full version of Time Tracker using the string method in</p>
</section>
</section>
</section>
<section id="session-tracking-in-time-tracker" class="level3">
<h3 class="anchored" data-anchor-id="session-tracking-in-time-tracker">Session Tracking in Time Tracker</h3>
<ul>
<li>Our client now gives us a new scenario</li>
</ul>
<blockquote class="blockquote">
<p>The client would like to record <em>when</em> each specific session for a contact took place. You and the client specify the following design,</p>
<pre class="text"><code>
Time Tracker
1. New Contact
2. Find Contact
3. Edit Contact
4. Add Session
5. Exit Program

Enter you command: 2
Enter  the contact name: Rob
Name: Rob Miles
Address: 18 Pussycat Mews, London, NE1 410S
Telephone: 1234 56789
Hours on the case: 10.0
Amount to bill: 470.0
Sessions
Date: Mon Jul 10 11:30:00 2017 Length: 1.0
Date: Tue Jul 12 11:30:00 2017 Length: 2.0
Date: Wed Jul 19 11:30:00 2017 Length: 2.5
Date: Wed Jul 26 10:30:00 2017 Length: 2.5
Date: Mon Jul 31 16:51:45 2017 Length: 1.0
Date: Mon Aug 14 16:51:45 2017 Length: 1.0</code></pre>
</blockquote>
<ul>
<li>Finding a contact now displays the sessions as a list</li>
<li>Not immediately clear how we would add this to our class</li>
</ul>
<section id="code-analysis-creating-a-session-class" class="level4">
<h4 class="anchored" data-anchor-id="code-analysis-creating-a-session-class">Code Analysis: Creating a Session Class</h4>
<p><em>Let’s do some design work, for handling a session. Work through the following questions</em></p>
<ol type="1">
<li><p><em>How will we store information about a session?</em></p>
<ul>
<li><p>We need to store a bunch of heterogeneous related data</p></li>
<li><p>Good idea to consider a class, say <code>Session</code></p></li>
<li><p>Need to consider data to store</p>
<ol type="1">
<li>length of a session</li>
<li>date and time of the session</li>
</ol></li>
<li><p>We should also move the <code>Contact</code> class attributes validating a session length to the <code>Session</code> class</p></li>
</ul>
<div id="9c6a678e" class="cell" data-execution_count="44">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a> <span class="im">import</span> time</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a> <span class="kw">class</span> Session:</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>     <span class="co">"""</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="co">     Session with a length and a date time it was conducted</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="co">     """</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>     __min_session_length <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>     __max_session_length <span class="op">=</span> <span class="fl">3.5</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">@staticmethod</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>     <span class="kw">def</span> valid_session_length(session_length):</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>         <span class="co">"""</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a><span class="co">         Check a session length is valid</span></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a><span class="co">         Parameters</span></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a><span class="co">         ----------</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a><span class="co">         session_length : int | float</span></span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a><span class="co">             length of a consult session in hours</span></span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a><span class="co">         Returns</span></span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a><span class="co">         -------</span></span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a><span class="co">         bool</span></span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a><span class="co">             `True` if the session length is valid else `False`</span></span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a><span class="co">         """</span></span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a>         <span class="cf">if</span> (</span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a>             session_length <span class="op">&lt;</span> Session.__min_session_length</span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a>             <span class="kw">or</span> session_length <span class="op">&gt;</span> Session.__max_session_length</span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a>         ):</span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a>             <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb78-30"><a href="#cb78-30" aria-hidden="true" tabindex="-1"></a>         <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb78-31"><a href="#cb78-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-32"><a href="#cb78-32" aria-hidden="true" tabindex="-1"></a>     <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, session_length):</span>
<span id="cb78-33"><a href="#cb78-33" aria-hidden="true" tabindex="-1"></a>         <span class="co">"""</span></span>
<span id="cb78-34"><a href="#cb78-34" aria-hidden="true" tabindex="-1"></a><span class="co">         Create a new `Session` instance</span></span>
<span id="cb78-35"><a href="#cb78-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-36"><a href="#cb78-36" aria-hidden="true" tabindex="-1"></a><span class="co">         Parameters</span></span>
<span id="cb78-37"><a href="#cb78-37" aria-hidden="true" tabindex="-1"></a><span class="co">         ----------</span></span>
<span id="cb78-38"><a href="#cb78-38" aria-hidden="true" tabindex="-1"></a><span class="co">         session_length : int | float</span></span>
<span id="cb78-39"><a href="#cb78-39" aria-hidden="true" tabindex="-1"></a><span class="co">             length of a session</span></span>
<span id="cb78-40"><a href="#cb78-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-41"><a href="#cb78-41" aria-hidden="true" tabindex="-1"></a><span class="co">         Raises</span></span>
<span id="cb78-42"><a href="#cb78-42" aria-hidden="true" tabindex="-1"></a><span class="co">         ------</span></span>
<span id="cb78-43"><a href="#cb78-43" aria-hidden="true" tabindex="-1"></a><span class="co">         Exception</span></span>
<span id="cb78-44"><a href="#cb78-44" aria-hidden="true" tabindex="-1"></a><span class="co">             Raised if `session_length` is invalid</span></span>
<span id="cb78-45"><a href="#cb78-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-46"><a href="#cb78-46" aria-hidden="true" tabindex="-1"></a><span class="co">         See Also</span></span>
<span id="cb78-47"><a href="#cb78-47" aria-hidden="true" tabindex="-1"></a><span class="co">         --------</span></span>
<span id="cb78-48"><a href="#cb78-48" aria-hidden="true" tabindex="-1"></a><span class="co">         Session.valid_session_length : validates session lengths</span></span>
<span id="cb78-49"><a href="#cb78-49" aria-hidden="true" tabindex="-1"></a><span class="co">         """</span></span>
<span id="cb78-50"><a href="#cb78-50" aria-hidden="true" tabindex="-1"></a>         <span class="cf">if</span> <span class="kw">not</span> Session.valid_session_length(session_length):</span>
<span id="cb78-51"><a href="#cb78-51" aria-hidden="true" tabindex="-1"></a>             <span class="cf">raise</span> <span class="pp">Exception</span>(<span class="st">"Invalid session length"</span>)</span>
<span id="cb78-52"><a href="#cb78-52" aria-hidden="true" tabindex="-1"></a>         <span class="va">self</span>.__session_length <span class="op">=</span> session_length</span>
<span id="cb78-53"><a href="#cb78-53" aria-hidden="true" tabindex="-1"></a>         <span class="va">self</span>.__session_end_time <span class="op">=</span> time.localtime()</span>
<span id="cb78-54"><a href="#cb78-54" aria-hidden="true" tabindex="-1"></a>         <span class="va">self</span>.__version <span class="op">=</span> <span class="dv">1</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<ul>
<li><p>We can now create <code>Session</code> objects</p>
<div id="55ae21c2" class="cell" data-execution_count="45">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>  session_length <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  session_record <span class="op">=</span> Session(session_length)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(session_record)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;__main__.Session object at 0x7f92d4e25580&gt;</code></pre>
</div>
</div></li>
<li><p>creates a <code>Session</code> with the passed <code>session_length</code> parameter</p></li>
<li><p><code>validate_session_length</code> moved to <code>Session</code></p>
<ul>
<li>validates session lengths at object creation</li>
<li>Exception raised if invalid session length is passed</li>
</ul></li>
<li><p><code>__init__</code> uses <code>time</code> library to get the local time</p>
<ul>
<li>Stored in <code>__session_end_time</code> attribute</li>
</ul></li>
</ul></li>
<li><p><em>Are we using version control for the</em> <code>Session</code> <em>class?</em></p>
<ul>
<li><p>Yes</p></li>
<li><p>Highly likely the <code>Session</code> object might change</p></li>
<li><p>Especially if we change our mind on what responsibility is in the <code>Contact</code> class vs the <code>Session</code> class</p></li>
<li><p>Thus also want to implement a <code>check_version</code> method</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> check_version(<span class="va">self</span>):</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>      <span class="co">"""</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="co">      Check the version of a `Contact` instance</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="co">      Upgrades the instance to the most recent version</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="co">      if required</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a><span class="co">      Returns</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a><span class="co">      -------</span></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a><span class="co">      None</span></span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a><span class="co">      """</span></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>      <span class="cf">pass</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p>Currently does nothing</p>
<ul>
<li>All <code>Session</code> instances will be versioned</li>
<li>Only one version, so no need to edit</li>
</ul></li>
</ul></li>
<li><p><em>How will we allow users of the</em> <code>Session</code> <em>class to get the session length and session end time items from a</em> <code>Session</code> <em>object?</em></p>
<ul>
<li>We add these as properties</li>
<li>Want these to be read-only so no setter is provided</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a> <span class="at">@property</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a> <span class="kw">def</span> session_length(<span class="va">self</span>):</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>     <span class="co">"""</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="co">     session_length : int | float</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="co">         length (in hours) of this session</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a><span class="co">     """</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>     <span class="cf">return</span> <span class="va">self</span>.__session_length</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a> <span class="at">@property</span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a> <span class="kw">def</span> session_end_time(<span class="va">self</span>):</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>     <span class="co">"""</span></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a><span class="co">     session_end_time : time.struct_time</span></span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a><span class="co">         date and time of the session</span></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a><span class="co">     """</span></span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>     <span class="cf">return</span> <span class="va">self</span>.__session_end_time</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p><em>Will the</em> <code>Session</code> <em>class have a</em> <code>__str__</code> <em>method?</em></p>
<ul>
<li>Yes</li>
<li>Return a string describing a <code>Session</code> instance</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a> <span class="kw">def</span> <span class="fu">__str__</span>(<span class="va">self</span>):</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>     template <span class="op">=</span> <span class="st">"Date: </span><span class="sc">{0}</span><span class="st"> Length: </span><span class="sc">{1}</span><span class="st">"</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>     <span class="co">#convert time object string</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>     date_string <span class="op">=</span> time.asctime(<span class="va">self</span>.__session_end_time)</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>     <span class="cf">return</span> template.<span class="bu">format</span>(date_string, <span class="va">self</span>.__session_length)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><code>time</code> library contains <code>asctime</code>
<ul>
<li>Takes a <code>localtime</code> value and returns a string representation</li>
</ul></li>
<li>Then format the string</li>
</ul></li>
</ol>
<ul>
<li><p>Given the <code>Session</code> object, we now need to incorporate this into the <code>Contact</code> object</p></li>
<li><p><code>Contact</code> objects contain a list of sessions</p>
<ul>
<li>Initialised empty</li>
</ul></li>
<li><p>We also need to bump the version number</p>
<ul>
<li>Which means we also need to update the <code>check_version</code> method</li>
<li>Now need to handle the conversion from no version to version 2 and version 1 to version 2</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> check_version(<span class="va">self</span>):</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>      <span class="co">"""</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="co">      Check the version of a `Contact` instance</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="co">      Upgrades the instance to the most recent version</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="co">      if required. This includes upgrading any Session</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="co">      instances associated with this Contact instance</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a><span class="co">      See Also</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a><span class="co">      --------</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a><span class="co">      Session.check_version : Checks and upgrades `Session` instances</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a><span class="co">      """</span></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>      <span class="cf">try</span>:</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> <span class="va">self</span>.__version <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>              <span class="co"># does not have session list</span></span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>              <span class="va">self</span>.__sessions <span class="op">=</span> []</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>              <span class="va">self</span>.__version <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>      <span class="cf">except</span> <span class="pp">AttributeError</span>:</span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.__billing_amount <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.__sessions <span class="op">=</span> []</span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.__version <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>      <span class="co"># now upgrade all sessions in a contact</span></span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> session <span class="kw">in</span> <span class="va">self</span>.__sessions:</span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a>          session.check_version()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p>Any version <span class="math inline">\(1\)</span> instance will be upgraded to version <span class="math inline">\(2\)</span></p></li>
<li><p>For old, unversioned instances, we still use the <code>try...except</code> to force an upgrade to the most recent</p></li>
<li><p>We also want to check that the sessions stored with a <code>Contact</code> are up to date</p>
<ul>
<li>So after upgrading a <code>Contact</code> we check that the <code>Session</code> instances are up to date</li>
</ul></li>
<li><p>We’ve written the code so that if the <code>Session</code> is upgraded, instances will still be upgraded <em>even</em> if the <code>Contact</code> object is the most recent version</p></li>
<li><p>We now need to modify adding a session to add a new <code>Session</code> instance, rather than just update the hours</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> add_session(<span class="va">self</span>, session_length):</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>      <span class="co">"""</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="co">      Adds a session (in hours) to the Contacts sessions</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="co">      Parameters</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="co">      ----------</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="co">      session_length : int | float</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a><span class="co">          time spent on session in hours</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a><span class="co">      Returns</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a><span class="co">      -------</span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a><span class="co">      None</span></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a><span class="co">      Raises</span></span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a><span class="co">      ------</span></span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a><span class="co">      Exception</span></span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a><span class="co">          Raised if invalid session length passed</span></span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a><span class="co">      See Also</span></span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a><span class="co">      --------</span></span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a><span class="co">      Contact.valid_session_length : checks a session length is valid</span></span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a><span class="co">      """</span></span>
<span id="cb85-23"><a href="#cb85-23" aria-hidden="true" tabindex="-1"></a>      <span class="cf">try</span>:</span>
<span id="cb85-24"><a href="#cb85-24" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.__sessions.append(Session(session_length))</span>
<span id="cb85-25"><a href="#cb85-25" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.__hours_worked <span class="op">=</span> <span class="va">self</span>.__hours_worked <span class="op">+</span> session_length</span>
<span id="cb85-26"><a href="#cb85-26" aria-hidden="true" tabindex="-1"></a>          amount_to_bill <span class="op">=</span> Contact.__open_fee <span class="op">+</span> (</span>
<span id="cb85-27"><a href="#cb85-27" aria-hidden="true" tabindex="-1"></a>              Contact.__hourly_fee <span class="op">*</span> session_length</span>
<span id="cb85-28"><a href="#cb85-28" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb85-29"><a href="#cb85-29" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.__billing_amount <span class="op">=</span> <span class="va">self</span>.__billing_amount <span class="op">+</span> amount_to_bill</span>
<span id="cb85-30"><a href="#cb85-30" aria-hidden="true" tabindex="-1"></a>      <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb85-31"><a href="#cb85-31" aria-hidden="true" tabindex="-1"></a>          <span class="bu">print</span>(e)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p>We could validate the session length in <code>add_session</code> explicitly</p>
<ul>
<li>However, the <code>Session</code> constructor does this, via exceptions</li>
</ul></li>
<li><p>We first try to create the <code>Session</code></p>
<ul>
<li>If it’s invalid we get an exception which we catch and handle</li>
</ul></li>
<li><p>If created successfully we then update the hours worked and amount to bill</p></li>
<li><p>Last step is to now work out how we want to display our <code>Session</code> instances when we report on a client</p>
<ul>
<li>Our client wants a line for each individual session</li>
<li>We need to convert the list of sessions to a string in this format</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>  <span class="at">@property</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> session_report(<span class="va">self</span>):</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>      <span class="co">"""</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="co">      session_report : str</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="co">          provides a string representation of a Contact's sessions</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="co">      """</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>      <span class="co"># map converts each session to a string</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>      report_strings <span class="op">=</span> <span class="bu">map</span>(<span class="bu">str</span>, <span class="va">self</span>.__sessions)</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>      result <span class="op">=</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(report_strings)</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> result</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p>Uses <code>map</code> to convert a list of session objects to a list of their string representations</p></li>
<li><p>Uses <code>join</code> to then convert the list of strings to a single string with each element separated by a newline</p></li>
</ul>
</section>
<section id="the-python-map-function" class="level4">
<h4 class="anchored" data-anchor-id="the-python-map-function">The Python <code>map</code> Function</h4>
<ul>
<li><p>Our aim is to convert a list of <code>Session</code> objects into a list of strings</p></li>
<li><p>Could do this with a loop</p></li>
<li><p>Alternative is to use <code>map</code></p></li>
<li><p><code>map</code> takes two arguments</p>
<ol type="1">
<li>A function name
<ul>
<li>The function must accept a single argument and return a result</li>
</ul></li>
<li>List of items to apply the function to</li>
</ol></li>
<li><p>functions can be stored in variables and passed as arguments</p></li>
<li><p><code>map</code> applies the function provided (first argument) to the list (second argument) and returns the result</p></li>
</ul>
<section id="make-something-happen-investigating-the-map-function-and-iteration" class="level5">
<h5 class="anchored" data-anchor-id="make-something-happen-investigating-the-map-function-and-iteration">Make Something Happen: Investigating the <code>map</code> Function and Iteration</h5>
<p><em>These next few steps go on for a quite a while. So work through it at your own pace. However, this will give you a good understanding of not just</em> <code>map</code> <em>but also some fundamentals for python</em></p>
<p><em>Open up a python interpreter and work through the following steps. We’ll use</em> <code>map</code> <em>to indent a list of strings. Run the following steps</em></p>
<div id="332dd184" class="cell" data-execution_count="46">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>code <span class="op">=</span> [<span class="st">'line1'</span>, <span class="st">'line2'</span>, <span class="st">'line3'</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>This creates a list containing three strings, we can easily view the contents</p>
<div id="285d6bd4" class="cell" data-execution_count="47">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>code</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>['line1', 'line2', 'line3']</code></pre>
</div>
</div>
<p><em>Now we need to create our indentation function. We can do this by adding four spaces (or a tab etc.) at the beginning of a string. Define the following python function</em></p>
<div id="b4fb0674" class="cell" data-execution_count="48">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> indent(x):</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"    "</span> <span class="op">+</span> x</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We can test this function, on a sample string,</p>
<div id="c1a16fb4" class="cell" data-execution_count="49">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Rob"</span>)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>indent(<span class="st">"Rob"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rob</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>'    Rob'</code></pre>
</div>
</div>
<p>We would like to apply the <code>indent</code> function to every string in the <code>code</code> list. We could do this using a <code>for</code> loop, instead we use a <code>map</code> function</p>
<p><em>Now run the following statements</em></p>
<div id="96072357" class="cell" data-execution_count="50">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>indented_code <span class="op">=</span> <span class="bu">map</span>(indent, code)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>indented_code</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>&lt;map at 0x7f92d4e262c0&gt;</code></pre>
</div>
</div>
<p>Naively we expected a list of indented strings. Instead we have something called a <em>map object</em>. <code>map</code> returns something called an iterator. Iterators return items from a collection or sequence one at a time. We can work through iterators using a <code>for</code> loop. This is how we can work through lists. <code>range</code> also returns an iterator</p>
<p><em>Now run the following</em> <code>for</code> <em>loop to get the</em> <code>indented_code</code> <em>values</em></p>
<div id="306b5018" class="cell" data-execution_count="51">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> s <span class="kw">in</span> indented_code:</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(s)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>    line1
    line2
    line3</code></pre>
</div>
</div>
<p>Now we have the list of strings as we were expecting. Each time around the loop the next <code>s</code> value is retrieved from the iterator</p>
<p>Iterators allow us to save memory, rather than having to store the entire result in memory we can simply generate each one as needed. Each time we ask for a new result from the map object, <code>map</code> gets the next value from the original collection (<code>code</code>) and applies the function <code>indent</code> to it. Once the map iterator runs out of values to return, it raises <code>StopIteration</code> as an exception. This stops the loop.</p>
<p>Lets explore this in more detail</p>
<p><em>Recreate the statement creating the map</em></p>
<div id="0f1ea1c4" class="cell" data-execution_count="52">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>indented_code <span class="op">=</span> <span class="bu">map</span>(indent, code)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We can then ask for the next item from an iterator using the <code>__next__</code> method.</p>
<p><em>Call this method on</em> <code>indented_code</code></p>
<div id="ff8452ea" class="cell" data-execution_count="53">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>indented_code.<span class="fu">__next__</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>'    line1'</code></pre>
</div>
</div>
<p>We can see this produces the <em>next</em> value, though in this case, it’s the first item. We can keep repeating this</p>
<p><em>Run the following</em></p>
<div id="a1294a15" class="cell" data-execution_count="54">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(indented_code.<span class="fu">__next__</span>())</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(indented_code.<span class="fu">__next__</span>())</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(indented_code.<span class="fu">__next__</span>())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>    line2
    line3</code></pre>
</div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">StopIteration</span>                             Traceback (most recent call last)
<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[54]</span><span class="ansi-green-fg">, line 3</span>
<span class="ansi-green-fg">      1</span> <span style="color:rgb(0,135,0)">print</span>(indented_code.<span class="ansi-blue-fg">__next__</span>())
<span class="ansi-green-fg">      2</span> <span style="color:rgb(0,135,0)">print</span>(indented_code.<span class="ansi-blue-fg">__next__</span>())
<span class="ansi-green-fg">----&gt; </span><span class="ansi-green-fg">3</span> <span style="color:rgb(0,135,0)">print</span>(<span class="ansi-yellow-bg">indented_code</span><span class="ansi-yellow-bg">.</span><span class="ansi-blue-fg ansi-yellow-bg">__next__</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>)

<span class="ansi-red-fg">StopIteration</span>: </pre>
</div>
</div>
</div>
<p>We can see that we get the next two items from the iterator, and then finally after trying to get an non-existent value we see a <code>StopIteration</code> exception is raised</p>
<p><em>You can’t reuse a iterator once it has run out of items. You have to recreate it</em></p>
<div id="48358d64" class="cell" data-execution_count="55">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>indent_iterator <span class="op">=</span> <span class="bu">map</span>(indent, code)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>If we want to convert this to normal collection, we can do something like call <code>list</code> to convert to a list</p>
<p><em>Check this out by running the following statements</em></p>
<div id="834d705b" class="cell" data-execution_count="56">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>indented_code <span class="op">=</span> <span class="bu">list</span>(indent_iterator)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>indented_code</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>['    line1', '    line2', '    line3']</code></pre>
</div>
</div>
<p>What happens if we make the input of a <code>map</code> function an iterator</p>
<p><em>Enter the following statements to explore</em></p>
<div id="c3679096" class="cell" data-execution_count="57">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>i1 <span class="op">=</span> <span class="bu">map</span>(indent, code)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>i2 <span class="op">=</span> <span class="bu">map</span>(indent, i1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We first create the iterator <code>i1</code> to apply the <code>indent</code> function to the list <code>code</code>. We then create a second iterator <code>i2</code> to apply the <code>indent</code> function to the items of the <code>i1</code> iterator</p>
<p><em>Use</em> <code>list</code> <em>to convert</em> <code>i2</code> <em>to a list</em></p>
<div id="92301352" class="cell" data-execution_count="58">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(i2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>['        line1', '        line2', '        line3']</code></pre>
</div>
</div>
<p>We can see that each item is indented twice. Once by <code>i1</code> and again by <code>i2</code>. Observe that the nested iterator <code>i1</code> was also applied as part of the conversion process. Python makes it very easy to chain iterators together</p>
<p>Let us return to our original use of <code>map</code></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>report_strings <span class="op">=</span> <span class="bu">map</span>(<span class="bu">str</span>, <span class="va">self</span>.__sessions)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Here <code>self.__sessions</code> is a list of <code>Session</code> objects. <code>map</code> creates an iterator that applies <code>str</code> to each element of <code>self.__sessions</code>. <code>str</code> itself converts each <code>Session</code> to a string by calling the <code>__str__</code> method. We then use the <code>join</code> method to work through this iterator to build the final output string</p>
</section>
</section>
<section id="the-python-join-method" class="level4">
<h4 class="anchored" data-anchor-id="the-python-join-method">The Python <code>join</code> Method</h4>
<ul>
<li><p>We can call string methods on string literals, e.g.</p>
<div id="7f057f0d" class="cell" data-execution_count="59">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>  <span class="co">"FRED"</span>.lower()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>'fred'</code></pre>
</div>
</div></li>
<li><p>Another string method is <code>join</code></p></li>
<li><p>Takes an iterator as an argument</p></li>
<li><p><code>join</code> merges all strings in an iterator</p>
<ul>
<li>the string on which <code>join</code> is called is inserted between each item</li>
</ul>
<div id="86bb7a41" class="cell" data-execution_count="60">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>  report_strings <span class="op">=</span> [<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>]</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  report_results <span class="op">=</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(report_strings)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div></li>
</ul>
<section id="make-something-happen-investigating-the-join-function" class="level5">
<h5 class="anchored" data-anchor-id="make-something-happen-investigating-the-join-function">Make Something Happen: Investigating the <code>join</code> Function</h5>
<p><em>Work through the following steps with the python interpreter to understand</em> <code>join</code></p>
<p><em>Enter the statement below</em></p>
<div id="cd9e71c4" class="cell" data-execution_count="61">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>report_strings <span class="op">=</span> [<span class="st">"report1"</span>, <span class="st">"report2"</span>, <span class="st">"report3"</span>, <span class="st">"report4"</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The above creates a list of four strings, <code>report_strings</code>. Lists are iterators so we can pass this to <code>join</code></p>
<p><em>Call the join function as below</em></p>
<div id="d4bb7850" class="cell" data-execution_count="62">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co">"**"</span>.join(report_strings)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<pre><code>'report1**report2**report3**report4'</code></pre>
</div>
</div>
<p>As observed we iterate over the strings, merging them with <code>**</code> inserted in between. Observe that <code>**</code> is not placed at the start or end of the resulting string</p>
<p><em>Rerun the statement with the newline character below</em></p>
<div id="4788a883" class="cell" data-execution_count="63">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(report_strings))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>report1
report2
report3
report4</code></pre>
</div>
</div>
<p>This does the same but instead each string is printed on its own line</p>
<p>We can use <code>join</code> to concatenate strings by using the empty string</p>
<p><em>Run the following statement</em></p>
<div id="ff6d5bb5" class="cell" data-execution_count="64">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co">""</span>.join(report_strings)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<pre><code>'report1report2report3report4'</code></pre>
</div>
</div>
<ul>
<li><p>After this discussion, we have completed this version of the Time Tracker</p></li>
<li><p>Aside from one final thing, updating the <code>__str__</code> method in <code>Contact</code> to use the <code>session_report</code> property</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__str__</span>(<span class="va">self</span>):</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>      template <span class="op">=</span> <span class="st">"""Name: </span><span class="sc">{0}</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="st">  Address: </span><span class="sc">{1}</span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="st">  Telephone: </span><span class="sc">{2}</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="st">  Hours on the case: </span><span class="sc">{3}</span></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="st">  Amount to bill: </span><span class="sc">{4}</span></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a><span class="st">  Sessions: </span><span class="ch">\n</span><span class="sc">{5}</span><span class="st">"""</span></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> template.<span class="bu">format</span>(</span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.name,</span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.address,</span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.telephone,</span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.hours_worked,</span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.billing_amount,</span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.session_report,</span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a>      )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p>You can find the final implementation in <a href="./Examples/14_TimeTrackerWithSessionHistory/TimeTrackerWithSessionHistory.py">Time Tracker with Session History</a></p></li>
</ul>
</section>
</section>
<section id="exercise-playlist-storage-app" class="level4">
<h4 class="anchored" data-anchor-id="exercise-playlist-storage-app">Exercise: Playlist Storage App</h4>
<p><em>The time tracker application is a very good starting point for any program that you might like to write that stores and manages information. You could replace the sessions with albums and music tracks, salesman and sales artists and pictures - or anything else you want to track</em></p>
<p>In the previous chapter we created a <a href="../../02_AdvancedProgramming/09_UsingClasses/Chapter_09_ExtensionExercises.html#make-something-happen-music-storage-app">Music Storage app</a> that stored songs and could be used to manage a single playlist. Using the framework provided by <a href="#create-a-time-tracker">Time Tracker</a> extend the Music Storage app to be able to manage and store multiple playlists at a time</p>
<p>Thankfully this isn’t as in depth as building the application the first time around. We start by defining our <code>Playlist</code> class</p>
<p>Let us first focus on the data attributes, we want a name and a list of songs. We also want the total runtime. Now for simplicity we’ll leave the <code>name</code> and <code>tracks</code> as public attributes, but we’ll define the <code>runtime</code> as a property, interfacing with a protected variable <code>__runtime</code>. We do this because the runtime is calculated from <code>tracks</code> so we don’t want the caller to modify it themselves.</p>
<p>Inspired by Time Tracker’s <code>session_report</code> we’ll also define a <code>track_report</code> property using that interfaces with <code>map</code> to provide a string representation of the tracks in a playlist where each track is on its own line</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Playlist:</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="co">    A class representing a music playlist with a name and list of tracks</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Tracks and records the length of the playlist</span></span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name, tracks<span class="op">=</span>[]):</span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a><span class="co">        Create a new `Playlist` instance</span></span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters</span></span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a><span class="co">        ----------</span></span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a><span class="co">        name : str</span></span>
<span id="cb121-15"><a href="#cb121-15" aria-hidden="true" tabindex="-1"></a><span class="co">            name to associate with the playlist</span></span>
<span id="cb121-16"><a href="#cb121-16" aria-hidden="true" tabindex="-1"></a><span class="co">        tracks : list, optional</span></span>
<span id="cb121-17"><a href="#cb121-17" aria-hidden="true" tabindex="-1"></a><span class="co">            list of songs in the playlist, by default []</span></span>
<span id="cb121-18"><a href="#cb121-18" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb121-19"><a href="#cb121-19" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.name <span class="op">=</span> name</span>
<span id="cb121-20"><a href="#cb121-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.tracks <span class="op">=</span> tracks</span>
<span id="cb121-21"><a href="#cb121-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__runtime <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb121-22"><a href="#cb121-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> song <span class="kw">in</span> <span class="va">self</span>.tracks:</span>
<span id="cb121-23"><a href="#cb121-23" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.__runtime <span class="op">+=</span> song.length_in_seconds</span>
<span id="cb121-24"><a href="#cb121-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-25"><a href="#cb121-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__str__</span>(<span class="va">self</span>):</span>
<span id="cb121-26"><a href="#cb121-26" aria-hidden="true" tabindex="-1"></a>        template <span class="op">=</span> <span class="st">"""Playlist: </span><span class="sc">{0}</span></span>
<span id="cb121-27"><a href="#cb121-27" aria-hidden="true" tabindex="-1"></a><span class="st">Total Length: </span><span class="sc">{1}</span><span class="st"> s</span></span>
<span id="cb121-28"><a href="#cb121-28" aria-hidden="true" tabindex="-1"></a><span class="st">Songs:</span></span>
<span id="cb121-29"><a href="#cb121-29" aria-hidden="true" tabindex="-1"></a><span class="sc">{2}</span><span class="st">"""</span></span>
<span id="cb121-30"><a href="#cb121-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> template.<span class="bu">format</span>(<span class="va">self</span>.name, <span class="va">self</span>.runtime, <span class="va">self</span>.track_report)</span>
<span id="cb121-31"><a href="#cb121-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-32"><a href="#cb121-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb121-33"><a href="#cb121-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> runtime(<span class="va">self</span>):</span>
<span id="cb121-34"><a href="#cb121-34" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb121-35"><a href="#cb121-35" aria-hidden="true" tabindex="-1"></a><span class="co">        runtime : int</span></span>
<span id="cb121-36"><a href="#cb121-36" aria-hidden="true" tabindex="-1"></a><span class="co">            total run time of the playlist in seconds</span></span>
<span id="cb121-37"><a href="#cb121-37" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb121-38"><a href="#cb121-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.__runtime</span>
<span id="cb121-39"><a href="#cb121-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-40"><a href="#cb121-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb121-41"><a href="#cb121-41" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> track_report(<span class="va">self</span>):</span>
<span id="cb121-42"><a href="#cb121-42" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb121-43"><a href="#cb121-43" aria-hidden="true" tabindex="-1"></a><span class="co">        track_report : str</span></span>
<span id="cb121-44"><a href="#cb121-44" aria-hidden="true" tabindex="-1"></a><span class="co">            string representation of tracks in the playlist, giving each track</span></span>
<span id="cb121-45"><a href="#cb121-45" aria-hidden="true" tabindex="-1"></a><span class="co">            on its own line</span></span>
<span id="cb121-46"><a href="#cb121-46" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb121-47"><a href="#cb121-47" aria-hidden="true" tabindex="-1"></a>        song_strings <span class="op">=</span> <span class="bu">map</span>(<span class="bu">str</span>, <span class="va">self</span>.tracks)</span>
<span id="cb121-48"><a href="#cb121-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(song_strings)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Observe that the constructor takes an optional list of tracks (by default its empty). This means that a user can create a <code>Playlist</code> by name only and then add songs to it (as used in <code>create_playlist</code> below) or we can create a playlist with a list of songs already (as used by <code>suggest_playlist_of_given_length</code>)</p>
<p>Now we want to keep the internal track list and the runtime synchronised, so we add methods on the <code>Playlist</code> class to handle adding, removing and clearing tracks from the playlist</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_track(<span class="va">self</span>, track):</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Add a new track to the playlist</span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Updates the playlist length</span></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a><span class="co">    track : MusicTrack</span></span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a><span class="co">        track to add to the playlist</span></span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a><span class="co">    None</span></span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a><span class="co">    See Also</span></span>
<span id="cb122-17"><a href="#cb122-17" aria-hidden="true" tabindex="-1"></a><span class="co">    --------</span></span>
<span id="cb122-18"><a href="#cb122-18" aria-hidden="true" tabindex="-1"></a><span class="co">    Playlist.remove_track : removes a track from a playlist</span></span>
<span id="cb122-19"><a href="#cb122-19" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb122-20"><a href="#cb122-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># first update runtime so a non-track objects causes an error</span></span>
<span id="cb122-21"><a href="#cb122-21" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.__runtime <span class="op">+=</span> track.length_in_seconds</span>
<span id="cb122-22"><a href="#cb122-22" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.tracks.append(track)</span>
<span id="cb122-23"><a href="#cb122-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-24"><a href="#cb122-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_track(<span class="va">self</span>, track):</span>
<span id="cb122-25"><a href="#cb122-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb122-26"><a href="#cb122-26" aria-hidden="true" tabindex="-1"></a><span class="co">    Remove a track from the playlist</span></span>
<span id="cb122-27"><a href="#cb122-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-28"><a href="#cb122-28" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb122-29"><a href="#cb122-29" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb122-30"><a href="#cb122-30" aria-hidden="true" tabindex="-1"></a><span class="co">    track : MusicTrack</span></span>
<span id="cb122-31"><a href="#cb122-31" aria-hidden="true" tabindex="-1"></a><span class="co">        track to remove from the playlist</span></span>
<span id="cb122-32"><a href="#cb122-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-33"><a href="#cb122-33" aria-hidden="true" tabindex="-1"></a><span class="co">    See Also</span></span>
<span id="cb122-34"><a href="#cb122-34" aria-hidden="true" tabindex="-1"></a><span class="co">    --------</span></span>
<span id="cb122-35"><a href="#cb122-35" aria-hidden="true" tabindex="-1"></a><span class="co">    Playlist.add_track : add a track to a playlist</span></span>
<span id="cb122-36"><a href="#cb122-36" aria-hidden="true" tabindex="-1"></a><span class="co">    Playlist.clear_tracks : remove all tracks from a playlist</span></span>
<span id="cb122-37"><a href="#cb122-37" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb122-38"><a href="#cb122-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb122-39"><a href="#cb122-39" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.tracks.remove(track)</span>
<span id="cb122-40"><a href="#cb122-40" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__runtime <span class="op">-=</span> track.length_in_seconds</span>
<span id="cb122-41"><a href="#cb122-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">ValueError</span>:</span>
<span id="cb122-42"><a href="#cb122-42" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Could not find track:"</span>, track.name, <span class="st">"in the playlist"</span>)</span>
<span id="cb122-43"><a href="#cb122-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-44"><a href="#cb122-44" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clear_tracks(<span class="va">self</span>):</span>
<span id="cb122-45"><a href="#cb122-45" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb122-46"><a href="#cb122-46" aria-hidden="true" tabindex="-1"></a><span class="co">    Remove all tracks from a playlist</span></span>
<span id="cb122-47"><a href="#cb122-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-48"><a href="#cb122-48" aria-hidden="true" tabindex="-1"></a><span class="co">    Runtime is set to 0</span></span>
<span id="cb122-49"><a href="#cb122-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-50"><a href="#cb122-50" aria-hidden="true" tabindex="-1"></a><span class="co">    See Also</span></span>
<span id="cb122-51"><a href="#cb122-51" aria-hidden="true" tabindex="-1"></a><span class="co">    --------</span></span>
<span id="cb122-52"><a href="#cb122-52" aria-hidden="true" tabindex="-1"></a><span class="co">    Playlist.remove_track : remove a single track from a playlist</span></span>
<span id="cb122-53"><a href="#cb122-53" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb122-54"><a href="#cb122-54" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.tracks.clear()</span>
<span id="cb122-55"><a href="#cb122-55" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.__runtime <span class="op">=</span> <span class="dv">0</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>These are all relatively simple, the takeaway is that as we update the track list, we also ensure the runtime is kept synchronised</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>It is important to keep data synchronised</strong></p>
<p>We store the runtime as a separate variable so that we don’t need to calculate it on the fly every time a function requires it. However this introduces the difficulty that we have to keep <code>runtime</code> synched with the data it is representing (the sum of the length of the tracks in the <code>tracks</code> attribute). This is important in real world scenarios, as if these two data attributes diverge we might get nonsense results.</p>
<p>This is actually one of the big reasons why we like to make data attributes private, it ensures we can maintain the relationships between elements.</p>
</div>
</div>
<p>As written our code has the problem that data could become desynchronised because the user can directly modify the <code>tracks</code> list. We can’t get around this easily by making a read-only property, because it we return a reference to a list, than any changes on that reference would propagate to the original list</p>
<p>One option would be to provide a deep copy (a unique copy for each call), or another would be make <code>tracks</code> private and define methods on the class for all the necessary interactions. I haven’t done this to minimise the disruption to the overall API, since this current API lets us reuse the adding and searching functionality we defined for the complete list of tracks. This could be something we change in the future</p>
<p>Lets now consider how we want to program to work. Previously we had one playlist. Now like the tracks, we want a list of them. However we still want to be able to work on and modify a playlist. To minimise the changes from the original design lets use the following approach</p>
<ol type="1">
<li>There will be a list of playlists
<ul>
<li>These will be loaded and saved to memory like the track list</li>
</ul></li>
<li>There will be one active playlist at a time
<ul>
<li>At the start there is no active playlist</li>
<li>The user can create a new playlist</li>
<li>The user can select an existing playlist</li>
<li>The user can use the existing playlist generation feature</li>
</ul></li>
</ol>
<p>By keeping the one active global playlist we can minimise the disruption to our program. We can reuse existing functions making note that the current playlist has changed from a list of tracks to a <code>Playlist</code> object</p>
<p>Our new Playlist menu now looks like,</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_playlist_management_menu():</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Provides the user with a looping playlist menu</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a><span class="co">    1. Create a new playlist</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a><span class="co">    2. Select playlist</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a><span class="co">    3. Get a suggested playlist of a target length</span></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a><span class="co">    4. Add a track to the playlist</span></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a><span class="co">    5. Remove a track from the playlist</span></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a><span class="co">    6. Clear the playlist</span></span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a><span class="co">    7. Display the playlist</span></span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a><span class="co">    8. Show the runtime of the playlist</span></span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a><span class="co">    9. Export the current playlist</span></span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a><span class="co">    10. Return to the main menu</span></span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a><span class="co">    None</span></span>
<span id="cb123-19"><a href="#cb123-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-20"><a href="#cb123-20" aria-hidden="true" tabindex="-1"></a><span class="co">    Raises</span></span>
<span id="cb123-21"><a href="#cb123-21" aria-hidden="true" tabindex="-1"></a><span class="co">    ------</span></span>
<span id="cb123-22"><a href="#cb123-22" aria-hidden="true" tabindex="-1"></a><span class="co">    ValueError</span></span>
<span id="cb123-23"><a href="#cb123-23" aria-hidden="true" tabindex="-1"></a><span class="co">        An invalid number is encountered in menu selection, should not</span></span>
<span id="cb123-24"><a href="#cb123-24" aria-hidden="true" tabindex="-1"></a><span class="co">        occur in live code, please raise a bug report if encountered</span></span>
<span id="cb123-25"><a href="#cb123-25" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb123-26"><a href="#cb123-26" aria-hidden="true" tabindex="-1"></a>    playlist_management_menu <span class="op">=</span> <span class="st">"""Playlist Management</span></span>
<span id="cb123-27"><a href="#cb123-27" aria-hidden="true" tabindex="-1"></a><span class="st">Current playlist is </span><span class="sc">{0}</span></span>
<span id="cb123-28"><a href="#cb123-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-29"><a href="#cb123-29" aria-hidden="true" tabindex="-1"></a><span class="st">1. Create a new playlist</span></span>
<span id="cb123-30"><a href="#cb123-30" aria-hidden="true" tabindex="-1"></a><span class="st">2. Select playlist</span></span>
<span id="cb123-31"><a href="#cb123-31" aria-hidden="true" tabindex="-1"></a><span class="st">3. Get a suggested playlist of a target length</span></span>
<span id="cb123-32"><a href="#cb123-32" aria-hidden="true" tabindex="-1"></a><span class="st">4. Add a track to the playlist</span></span>
<span id="cb123-33"><a href="#cb123-33" aria-hidden="true" tabindex="-1"></a><span class="st">5. Remove a track from the playlist</span></span>
<span id="cb123-34"><a href="#cb123-34" aria-hidden="true" tabindex="-1"></a><span class="st">6. Clear the playlist</span></span>
<span id="cb123-35"><a href="#cb123-35" aria-hidden="true" tabindex="-1"></a><span class="st">7. Display the playlist</span></span>
<span id="cb123-36"><a href="#cb123-36" aria-hidden="true" tabindex="-1"></a><span class="st">8. Show the runtime of the playlist</span></span>
<span id="cb123-37"><a href="#cb123-37" aria-hidden="true" tabindex="-1"></a><span class="st">9. Export the current playlist</span></span>
<span id="cb123-38"><a href="#cb123-38" aria-hidden="true" tabindex="-1"></a><span class="st">10. Return to the main menu</span></span>
<span id="cb123-39"><a href="#cb123-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-40"><a href="#cb123-40" aria-hidden="true" tabindex="-1"></a><span class="st">Enter your command: """</span></span>
<span id="cb123-41"><a href="#cb123-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb123-42"><a href="#cb123-42" aria-hidden="true" tabindex="-1"></a>        command <span class="op">=</span> BTCInput.read_int_ranged(</span>
<span id="cb123-43"><a href="#cb123-43" aria-hidden="true" tabindex="-1"></a>            prompt<span class="op">=</span>playlist_management_menu.<span class="bu">format</span>(current_playlist.name),</span>
<span id="cb123-44"><a href="#cb123-44" aria-hidden="true" tabindex="-1"></a>            min_value<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb123-45"><a href="#cb123-45" aria-hidden="true" tabindex="-1"></a>            max_value<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb123-46"><a href="#cb123-46" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb123-47"><a href="#cb123-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> command <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb123-48"><a href="#cb123-48" aria-hidden="true" tabindex="-1"></a>            create_playlist()</span>
<span id="cb123-49"><a href="#cb123-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> command <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb123-50"><a href="#cb123-50" aria-hidden="true" tabindex="-1"></a>            select_playlist()</span>
<span id="cb123-51"><a href="#cb123-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> command <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb123-52"><a href="#cb123-52" aria-hidden="true" tabindex="-1"></a>            suggest_playlist_of_given_length()</span>
<span id="cb123-53"><a href="#cb123-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> command <span class="op">==</span> <span class="dv">10</span>:</span>
<span id="cb123-54"><a href="#cb123-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb123-55"><a href="#cb123-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> current_playlist.name <span class="op">==</span> <span class="st">"None"</span>:</span>
<span id="cb123-56"><a href="#cb123-56" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"There is no active playlist. Please select or create one"</span>)</span>
<span id="cb123-57"><a href="#cb123-57" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb123-58"><a href="#cb123-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> command <span class="op">==</span> <span class="dv">4</span>:</span>
<span id="cb123-59"><a href="#cb123-59" aria-hidden="true" tabindex="-1"></a>            add_track_to_playlist()</span>
<span id="cb123-60"><a href="#cb123-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> command <span class="op">==</span> <span class="dv">5</span>:</span>
<span id="cb123-61"><a href="#cb123-61" aria-hidden="true" tabindex="-1"></a>            remove_tracks_from_playlist()</span>
<span id="cb123-62"><a href="#cb123-62" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> command <span class="op">==</span> <span class="dv">6</span>:</span>
<span id="cb123-63"><a href="#cb123-63" aria-hidden="true" tabindex="-1"></a>            clear_playlist()</span>
<span id="cb123-64"><a href="#cb123-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> command <span class="op">==</span> <span class="dv">7</span>:</span>
<span id="cb123-65"><a href="#cb123-65" aria-hidden="true" tabindex="-1"></a>            display_playlist(current_playlist, name_only<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb123-66"><a href="#cb123-66" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> command <span class="op">==</span> <span class="dv">8</span>:</span>
<span id="cb123-67"><a href="#cb123-67" aria-hidden="true" tabindex="-1"></a>            calculate_playlist_length()</span>
<span id="cb123-68"><a href="#cb123-68" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> command <span class="op">==</span> <span class="dv">9</span>:</span>
<span id="cb123-69"><a href="#cb123-69" aria-hidden="true" tabindex="-1"></a>            export_playlist()</span>
<span id="cb123-70"><a href="#cb123-70" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb123-71"><a href="#cb123-71" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(</span>
<span id="cb123-72"><a href="#cb123-72" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Invalid command id "</span></span>
<span id="cb123-73"><a href="#cb123-73" aria-hidden="true" tabindex="-1"></a>                <span class="op">+</span> <span class="bu">str</span>(command)</span>
<span id="cb123-74"><a href="#cb123-74" aria-hidden="true" tabindex="-1"></a>                <span class="op">+</span> <span class="st">" found in playlist management sub-menu"</span></span>
<span id="cb123-75"><a href="#cb123-75" aria-hidden="true" tabindex="-1"></a>            )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>You can see that we’ve defined new functions,</p>
<ol type="1">
<li><code>create_playlist</code></li>
<li><code>select_playlist</code></li>
<li><code>display_playlist</code></li>
</ol>
<p>and that we’ve renamed the old <code>save_playlist</code> function to <code>export_playlist</code>. This last change is because we’ve introduced <code>save_playlists</code> and <code>load_playlists</code> as functions to pickle and un-pickle the playlists binary data. Renaming <code>save_playlist</code> to <code>export_playlist</code> makes it clear that this function is not related to those two.</p>
<p>You also might notice that we’ve reordered the menu so that all the functions dealing with changing the current playlist (<code>create_playlist</code>, <code>select_playlist</code>, <code>suggest_playlist_of_given_length</code>) come first. This allows us to then check that we have an active playlist before running any of the other commands. We also check if user has decided to exit here to, since if we put it after the check for an active playlist the user can’t exit the playlist menu if the don’t have an active playlist</p>
<p>As mentioned, at the start there is no active playlist. Now the simplest way to implement this would be to initially set the <code>current_playlist</code> to <code>None</code>. However you can see this has a problem, we want the playlist menu to display the name of the current playlist, this doesn’t work if the current playlist is <code>None</code>. We could add some error checking, but we’ll instead use a technique called a <code>None</code> or <code>Null</code> object. This is an instance of an object that is designed to represent cases where the object does not actually exist. For us, we simply define a <code>Playlist</code> with the name <code>None</code></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># null object</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>no_playlist <span class="op">=</span> Playlist(name<span class="op">=</span><span class="st">"None"</span>)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>current_playlist <span class="op">=</span> no_playlist</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Let us look now at the new functions we’ve defined, the first pair</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> valid_playlist_name(name):</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Verifies that a playlist name is valid</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Playlist names must be unique</span></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a><span class="co">    name : str</span></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a><span class="co">        proposed name for a playlist</span></span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a><span class="co">    bool</span></span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a><span class="co">        `True` if playlist name is valid else, `False`</span></span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> name <span class="op">==</span> <span class="st">"None"</span>:</span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> playlist <span class="kw">in</span> playlists:</span>
<span id="cb125-20"><a href="#cb125-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> name <span class="op">==</span> playlist.name:</span>
<span id="cb125-21"><a href="#cb125-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb125-22"><a href="#cb125-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb125-23"><a href="#cb125-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-24"><a href="#cb125-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-25"><a href="#cb125-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_playlist(tracks<span class="op">=</span>[]):</span>
<span id="cb125-26"><a href="#cb125-26" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb125-27"><a href="#cb125-27" aria-hidden="true" tabindex="-1"></a><span class="co">    Create a new playlist and make it the active playlist</span></span>
<span id="cb125-28"><a href="#cb125-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-29"><a href="#cb125-29" aria-hidden="true" tabindex="-1"></a><span class="co">    Prompts the user for a new name for the playlist, and ensures its valid</span></span>
<span id="cb125-30"><a href="#cb125-30" aria-hidden="true" tabindex="-1"></a><span class="co">    then constructs a playlist and sets it as the current active playlist</span></span>
<span id="cb125-31"><a href="#cb125-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-32"><a href="#cb125-32" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb125-33"><a href="#cb125-33" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb125-34"><a href="#cb125-34" aria-hidden="true" tabindex="-1"></a><span class="co">    tracks : list, optional</span></span>
<span id="cb125-35"><a href="#cb125-35" aria-hidden="true" tabindex="-1"></a><span class="co">        tracks to assign to the playlist, by default []</span></span>
<span id="cb125-36"><a href="#cb125-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-37"><a href="#cb125-37" aria-hidden="true" tabindex="-1"></a><span class="co">    See Also</span></span>
<span id="cb125-38"><a href="#cb125-38" aria-hidden="true" tabindex="-1"></a><span class="co">    --------</span></span>
<span id="cb125-39"><a href="#cb125-39" aria-hidden="true" tabindex="-1"></a><span class="co">    valid_playlist_name : validates a playlist name</span></span>
<span id="cb125-40"><a href="#cb125-40" aria-hidden="true" tabindex="-1"></a><span class="co">    Playlist : class used to represent a playlist</span></span>
<span id="cb125-41"><a href="#cb125-41" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb125-42"><a href="#cb125-42" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Create a new playlist"</span>)</span>
<span id="cb125-43"><a href="#cb125-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> current_playlist</span>
<span id="cb125-44"><a href="#cb125-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-45"><a href="#cb125-45" aria-hidden="true" tabindex="-1"></a>    new_playlist_name <span class="op">=</span> BTCInput.read_text(<span class="st">"Enter the playlist name: "</span>)</span>
<span id="cb125-46"><a href="#cb125-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="kw">not</span> valid_playlist_name(new_playlist_name):</span>
<span id="cb125-47"><a href="#cb125-47" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"That playlist name is already in use"</span>)</span>
<span id="cb125-48"><a href="#cb125-48" aria-hidden="true" tabindex="-1"></a>        new_playlist_name <span class="op">=</span> BTCInput.read_text(<span class="st">"Enter the playlist name: "</span>)</span>
<span id="cb125-49"><a href="#cb125-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-50"><a href="#cb125-50" aria-hidden="true" tabindex="-1"></a>    new_playlist <span class="op">=</span> Playlist(new_playlist_name, tracks)</span>
<span id="cb125-51"><a href="#cb125-51" aria-hidden="true" tabindex="-1"></a>    current_playlist <span class="op">=</span> new_playlist</span>
<span id="cb125-52"><a href="#cb125-52" aria-hidden="true" tabindex="-1"></a>    playlists.append(new_playlist)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Prompts the user for the name of a new playlist. We add code that means the user can’t override the <code>NoneObject</code> or use duplicate names which is given by the function <code>valid_playlist_name</code>. Unlike the validation code in the Time Tracker this is not in the class, because it is part of the business logic of the application layer, not the playlist itself</p>
<p>We then define the <code>select_playlist</code> function,</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> select_playlist():</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Select an existing playlist to be the current playlist</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Prompts the user for a search name then returns all playlists</span></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a><span class="co">    that match that string. The user will be displayed each playlist</span></span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a><span class="co">    in turn and asked if they want to make that the current playlist</span></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a><span class="co">    Notes</span></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a><span class="co">    -----</span></span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a><span class="co">    Passing the empty string can be used to display all playlists</span></span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Select a playlist"</span>)</span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> current_playlist</span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a>    search_name <span class="op">=</span> BTCInput.read_text(<span class="st">"Enter playlist name (enter to see ): "</span>)</span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a>    matched_playlists <span class="op">=</span> []</span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> playlist <span class="kw">in</span> playlists:</span>
<span id="cb126-21"><a href="#cb126-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> playlist.name.strip().lower().startswith(search_name.strip().lower()):</span>
<span id="cb126-22"><a href="#cb126-22" aria-hidden="true" tabindex="-1"></a>            matched_playlists.append(playlist)</span>
<span id="cb126-23"><a href="#cb126-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-24"><a href="#cb126-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(matched_playlists) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb126-25"><a href="#cb126-25" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Found </span><span class="sc">{0}</span><span class="st"> matches"</span>.<span class="bu">format</span>(<span class="bu">len</span>(matched_playlists)))</span>
<span id="cb126-26"><a href="#cb126-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> playlist <span class="kw">in</span> matched_playlists:</span>
<span id="cb126-27"><a href="#cb126-27" aria-hidden="true" tabindex="-1"></a>            display_playlist(playlist)</span>
<span id="cb126-28"><a href="#cb126-28" aria-hidden="true" tabindex="-1"></a>            select <span class="op">=</span> BTCInput.read_int_ranged(</span>
<span id="cb126-29"><a href="#cb126-29" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Select this playlist? (1 - Yes, 0 - No): "</span>, min_value<span class="op">=</span><span class="dv">0</span>, max_value<span class="op">=</span><span class="dv">1</span></span>
<span id="cb126-30"><a href="#cb126-30" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb126-31"><a href="#cb126-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> select:</span>
<span id="cb126-32"><a href="#cb126-32" aria-hidden="true" tabindex="-1"></a>                current_playlist <span class="op">=</span> playlist</span>
<span id="cb126-33"><a href="#cb126-33" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb126-34"><a href="#cb126-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb126-35"><a href="#cb126-35" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"No playlists found matching that name"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Since no other method needs to search for playlist names, we forgo our usual pattern of defining a <code>find</code> and <code>filter</code> function and just combine it all in the one function. Additionally <code>select</code> is also used for letting the user see what playlists are stored in the program. A future version might add an explicit function called this (perhaps <code>list_playlists</code>)</p>
<p>This program works pretty simply. We use the standard name matching pattern, then for each match the user is shown the playlist name and runtime, and is given the option to select it. If they do then the current playlist is set to that playlist and the function ends, else it continues to the next.</p>
<p>Lastly we have our <code>display_playlist</code> function, to print a playlist</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> display_playlist(playlist, name_only<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Display a playlist</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Can optionally list all the tracks or just the name and length</span></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a><span class="co">    playlist : Playlist</span></span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a><span class="co">        playlist to display</span></span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a><span class="co">    name_only : bool, optional</span></span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a><span class="co">        only display the playlists name and runtime, by default `True`</span></span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a><span class="co">    None</span></span>
<span id="cb127-17"><a href="#cb127-17" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb127-18"><a href="#cb127-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> name_only:</span>
<span id="cb127-19"><a href="#cb127-19" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"</span><span class="sc">{0}</span><span class="st"> (</span><span class="sc">{1}</span><span class="st"> s)"</span>.<span class="bu">format</span>(playlist.name, playlist.runtime))</span>
<span id="cb127-20"><a href="#cb127-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb127-21"><a href="#cb127-21" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(playlist)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>The optional <code>name_only</code> parameter is used indicate that we only want to print the playlist name and length, otherwise we defer to the <code>Playlist</code> <code>__str__</code> method and print everything.</p>
<p>This captures the last of the high level changes. As mentioned, we have to make minor changes to the existing functions, such as to <code>suggest_playlist_of_given_length</code> shown below</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> suggest_playlist_of_given_length():</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Suggests a playlist of length less than or equal to</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="co">    a user prompted length</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Asks the user for a maximum playlist length, and</span></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a><span class="co">    then suggests a playlist by combining tracks randomly</span></span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a><span class="co">    such that the suggested playlist is no greater than</span></span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a><span class="co">    the length</span></span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a><span class="co">    The user has the option to review the proposed list</span></span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a><span class="co">    and either accept, reject or regenerate the list</span></span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a><span class="co">    None</span></span>
<span id="cb128-17"><a href="#cb128-17" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb128-18"><a href="#cb128-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Suggest playlist of given length"</span>)</span>
<span id="cb128-19"><a href="#cb128-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> current_playlist</span>
<span id="cb128-20"><a href="#cb128-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-21"><a href="#cb128-21" aria-hidden="true" tabindex="-1"></a>    target_length <span class="op">=</span> read_min_valued_integer(</span>
<span id="cb128-22"><a href="#cb128-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Enter maximum playlist length: "</span>, min_value<span class="op">=</span><span class="dv">1</span></span>
<span id="cb128-23"><a href="#cb128-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb128-24"><a href="#cb128-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-25"><a href="#cb128-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb128-26"><a href="#cb128-26" aria-hidden="true" tabindex="-1"></a>        suggested_tracks <span class="op">=</span> []</span>
<span id="cb128-27"><a href="#cb128-27" aria-hidden="true" tabindex="-1"></a>        suggested_tracks_total_length <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb128-28"><a href="#cb128-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># find tracks that could fit in the playlist</span></span>
<span id="cb128-29"><a href="#cb128-29" aria-hidden="true" tabindex="-1"></a>        candidate_songs <span class="op">=</span> filter_tracks_shorter_than_length(target_length, tracks)</span>
<span id="cb128-30"><a href="#cb128-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-31"><a href="#cb128-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(candidate_songs) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb128-32"><a href="#cb128-32" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Could not generate a playlist of that length. Try a longer playlist"</span>)</span>
<span id="cb128-33"><a href="#cb128-33" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb128-34"><a href="#cb128-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-35"><a href="#cb128-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="bu">len</span>(candidate_songs) <span class="op">&gt;</span> <span class="dv">0</span>:  <span class="co"># stop when no more eligible songs</span></span>
<span id="cb128-36"><a href="#cb128-36" aria-hidden="true" tabindex="-1"></a>            <span class="co"># add a random song and update the playlist length</span></span>
<span id="cb128-37"><a href="#cb128-37" aria-hidden="true" tabindex="-1"></a>            song_choice <span class="op">=</span> random.choice(candidate_songs)</span>
<span id="cb128-38"><a href="#cb128-38" aria-hidden="true" tabindex="-1"></a>            suggested_tracks.append(song_choice)</span>
<span id="cb128-39"><a href="#cb128-39" aria-hidden="true" tabindex="-1"></a>            suggested_tracks_total_length <span class="op">=</span> (</span>
<span id="cb128-40"><a href="#cb128-40" aria-hidden="true" tabindex="-1"></a>                suggested_tracks_total_length <span class="op">+</span> song_choice.length_in_seconds</span>
<span id="cb128-41"><a href="#cb128-41" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb128-42"><a href="#cb128-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-43"><a href="#cb128-43" aria-hidden="true" tabindex="-1"></a>            <span class="co"># filter out songs that no longer fit</span></span>
<span id="cb128-44"><a href="#cb128-44" aria-hidden="true" tabindex="-1"></a>            candidate_songs <span class="op">=</span> filter_tracks_shorter_than_length(</span>
<span id="cb128-45"><a href="#cb128-45" aria-hidden="true" tabindex="-1"></a>                target_length <span class="op">-</span> suggested_tracks_total_length, candidate_songs</span>
<span id="cb128-46"><a href="#cb128-46" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb128-47"><a href="#cb128-47" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Generated a playlist..."</span>)</span>
<span id="cb128-48"><a href="#cb128-48" aria-hidden="true" tabindex="-1"></a>        <span class="co"># let the user review the playlist</span></span>
<span id="cb128-49"><a href="#cb128-49" aria-hidden="true" tabindex="-1"></a>        display_tracks(suggested_tracks)</span>
<span id="cb128-50"><a href="#cb128-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> BTCInput.read_int_ranged(</span>
<span id="cb128-51"><a href="#cb128-51" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Accept this playlist? (1 - Yes, 0 - No): "</span>, min_value<span class="op">=</span><span class="dv">0</span>, max_value<span class="op">=</span><span class="dv">1</span></span>
<span id="cb128-52"><a href="#cb128-52" aria-hidden="true" tabindex="-1"></a>        ):</span>
<span id="cb128-53"><a href="#cb128-53" aria-hidden="true" tabindex="-1"></a>            create_playlist(suggested_tracks)</span>
<span id="cb128-54"><a href="#cb128-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb128-55"><a href="#cb128-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb128-56"><a href="#cb128-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> BTCInput.read_int_ranged(</span>
<span id="cb128-57"><a href="#cb128-57" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Generate again? (1 - Yes, 0 - No): "</span>, min_value<span class="op">=</span><span class="dv">0</span>, max_value<span class="op">=</span><span class="dv">1</span></span>
<span id="cb128-58"><a href="#cb128-58" aria-hidden="true" tabindex="-1"></a>            ):</span>
<span id="cb128-59"><a href="#cb128-59" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb128-60"><a href="#cb128-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Here we still build up the suggested playlist as before (using a list) but once the user decides to keep this playlist, we then call <code>create_playlist</code> passing in the track list to create a proper named <code>Playlist</code> object</p>
<p>You are encouraged to work through the full program yourself (<a href="./Exercises/01_PlaylistStorageApp/PlaylistStorage.py">PlaylistStorage.py</a>)</p>
</section>
</section>
<section id="make-music-with-snaps" class="level3">
<h3 class="anchored" data-anchor-id="make-music-with-snaps">Make Music with Snaps</h3>
<ul>
<li><p>Let’s build a simple music keyboard</p></li>
<li><p>We’ll add a simple music player</p></li>
<li><p>Extend with some playback options</p></li>
<li><p>The snaps library code provides some music notes to use</p>
<ul>
<li><p>stored in <code>MusicNotes</code></p></li>
<li><p><code>play_note</code> lets us play a note</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>If when running the program you get a file not found error, you may need to modify the path in <code>play_note</code> to either <code>MusicNotes\\</code> or <code>MusicNotes/</code></p>
<p>This path is relative to snaps and so the folder must in the same directory as snaps</p>
</div>
</div></li>
</ul></li>
<li><p>We can start with a simple program that <a href="./Examples/15_MusicWithSnaps/01_PlayNotes.py">plays all the notes</a>,</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Example 10.15.1 Play Notes</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Demonstrates using snaps to play notes</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>  <span class="im">import</span> time</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>  <span class="im">import</span> snaps</span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> note <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">13</span>):</span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a>      snaps.play_note(note)</span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a>      time.sleep(<span class="fl">0.5</span>)</span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a>  <span class="bu">input</span>(<span class="st">"Press enter to continue..."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p>We use <code>time.sleep(0.5)</code> to stagger playing the notes</p></li>
<li><p>We could also play a tune,</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Example 10.15.2 Twinkle Twinkle</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Uses snaps to play a simple tune</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>  <span class="im">import</span> time</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>  <span class="im">import</span> snaps</span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a>  snaps.play_note(<span class="dv">0</span>)</span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a>  time.sleep(<span class="fl">0.4</span>)</span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a>  snaps.play_note(<span class="dv">0</span>)</span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a>  time.sleep(<span class="fl">0.4</span>)</span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true" tabindex="-1"></a>  snaps.play_note(<span class="dv">7</span>)</span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a>  time.sleep(<span class="fl">0.4</span>)</span>
<span id="cb130-15"><a href="#cb130-15" aria-hidden="true" tabindex="-1"></a>  snaps.play_note(<span class="dv">7</span>)</span>
<span id="cb130-16"><a href="#cb130-16" aria-hidden="true" tabindex="-1"></a>  time.sleep(<span class="fl">0.4</span>)</span>
<span id="cb130-17"><a href="#cb130-17" aria-hidden="true" tabindex="-1"></a>  snaps.play_note(<span class="dv">9</span>)</span>
<span id="cb130-18"><a href="#cb130-18" aria-hidden="true" tabindex="-1"></a>  time.sleep(<span class="fl">0.4</span>)</span>
<span id="cb130-19"><a href="#cb130-19" aria-hidden="true" tabindex="-1"></a>  snaps.play_note(<span class="dv">9</span>)</span>
<span id="cb130-20"><a href="#cb130-20" aria-hidden="true" tabindex="-1"></a>  time.sleep(<span class="fl">0.4</span>)</span>
<span id="cb130-21"><a href="#cb130-21" aria-hidden="true" tabindex="-1"></a>  snaps.play_note(<span class="dv">7</span>)</span>
<span id="cb130-22"><a href="#cb130-22" aria-hidden="true" tabindex="-1"></a>  time.sleep(<span class="fl">0.8</span>)</span>
<span id="cb130-23"><a href="#cb130-23" aria-hidden="true" tabindex="-1"></a>  snaps.play_note(<span class="dv">5</span>)</span>
<span id="cb130-24"><a href="#cb130-24" aria-hidden="true" tabindex="-1"></a>  time.sleep(<span class="fl">0.4</span>)</span>
<span id="cb130-25"><a href="#cb130-25" aria-hidden="true" tabindex="-1"></a>  snaps.play_note(<span class="dv">5</span>)</span>
<span id="cb130-26"><a href="#cb130-26" aria-hidden="true" tabindex="-1"></a>  time.sleep(<span class="fl">0.4</span>)</span>
<span id="cb130-27"><a href="#cb130-27" aria-hidden="true" tabindex="-1"></a>  snaps.play_note(<span class="dv">4</span>)</span>
<span id="cb130-28"><a href="#cb130-28" aria-hidden="true" tabindex="-1"></a>  time.sleep(<span class="fl">0.4</span>)</span>
<span id="cb130-29"><a href="#cb130-29" aria-hidden="true" tabindex="-1"></a>  snaps.play_note(<span class="dv">4</span>)</span>
<span id="cb130-30"><a href="#cb130-30" aria-hidden="true" tabindex="-1"></a>  time.sleep(<span class="fl">0.4</span>)</span>
<span id="cb130-31"><a href="#cb130-31" aria-hidden="true" tabindex="-1"></a>  snaps.play_note(<span class="dv">2</span>)</span>
<span id="cb130-32"><a href="#cb130-32" aria-hidden="true" tabindex="-1"></a>  time.sleep(<span class="fl">0.4</span>)</span>
<span id="cb130-33"><a href="#cb130-33" aria-hidden="true" tabindex="-1"></a>  snaps.play_note(<span class="dv">2</span>)</span>
<span id="cb130-34"><a href="#cb130-34" aria-hidden="true" tabindex="-1"></a>  time.sleep(<span class="fl">0.4</span>)</span>
<span id="cb130-35"><a href="#cb130-35" aria-hidden="true" tabindex="-1"></a>  snaps.play_note(<span class="dv">0</span>)</span>
<span id="cb130-36"><a href="#cb130-36" aria-hidden="true" tabindex="-1"></a>  time.sleep(<span class="fl">0.8</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p>We can see this is already becoming tedious</p></li>
<li><p>We repeatedly write the <code>play_note</code> followed by a <code>sleep</code> time</p></li>
<li><p>Have to manually modify the code</p></li>
<li><p>We could make this <em>data-driven</em></p></li>
<li><p>We supply a list of tuples</p>
<ul>
<li>Each tuple contains the id for a note and the time to sleep after playing that note</li>
</ul></li>
<li><p>Then simply loop over the list to play the tune</p></li>
<li><p>Can then play anything by just changing the embedded data</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Example 10.15.3 Twinkle Twinkle with Tuples</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Converts play notes to a data-driven program using tuples to specify notes</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># and how long to pause after</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>  <span class="im">import</span> time</span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>  <span class="im">import</span> snaps</span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>  tune <span class="op">=</span> [</span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">0</span>, <span class="fl">0.4</span>),</span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">0</span>, <span class="fl">0.4</span>),</span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">7</span>, <span class="fl">0.4</span>),</span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">7</span>, <span class="fl">0.4</span>),</span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">9</span>, <span class="fl">0.4</span>),</span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">9</span>, <span class="fl">0.4</span>),</span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">7</span>, <span class="fl">0.8</span>),</span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">5</span>, <span class="fl">0.4</span>),</span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">5</span>, <span class="fl">0.4</span>),</span>
<span id="cb131-20"><a href="#cb131-20" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">4</span>, <span class="fl">0.4</span>),</span>
<span id="cb131-21"><a href="#cb131-21" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">4</span>, <span class="fl">0.4</span>),</span>
<span id="cb131-22"><a href="#cb131-22" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">2</span>, <span class="fl">0.4</span>),</span>
<span id="cb131-23"><a href="#cb131-23" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">2</span>, <span class="fl">0.4</span>),</span>
<span id="cb131-24"><a href="#cb131-24" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">0</span>, <span class="fl">0.8</span>),</span>
<span id="cb131-25"><a href="#cb131-25" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb131-26"><a href="#cb131-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-27"><a href="#cb131-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> note <span class="kw">in</span> tune:</span>
<span id="cb131-28"><a href="#cb131-28" aria-hidden="true" tabindex="-1"></a>      note_id, sleep_time <span class="op">=</span> note</span>
<span id="cb131-29"><a href="#cb131-29" aria-hidden="true" tabindex="-1"></a>      snaps.play_note(note_id)</span>
<span id="cb131-30"><a href="#cb131-30" aria-hidden="true" tabindex="-1"></a>      time.sleep(sleep_time)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p>Each tuple stores the note and the sleep time</p></li>
<li><p>We then loop over the tuples</p></li>
<li><p>We use unpacking to assign the elements of the tuple meaningful names (<code>note_id</code> and <code>sleep_time</code>)</p></li>
<li><p>While playback is simple, constructing is not necessarily</p>
<ul>
<li>The tuples are undocumented and rely on the programmer knowing the indices</li>
</ul></li>
<li><p>We could instead define a lightweight class</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Example 10.15.4 Twinkle Twinkle with Classes</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Modifies the data driven tuple implementation by defining a lightweight</span></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Note class</span></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>  <span class="im">import</span> time</span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>  <span class="im">import</span> snaps</span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">class</span> Note:</span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a>      <span class="co">"""</span></span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a><span class="co">      Musical note with a playback duration.</span></span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a><span class="co">      """</span></span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-16"><a href="#cb132-16" aria-hidden="true" tabindex="-1"></a>      <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, note, duration):</span>
<span id="cb132-17"><a href="#cb132-17" aria-hidden="true" tabindex="-1"></a>          <span class="co">"""</span></span>
<span id="cb132-18"><a href="#cb132-18" aria-hidden="true" tabindex="-1"></a><span class="co">          Create a `Note` instance</span></span>
<span id="cb132-19"><a href="#cb132-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-20"><a href="#cb132-20" aria-hidden="true" tabindex="-1"></a><span class="co">          Parameters</span></span>
<span id="cb132-21"><a href="#cb132-21" aria-hidden="true" tabindex="-1"></a><span class="co">          ----------</span></span>
<span id="cb132-22"><a href="#cb132-22" aria-hidden="true" tabindex="-1"></a><span class="co">          note : int</span></span>
<span id="cb132-23"><a href="#cb132-23" aria-hidden="true" tabindex="-1"></a><span class="co">              id of the note to play</span></span>
<span id="cb132-24"><a href="#cb132-24" aria-hidden="true" tabindex="-1"></a><span class="co">          duration : int | float</span></span>
<span id="cb132-25"><a href="#cb132-25" aria-hidden="true" tabindex="-1"></a><span class="co">              duration of the note</span></span>
<span id="cb132-26"><a href="#cb132-26" aria-hidden="true" tabindex="-1"></a><span class="co">          """</span></span>
<span id="cb132-27"><a href="#cb132-27" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.__note <span class="op">=</span> note</span>
<span id="cb132-28"><a href="#cb132-28" aria-hidden="true" tabindex="-1"></a>          <span class="va">self</span>.__duration <span class="op">=</span> duration</span>
<span id="cb132-29"><a href="#cb132-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-30"><a href="#cb132-30" aria-hidden="true" tabindex="-1"></a>      <span class="kw">def</span> play(<span class="va">self</span>):</span>
<span id="cb132-31"><a href="#cb132-31" aria-hidden="true" tabindex="-1"></a>          <span class="co">"""</span></span>
<span id="cb132-32"><a href="#cb132-32" aria-hidden="true" tabindex="-1"></a><span class="co">          play the note</span></span>
<span id="cb132-33"><a href="#cb132-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-34"><a href="#cb132-34" aria-hidden="true" tabindex="-1"></a><span class="co">          plays the note then pauses for the specified duration</span></span>
<span id="cb132-35"><a href="#cb132-35" aria-hidden="true" tabindex="-1"></a><span class="co">          """</span></span>
<span id="cb132-36"><a href="#cb132-36" aria-hidden="true" tabindex="-1"></a>          snaps.play_note(<span class="va">self</span>.__note)</span>
<span id="cb132-37"><a href="#cb132-37" aria-hidden="true" tabindex="-1"></a>          time.sleep(<span class="va">self</span>.__duration)</span>
<span id="cb132-38"><a href="#cb132-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-39"><a href="#cb132-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-40"><a href="#cb132-40" aria-hidden="true" tabindex="-1"></a>  tune <span class="op">=</span> [</span>
<span id="cb132-41"><a href="#cb132-41" aria-hidden="true" tabindex="-1"></a>      Note(note<span class="op">=</span><span class="dv">0</span>, duration<span class="op">=</span><span class="fl">0.4</span>),</span>
<span id="cb132-42"><a href="#cb132-42" aria-hidden="true" tabindex="-1"></a>      Note(note<span class="op">=</span><span class="dv">0</span>, duration<span class="op">=</span><span class="fl">0.4</span>),</span>
<span id="cb132-43"><a href="#cb132-43" aria-hidden="true" tabindex="-1"></a>      Note(note<span class="op">=</span><span class="dv">7</span>, duration<span class="op">=</span><span class="fl">0.4</span>),</span>
<span id="cb132-44"><a href="#cb132-44" aria-hidden="true" tabindex="-1"></a>      Note(note<span class="op">=</span><span class="dv">7</span>, duration<span class="op">=</span><span class="fl">0.4</span>),</span>
<span id="cb132-45"><a href="#cb132-45" aria-hidden="true" tabindex="-1"></a>      Note(note<span class="op">=</span><span class="dv">9</span>, duration<span class="op">=</span><span class="fl">0.4</span>),</span>
<span id="cb132-46"><a href="#cb132-46" aria-hidden="true" tabindex="-1"></a>      Note(note<span class="op">=</span><span class="dv">9</span>, duration<span class="op">=</span><span class="fl">0.4</span>),</span>
<span id="cb132-47"><a href="#cb132-47" aria-hidden="true" tabindex="-1"></a>      Note(note<span class="op">=</span><span class="dv">7</span>, duration<span class="op">=</span><span class="fl">0.8</span>),</span>
<span id="cb132-48"><a href="#cb132-48" aria-hidden="true" tabindex="-1"></a>      Note(note<span class="op">=</span><span class="dv">5</span>, duration<span class="op">=</span><span class="fl">0.4</span>),</span>
<span id="cb132-49"><a href="#cb132-49" aria-hidden="true" tabindex="-1"></a>      Note(note<span class="op">=</span><span class="dv">5</span>, duration<span class="op">=</span><span class="fl">0.4</span>),</span>
<span id="cb132-50"><a href="#cb132-50" aria-hidden="true" tabindex="-1"></a>      Note(note<span class="op">=</span><span class="dv">4</span>, duration<span class="op">=</span><span class="fl">0.4</span>),</span>
<span id="cb132-51"><a href="#cb132-51" aria-hidden="true" tabindex="-1"></a>      Note(note<span class="op">=</span><span class="dv">4</span>, duration<span class="op">=</span><span class="fl">0.4</span>),</span>
<span id="cb132-52"><a href="#cb132-52" aria-hidden="true" tabindex="-1"></a>      Note(note<span class="op">=</span><span class="dv">2</span>, duration<span class="op">=</span><span class="fl">0.4</span>),</span>
<span id="cb132-53"><a href="#cb132-53" aria-hidden="true" tabindex="-1"></a>      Note(note<span class="op">=</span><span class="dv">2</span>, duration<span class="op">=</span><span class="fl">0.4</span>),</span>
<span id="cb132-54"><a href="#cb132-54" aria-hidden="true" tabindex="-1"></a>      Note(note<span class="op">=</span><span class="dv">0</span>, duration<span class="op">=</span><span class="fl">0.8</span>),</span>
<span id="cb132-55"><a href="#cb132-55" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb132-56"><a href="#cb132-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-57"><a href="#cb132-57" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> note <span class="kw">in</span> tune:</span>
<span id="cb132-58"><a href="#cb132-58" aria-hidden="true" tabindex="-1"></a>      note.play()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p><code>Note</code> is a lightweight class holding the note’s id and the note duration</p>
<ul>
<li>Keep these private, since no need to access once set</li>
</ul></li>
<li><p><code>Note</code> has a <code>play</code> method that captures playing a note</p></li>
<li><p>Program then defines a list of <code>Note</code> objects which are then played</p></li>
</ul>
<section id="code-analysis-the-note-class" class="level4">
<h4 class="anchored" data-anchor-id="code-analysis-the-note-class">Code Analysis: The <code>Note</code> Class</h4>
<p><em>Consider the following questions about the design of the note class</em></p>
<ol type="1">
<li><p><em>Why does the</em> <code>Note</code> <em>class contain a</em> <code>Play</code> <em>method?</em></p>
<ul>
<li>cohesion</li>
<li><code>Note</code> contains all the information about a note</li>
<li>So should keep the behaviour with the information, i.e.&nbsp;in the <code>Note</code> class</li>
<li>If we want to change how a note is played we can change it in the <code>Note</code> class without impacting downstream callers
<ul>
<li>So long as we keep the same API</li>
</ul></li>
</ul></li>
<li><p><em>Could the</em> <code>Note</code> <em>class have a</em> <code>__str__</code> <em>method?</em></p>
<ul>
<li><p>It’s probably a good idea</p></li>
<li><p>A simple implementation is,</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">__str__</span>(<span class="va">self</span>):</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>  template <span class="op">=</span> <span class="st">"Note: </span><span class="sc">{0}</span><span class="st"> Duration: </span><span class="sc">{1}</span><span class="st">"</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> template.<span class="bu">format</span>(<span class="va">self</span>.__note, <span class="va">self</span>.duration)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p>We can then print the tune super easily,</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>  tune_strings <span class="op">=</span> <span class="bu">map</span>(<span class="bu">str</span>, tune)</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(tune_strings))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
</ul></li>
</ol>
<ul>
<li>All the music playing examples can be found in the <a href="./Examples/15_MusicWithSnaps">Music With Snaps</a> example folder</li>
</ul>
</section>
<section id="make-something-happen-make-your-own-music" class="level4">
<h4 class="anchored" data-anchor-id="make-something-happen-make-your-own-music">Make Something Happen: Make Your Own Music</h4>
<p><em>Modify the sample programs to make your own tunes</em></p>
<p>For fun we’ll make two little tunes</p>
<ol type="1">
<li><p>The classic <a href="./Exercises/02_SnapsTunes/MaccasJingle.py">Maccas jingle</a></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb135"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a> <span class="co"># Exercise 10.2.1  Maccas Jingle</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a> <span class="co">#</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a> <span class="co"># Uses the Note playback program to play the Maccas jingle</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a> <span class="im">import</span> time</span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a> <span class="im">import</span> snaps</span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a> <span class="kw">class</span> Note:</span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a>     <span class="co">"""</span></span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a><span class="co">     Musical note with a playback duration.</span></span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a><span class="co">     """</span></span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a>     <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, note, duration):</span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a>         <span class="co">"""</span></span>
<span id="cb135-17"><a href="#cb135-17" aria-hidden="true" tabindex="-1"></a><span class="co">         Create a `Note` instance</span></span>
<span id="cb135-18"><a href="#cb135-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-19"><a href="#cb135-19" aria-hidden="true" tabindex="-1"></a><span class="co">         Parameters</span></span>
<span id="cb135-20"><a href="#cb135-20" aria-hidden="true" tabindex="-1"></a><span class="co">         ----------</span></span>
<span id="cb135-21"><a href="#cb135-21" aria-hidden="true" tabindex="-1"></a><span class="co">         note : int</span></span>
<span id="cb135-22"><a href="#cb135-22" aria-hidden="true" tabindex="-1"></a><span class="co">             id of the note to play</span></span>
<span id="cb135-23"><a href="#cb135-23" aria-hidden="true" tabindex="-1"></a><span class="co">         duration : int | float</span></span>
<span id="cb135-24"><a href="#cb135-24" aria-hidden="true" tabindex="-1"></a><span class="co">             duration of the note</span></span>
<span id="cb135-25"><a href="#cb135-25" aria-hidden="true" tabindex="-1"></a><span class="co">         """</span></span>
<span id="cb135-26"><a href="#cb135-26" aria-hidden="true" tabindex="-1"></a>         <span class="va">self</span>.__note <span class="op">=</span> note</span>
<span id="cb135-27"><a href="#cb135-27" aria-hidden="true" tabindex="-1"></a>         <span class="va">self</span>.__duration <span class="op">=</span> duration</span>
<span id="cb135-28"><a href="#cb135-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-29"><a href="#cb135-29" aria-hidden="true" tabindex="-1"></a>     <span class="kw">def</span> <span class="fu">__str__</span>(<span class="va">self</span>):</span>
<span id="cb135-30"><a href="#cb135-30" aria-hidden="true" tabindex="-1"></a>         template <span class="op">=</span> <span class="st">"Note: </span><span class="sc">{0}</span><span class="st"> Duration: </span><span class="sc">{1}</span><span class="st">"</span></span>
<span id="cb135-31"><a href="#cb135-31" aria-hidden="true" tabindex="-1"></a>         <span class="cf">return</span> template.<span class="bu">format</span>(<span class="va">self</span>.__note, <span class="va">self</span>.__duration)</span>
<span id="cb135-32"><a href="#cb135-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-33"><a href="#cb135-33" aria-hidden="true" tabindex="-1"></a>     <span class="kw">def</span> play(<span class="va">self</span>):</span>
<span id="cb135-34"><a href="#cb135-34" aria-hidden="true" tabindex="-1"></a>         <span class="co">"""</span></span>
<span id="cb135-35"><a href="#cb135-35" aria-hidden="true" tabindex="-1"></a><span class="co">         play the note</span></span>
<span id="cb135-36"><a href="#cb135-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-37"><a href="#cb135-37" aria-hidden="true" tabindex="-1"></a><span class="co">         plays the note then pauses for the specified duration</span></span>
<span id="cb135-38"><a href="#cb135-38" aria-hidden="true" tabindex="-1"></a><span class="co">         """</span></span>
<span id="cb135-39"><a href="#cb135-39" aria-hidden="true" tabindex="-1"></a>         snaps.play_note(<span class="va">self</span>.__note)</span>
<span id="cb135-40"><a href="#cb135-40" aria-hidden="true" tabindex="-1"></a>         time.sleep(<span class="va">self</span>.__duration)</span>
<span id="cb135-41"><a href="#cb135-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-42"><a href="#cb135-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-43"><a href="#cb135-43" aria-hidden="true" tabindex="-1"></a> tune <span class="op">=</span> [</span>
<span id="cb135-44"><a href="#cb135-44" aria-hidden="true" tabindex="-1"></a>     Note(note<span class="op">=</span><span class="dv">7</span>, duration<span class="op">=</span><span class="fl">0.3</span>),</span>
<span id="cb135-45"><a href="#cb135-45" aria-hidden="true" tabindex="-1"></a>     Note(note<span class="op">=</span><span class="dv">11</span>, duration<span class="op">=</span><span class="fl">0.3</span>),</span>
<span id="cb135-46"><a href="#cb135-46" aria-hidden="true" tabindex="-1"></a>     Note(note<span class="op">=</span><span class="dv">2</span>, duration<span class="op">=</span><span class="fl">0.3</span>),</span>
<span id="cb135-47"><a href="#cb135-47" aria-hidden="true" tabindex="-1"></a>     Note(note<span class="op">=</span><span class="dv">5</span>, duration<span class="op">=</span><span class="fl">0.3</span>),</span>
<span id="cb135-48"><a href="#cb135-48" aria-hidden="true" tabindex="-1"></a>     Note(note<span class="op">=</span><span class="dv">7</span>, duration<span class="op">=</span><span class="fl">0.5</span>),</span>
<span id="cb135-49"><a href="#cb135-49" aria-hidden="true" tabindex="-1"></a> ]</span>
<span id="cb135-50"><a href="#cb135-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-51"><a href="#cb135-51" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span> note <span class="kw">in</span> tune:</span>
<span id="cb135-52"><a href="#cb135-52" aria-hidden="true" tabindex="-1"></a>     note.play()</span>
<span id="cb135-53"><a href="#cb135-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-54"><a href="#cb135-54" aria-hidden="true" tabindex="-1"></a> tune_strings <span class="op">=</span> <span class="bu">map</span>(<span class="bu">str</span>, tune)</span>
<span id="cb135-55"><a href="#cb135-55" aria-hidden="true" tabindex="-1"></a> <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(tune_strings))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>This doesn’t sound exactly correct because we don’t have the correct octave progression in the provided wav files but we get a decent approximation</li>
<li>You might like to play around with the timings to see if you can make it better</li>
</ul></li>
<li><p><a href="./Exercises/02_SnapsTunes/ThreeBlindMice.py">Three Blind Mice</a></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a> <span class="co"># Exercise 10.2.2 Three Blind Mice</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a> <span class="co">#</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a> <span class="co"># Uses the Note playback program to play three blind mice</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a> <span class="im">import</span> time</span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a> <span class="im">import</span> snaps</span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a> <span class="kw">class</span> Note:</span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a>     <span class="co">"""</span></span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a><span class="co">     Musical note with a playback duration.</span></span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a><span class="co">     """</span></span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a>     <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, note, duration):</span>
<span id="cb136-16"><a href="#cb136-16" aria-hidden="true" tabindex="-1"></a>         <span class="co">"""</span></span>
<span id="cb136-17"><a href="#cb136-17" aria-hidden="true" tabindex="-1"></a><span class="co">         Create a `Note` instance</span></span>
<span id="cb136-18"><a href="#cb136-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-19"><a href="#cb136-19" aria-hidden="true" tabindex="-1"></a><span class="co">         Parameters</span></span>
<span id="cb136-20"><a href="#cb136-20" aria-hidden="true" tabindex="-1"></a><span class="co">         ----------</span></span>
<span id="cb136-21"><a href="#cb136-21" aria-hidden="true" tabindex="-1"></a><span class="co">         note : int</span></span>
<span id="cb136-22"><a href="#cb136-22" aria-hidden="true" tabindex="-1"></a><span class="co">             id of the note to play</span></span>
<span id="cb136-23"><a href="#cb136-23" aria-hidden="true" tabindex="-1"></a><span class="co">         duration : int | float</span></span>
<span id="cb136-24"><a href="#cb136-24" aria-hidden="true" tabindex="-1"></a><span class="co">             duration of the note</span></span>
<span id="cb136-25"><a href="#cb136-25" aria-hidden="true" tabindex="-1"></a><span class="co">         """</span></span>
<span id="cb136-26"><a href="#cb136-26" aria-hidden="true" tabindex="-1"></a>         <span class="va">self</span>.__note <span class="op">=</span> note</span>
<span id="cb136-27"><a href="#cb136-27" aria-hidden="true" tabindex="-1"></a>         <span class="va">self</span>.__duration <span class="op">=</span> duration</span>
<span id="cb136-28"><a href="#cb136-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-29"><a href="#cb136-29" aria-hidden="true" tabindex="-1"></a>     <span class="kw">def</span> <span class="fu">__str__</span>(<span class="va">self</span>):</span>
<span id="cb136-30"><a href="#cb136-30" aria-hidden="true" tabindex="-1"></a>         template <span class="op">=</span> <span class="st">"Note: </span><span class="sc">{0}</span><span class="st"> Duration: </span><span class="sc">{1}</span><span class="st">"</span></span>
<span id="cb136-31"><a href="#cb136-31" aria-hidden="true" tabindex="-1"></a>         <span class="cf">return</span> template.<span class="bu">format</span>(<span class="va">self</span>.__note, <span class="va">self</span>.__duration)</span>
<span id="cb136-32"><a href="#cb136-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-33"><a href="#cb136-33" aria-hidden="true" tabindex="-1"></a>     <span class="kw">def</span> play(<span class="va">self</span>):</span>
<span id="cb136-34"><a href="#cb136-34" aria-hidden="true" tabindex="-1"></a>         <span class="co">"""</span></span>
<span id="cb136-35"><a href="#cb136-35" aria-hidden="true" tabindex="-1"></a><span class="co">         play the note</span></span>
<span id="cb136-36"><a href="#cb136-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-37"><a href="#cb136-37" aria-hidden="true" tabindex="-1"></a><span class="co">         plays the note then pauses for the specified duration</span></span>
<span id="cb136-38"><a href="#cb136-38" aria-hidden="true" tabindex="-1"></a><span class="co">         """</span></span>
<span id="cb136-39"><a href="#cb136-39" aria-hidden="true" tabindex="-1"></a>         snaps.play_note(<span class="va">self</span>.__note)</span>
<span id="cb136-40"><a href="#cb136-40" aria-hidden="true" tabindex="-1"></a>         time.sleep(<span class="va">self</span>.__duration)</span>
<span id="cb136-41"><a href="#cb136-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-42"><a href="#cb136-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-43"><a href="#cb136-43" aria-hidden="true" tabindex="-1"></a> tune <span class="op">=</span> [</span>
<span id="cb136-44"><a href="#cb136-44" aria-hidden="true" tabindex="-1"></a>     Note(note<span class="op">=</span><span class="dv">4</span>, duration<span class="op">=</span><span class="fl">0.4</span>),</span>
<span id="cb136-45"><a href="#cb136-45" aria-hidden="true" tabindex="-1"></a>     Note(note<span class="op">=</span><span class="dv">2</span>, duration<span class="op">=</span><span class="fl">0.4</span>),</span>
<span id="cb136-46"><a href="#cb136-46" aria-hidden="true" tabindex="-1"></a>     Note(note<span class="op">=</span><span class="dv">0</span>, duration<span class="op">=</span><span class="fl">0.8</span>),</span>
<span id="cb136-47"><a href="#cb136-47" aria-hidden="true" tabindex="-1"></a>     Note(note<span class="op">=</span><span class="dv">4</span>, duration<span class="op">=</span><span class="fl">0.4</span>),</span>
<span id="cb136-48"><a href="#cb136-48" aria-hidden="true" tabindex="-1"></a>     Note(note<span class="op">=</span><span class="dv">2</span>, duration<span class="op">=</span><span class="fl">0.4</span>),</span>
<span id="cb136-49"><a href="#cb136-49" aria-hidden="true" tabindex="-1"></a>     Note(note<span class="op">=</span><span class="dv">0</span>, duration<span class="op">=</span><span class="fl">0.8</span>),</span>
<span id="cb136-50"><a href="#cb136-50" aria-hidden="true" tabindex="-1"></a>     Note(note<span class="op">=</span><span class="dv">7</span>, duration<span class="op">=</span><span class="fl">0.4</span>),</span>
<span id="cb136-51"><a href="#cb136-51" aria-hidden="true" tabindex="-1"></a>     Note(note<span class="op">=</span><span class="dv">5</span>, duration<span class="op">=</span><span class="fl">0.4</span>),</span>
<span id="cb136-52"><a href="#cb136-52" aria-hidden="true" tabindex="-1"></a>     Note(note<span class="op">=</span><span class="dv">5</span>, duration<span class="op">=</span><span class="fl">0.4</span>),</span>
<span id="cb136-53"><a href="#cb136-53" aria-hidden="true" tabindex="-1"></a>     Note(note<span class="op">=</span><span class="dv">4</span>, duration<span class="op">=</span><span class="fl">0.8</span>),</span>
<span id="cb136-54"><a href="#cb136-54" aria-hidden="true" tabindex="-1"></a>     Note(note<span class="op">=</span><span class="dv">7</span>, duration<span class="op">=</span><span class="fl">0.4</span>),</span>
<span id="cb136-55"><a href="#cb136-55" aria-hidden="true" tabindex="-1"></a>     Note(note<span class="op">=</span><span class="dv">5</span>, duration<span class="op">=</span><span class="fl">0.4</span>),</span>
<span id="cb136-56"><a href="#cb136-56" aria-hidden="true" tabindex="-1"></a>     Note(note<span class="op">=</span><span class="dv">5</span>, duration<span class="op">=</span><span class="fl">0.4</span>),</span>
<span id="cb136-57"><a href="#cb136-57" aria-hidden="true" tabindex="-1"></a>     Note(note<span class="op">=</span><span class="dv">4</span>, duration<span class="op">=</span><span class="fl">0.8</span>),</span>
<span id="cb136-58"><a href="#cb136-58" aria-hidden="true" tabindex="-1"></a>     Note(note<span class="op">=</span><span class="dv">7</span>, duration<span class="op">=</span><span class="fl">0.4</span>),</span>
<span id="cb136-59"><a href="#cb136-59" aria-hidden="true" tabindex="-1"></a>     Note(note<span class="op">=</span><span class="dv">12</span>, duration<span class="op">=</span><span class="fl">0.4</span>),</span>
<span id="cb136-60"><a href="#cb136-60" aria-hidden="true" tabindex="-1"></a>     Note(note<span class="op">=</span><span class="dv">12</span>, duration<span class="op">=</span><span class="fl">0.4</span>),</span>
<span id="cb136-61"><a href="#cb136-61" aria-hidden="true" tabindex="-1"></a>     Note(note<span class="op">=</span><span class="dv">11</span>, duration<span class="op">=</span><span class="fl">0.4</span>),</span>
<span id="cb136-62"><a href="#cb136-62" aria-hidden="true" tabindex="-1"></a>     Note(note<span class="op">=</span><span class="dv">9</span>, duration<span class="op">=</span><span class="fl">0.4</span>),</span>
<span id="cb136-63"><a href="#cb136-63" aria-hidden="true" tabindex="-1"></a>     Note(note<span class="op">=</span><span class="dv">11</span>, duration<span class="op">=</span><span class="fl">0.4</span>),</span>
<span id="cb136-64"><a href="#cb136-64" aria-hidden="true" tabindex="-1"></a>     Note(note<span class="op">=</span><span class="dv">12</span>, duration<span class="op">=</span><span class="fl">0.4</span>),</span>
<span id="cb136-65"><a href="#cb136-65" aria-hidden="true" tabindex="-1"></a>     Note(note<span class="op">=</span><span class="dv">7</span>, duration<span class="op">=</span><span class="fl">0.4</span>),</span>
<span id="cb136-66"><a href="#cb136-66" aria-hidden="true" tabindex="-1"></a>     Note(note<span class="op">=</span><span class="dv">7</span>, duration<span class="op">=</span><span class="fl">0.8</span>),</span>
<span id="cb136-67"><a href="#cb136-67" aria-hidden="true" tabindex="-1"></a> ]</span>
<span id="cb136-68"><a href="#cb136-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-69"><a href="#cb136-69" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span> note <span class="kw">in</span> tune:</span>
<span id="cb136-70"><a href="#cb136-70" aria-hidden="true" tabindex="-1"></a>     note.play()</span>
<span id="cb136-71"><a href="#cb136-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-72"><a href="#cb136-72" aria-hidden="true" tabindex="-1"></a> tune_strings <span class="op">=</span> <span class="bu">map</span>(<span class="bu">str</span>, tune)</span>
<span id="cb136-73"><a href="#cb136-73" aria-hidden="true" tabindex="-1"></a> <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(tune_strings))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>This one we get a much better sounding tune</li>
</ul></li>
</ol>
</section>
<section id="exercise-simple-tune-creator" class="level4">
<h4 class="anchored" data-anchor-id="exercise-simple-tune-creator">Exercise: Simple Tune Creator</h4>
<p><em>By combining the structure and style of <a href="#create-a-time-tracker">Time Tracker</a> with the <a href="#make-music-with-snaps">music playback</a> provided by the</em> <code>Note</code> <em>class we could make a simple program that lets users create, edit and play their own tunes. Create this program. A user should be able to create a tune, edit a tune, delete a tune and play a selected tune. Tunes should be saved and persist between uses</em></p>
<p>If you can follow the <a href="#exercise-playlist-storage-app">Playlist Storage App</a> and the <a href="../../02_AdvancedProgramming/09_UsingClasses/Chapter_09_ExtensionExercises.html#make-something-happen-recipe-storage-app">Recipe Storage App</a> then this program should fairly easy to follow</p>
<p>Let’s first define our <code>Note</code> class</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Note:</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Musical note with a playback duration.</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Class Attributes</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------------</span></span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a><span class="co">    min_note_id : int</span></span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a><span class="co">        minimum valid note id</span></span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a><span class="co">    max_note_id : int</span></span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a><span class="co">        maximum valid note id</span></span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a>    min_note_id <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a>    max_note_id <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">@staticmethod</span></span>
<span id="cb137-17"><a href="#cb137-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> valid_note(note):</span>
<span id="cb137-18"><a href="#cb137-18" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb137-19"><a href="#cb137-19" aria-hidden="true" tabindex="-1"></a><span class="co">        Checks if a note id is valid</span></span>
<span id="cb137-20"><a href="#cb137-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-21"><a href="#cb137-21" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters</span></span>
<span id="cb137-22"><a href="#cb137-22" aria-hidden="true" tabindex="-1"></a><span class="co">        ----------</span></span>
<span id="cb137-23"><a href="#cb137-23" aria-hidden="true" tabindex="-1"></a><span class="co">        note : int</span></span>
<span id="cb137-24"><a href="#cb137-24" aria-hidden="true" tabindex="-1"></a><span class="co">            id of the note to validate</span></span>
<span id="cb137-25"><a href="#cb137-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-26"><a href="#cb137-26" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns</span></span>
<span id="cb137-27"><a href="#cb137-27" aria-hidden="true" tabindex="-1"></a><span class="co">        -------</span></span>
<span id="cb137-28"><a href="#cb137-28" aria-hidden="true" tabindex="-1"></a><span class="co">        bool</span></span>
<span id="cb137-29"><a href="#cb137-29" aria-hidden="true" tabindex="-1"></a><span class="co">            `True` if note is valid, else `False`</span></span>
<span id="cb137-30"><a href="#cb137-30" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb137-31"><a href="#cb137-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> note <span class="op">&lt;</span> <span class="dv">0</span> <span class="kw">or</span> note <span class="op">&gt;</span> <span class="dv">12</span>:</span>
<span id="cb137-32"><a href="#cb137-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb137-33"><a href="#cb137-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb137-34"><a href="#cb137-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-35"><a href="#cb137-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, note, duration):</span>
<span id="cb137-36"><a href="#cb137-36" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb137-37"><a href="#cb137-37" aria-hidden="true" tabindex="-1"></a><span class="co">        Create a Note instance</span></span>
<span id="cb137-38"><a href="#cb137-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-39"><a href="#cb137-39" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters</span></span>
<span id="cb137-40"><a href="#cb137-40" aria-hidden="true" tabindex="-1"></a><span class="co">        ----------</span></span>
<span id="cb137-41"><a href="#cb137-41" aria-hidden="true" tabindex="-1"></a><span class="co">        note : int</span></span>
<span id="cb137-42"><a href="#cb137-42" aria-hidden="true" tabindex="-1"></a><span class="co">            id of the note to play</span></span>
<span id="cb137-43"><a href="#cb137-43" aria-hidden="true" tabindex="-1"></a><span class="co">        duration : int | float</span></span>
<span id="cb137-44"><a href="#cb137-44" aria-hidden="true" tabindex="-1"></a><span class="co">            duration of the note</span></span>
<span id="cb137-45"><a href="#cb137-45" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb137-46"><a href="#cb137-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> Note.valid_note(note):</span>
<span id="cb137-47"><a href="#cb137-47" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(</span>
<span id="cb137-48"><a href="#cb137-48" aria-hidden="true" tabindex="-1"></a>                <span class="st">"invalid note </span><span class="sc">{0}</span><span class="st"> passed. note must be between </span><span class="sc">{1}</span><span class="st"> and </span><span class="sc">{2}</span><span class="st">"</span>.<span class="bu">format</span>(</span>
<span id="cb137-49"><a href="#cb137-49" aria-hidden="true" tabindex="-1"></a>                    note, Note.min_note_id, Note.max_note_id</span>
<span id="cb137-50"><a href="#cb137-50" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb137-51"><a href="#cb137-51" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb137-52"><a href="#cb137-52" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__note <span class="op">=</span> note</span>
<span id="cb137-53"><a href="#cb137-53" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__duration <span class="op">=</span> duration</span>
<span id="cb137-54"><a href="#cb137-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-55"><a href="#cb137-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb137-56"><a href="#cb137-56" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> duration(<span class="va">self</span>):</span>
<span id="cb137-57"><a href="#cb137-57" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb137-58"><a href="#cb137-58" aria-hidden="true" tabindex="-1"></a><span class="co">        duration : str</span></span>
<span id="cb137-59"><a href="#cb137-59" aria-hidden="true" tabindex="-1"></a><span class="co">            time in seconds the note is played for</span></span>
<span id="cb137-60"><a href="#cb137-60" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb137-61"><a href="#cb137-61" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.__duration</span>
<span id="cb137-62"><a href="#cb137-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-63"><a href="#cb137-63" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__str__</span>(<span class="va">self</span>):</span>
<span id="cb137-64"><a href="#cb137-64" aria-hidden="true" tabindex="-1"></a>        template <span class="op">=</span> <span class="st">"Note: </span><span class="sc">{0}</span><span class="st"> Duration: </span><span class="sc">{1}</span><span class="st">"</span></span>
<span id="cb137-65"><a href="#cb137-65" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> template.<span class="bu">format</span>(<span class="va">self</span>.__note, <span class="va">self</span>.__duration)</span>
<span id="cb137-66"><a href="#cb137-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-67"><a href="#cb137-67" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> play(<span class="va">self</span>):</span>
<span id="cb137-68"><a href="#cb137-68" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb137-69"><a href="#cb137-69" aria-hidden="true" tabindex="-1"></a><span class="co">        play the note</span></span>
<span id="cb137-70"><a href="#cb137-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-71"><a href="#cb137-71" aria-hidden="true" tabindex="-1"></a><span class="co">        plays the note then pauses for the specified duration</span></span>
<span id="cb137-72"><a href="#cb137-72" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb137-73"><a href="#cb137-73" aria-hidden="true" tabindex="-1"></a>        snaps.play_note(<span class="va">self</span>.__note)</span>
<span id="cb137-74"><a href="#cb137-74" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="va">self</span>.__duration)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This is pretty much the same as the <code>Note</code> class in the <a href="#make-music-with-snaps">Making Music Section</a>. However we need the duration so that we can report how long the total tune is so we add a read only property for duration. Additionally since we’re now going to be taking user input to create notes we’ll want to validate that input. It makes sense for it to be in the <code>Note</code> class, so we define class variables <code>min_note_id</code> and <code>max_note_id</code> and a corresponding validation method, <code>valid_note</code> that can be used to check that a note (represented by an integer) is valid. We leave the class variables as public so we can use them in the prompts we display to the user</p>
<p>Now when making <a href="#make-something-happen-make-your-own-music">our own music</a>, we used a list of notes to create a tune. We want to use this structure but wrap it in a class that captures behaviour. We’ll call this class <code>Tune</code></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Tune:</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Represents a tune consisting of a sequence of notes of a specified duration</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Attributes</span></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a><span class="co">    name : str</span></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a><span class="co">        name of the tune</span></span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name):</span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb138-13"><a href="#cb138-13" aria-hidden="true" tabindex="-1"></a><span class="co">        Create a new `Tune` instance</span></span>
<span id="cb138-14"><a href="#cb138-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-15"><a href="#cb138-15" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters</span></span>
<span id="cb138-16"><a href="#cb138-16" aria-hidden="true" tabindex="-1"></a><span class="co">        ----------</span></span>
<span id="cb138-17"><a href="#cb138-17" aria-hidden="true" tabindex="-1"></a><span class="co">        name : str</span></span>
<span id="cb138-18"><a href="#cb138-18" aria-hidden="true" tabindex="-1"></a><span class="co">            name of the tune</span></span>
<span id="cb138-19"><a href="#cb138-19" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb138-20"><a href="#cb138-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.name <span class="op">=</span> name</span>
<span id="cb138-21"><a href="#cb138-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__notes <span class="op">=</span> []</span>
<span id="cb138-22"><a href="#cb138-22" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__length <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb138-23"><a href="#cb138-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-24"><a href="#cb138-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__str__</span>(<span class="va">self</span>):</span>
<span id="cb138-25"><a href="#cb138-25" aria-hidden="true" tabindex="-1"></a>        notes_string <span class="op">=</span> <span class="st">""</span></span>
<span id="cb138-26"><a href="#cb138-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> idx, note <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">map</span>(<span class="bu">str</span>, <span class="va">self</span>.__notes)):</span>
<span id="cb138-27"><a href="#cb138-27" aria-hidden="true" tabindex="-1"></a>            notes_string <span class="op">=</span> notes_string <span class="op">+</span> <span class="bu">str</span>(idx) <span class="op">+</span> <span class="st">": "</span> <span class="op">+</span> note <span class="op">+</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb138-28"><a href="#cb138-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-29"><a href="#cb138-29" aria-hidden="true" tabindex="-1"></a>        template <span class="op">=</span> <span class="st">"""name: </span><span class="sc">{0}</span></span>
<span id="cb138-30"><a href="#cb138-30" aria-hidden="true" tabindex="-1"></a><span class="st">duration: </span><span class="sc">{1}</span></span>
<span id="cb138-31"><a href="#cb138-31" aria-hidden="true" tabindex="-1"></a><span class="st">notes:</span></span>
<span id="cb138-32"><a href="#cb138-32" aria-hidden="true" tabindex="-1"></a><span class="sc">{2}</span></span>
<span id="cb138-33"><a href="#cb138-33" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb138-34"><a href="#cb138-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> template.<span class="bu">format</span>(<span class="va">self</span>.name, <span class="va">self</span>.__length, notes_string)</span>
<span id="cb138-35"><a href="#cb138-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-36"><a href="#cb138-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb138-37"><a href="#cb138-37" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> length(<span class="va">self</span>):</span>
<span id="cb138-38"><a href="#cb138-38" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb138-39"><a href="#cb138-39" aria-hidden="true" tabindex="-1"></a><span class="co">        length : int | float</span></span>
<span id="cb138-40"><a href="#cb138-40" aria-hidden="true" tabindex="-1"></a><span class="co">            total length of the tune in seconds</span></span>
<span id="cb138-41"><a href="#cb138-41" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb138-42"><a href="#cb138-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.__length</span>
<span id="cb138-43"><a href="#cb138-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-44"><a href="#cb138-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb138-45"><a href="#cb138-45" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> number_of_notes(<span class="va">self</span>):</span>
<span id="cb138-46"><a href="#cb138-46" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb138-47"><a href="#cb138-47" aria-hidden="true" tabindex="-1"></a><span class="co">        number_of_notes : int</span></span>
<span id="cb138-48"><a href="#cb138-48" aria-hidden="true" tabindex="-1"></a><span class="co">            number of notes in the tune</span></span>
<span id="cb138-49"><a href="#cb138-49" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb138-50"><a href="#cb138-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">len</span>(<span class="va">self</span>.__notes)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>The class has a simple structure. The tune constructor only needs a name, we then create an empty list of notes, and a separate variable that tracks the full length of the tune. Our string representation (<code>__str__</code>) follows the usual pattern, we print the name and duration of the <code>Tune</code>, the the list of <code>Note</code> objects in the tune. We use <code>enumerate</code> to make this a numbered list with each item on its own line. This is because most of our edits will require an index, so we want to user to be able to easily see the index of all the notes. Additionally we define two useful properties, one to get the length of the tune, and the second that returns the total number of notes in the tune. Both properties are read-only, while this last one is mostly used to help with validating user input</p>
<p>As you can see the list of notes is private, so we also want to provide some methods that allow us to modify the notes list</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb139"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_note(<span class="va">self</span>, note, index<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="co">        Add a new note to the tune</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a><span class="co">        Adds a new note to the tune, if the index is specified</span></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a><span class="co">        the note is inserted at that index, else the note is appended</span></span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters</span></span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a><span class="co">        ----------</span></span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a><span class="co">        note : Note</span></span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a><span class="co">            note to add to the tune</span></span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a><span class="co">        index : int | None, optional</span></span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a><span class="co">            index to insert the note at, if `None`, the Note is appended,</span></span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a><span class="co">            by default `None`</span></span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns</span></span>
<span id="cb139-17"><a href="#cb139-17" aria-hidden="true" tabindex="-1"></a><span class="co">        -------</span></span>
<span id="cb139-18"><a href="#cb139-18" aria-hidden="true" tabindex="-1"></a><span class="co">        None</span></span>
<span id="cb139-19"><a href="#cb139-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-20"><a href="#cb139-20" aria-hidden="true" tabindex="-1"></a><span class="co">        See Also</span></span>
<span id="cb139-21"><a href="#cb139-21" aria-hidden="true" tabindex="-1"></a><span class="co">        --------</span></span>
<span id="cb139-22"><a href="#cb139-22" aria-hidden="true" tabindex="-1"></a><span class="co">        Tune.remove_note : remove a note at a given index from a `Tune` instance</span></span>
<span id="cb139-23"><a href="#cb139-23" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb139-24"><a href="#cb139-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> index <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb139-25"><a href="#cb139-25" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.__notes.insert(index, note)</span>
<span id="cb139-26"><a href="#cb139-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb139-27"><a href="#cb139-27" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.__notes.append(note)</span>
<span id="cb139-28"><a href="#cb139-28" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__length <span class="op">+=</span> note.duration</span>
<span id="cb139-29"><a href="#cb139-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-30"><a href="#cb139-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> remove_note(<span class="va">self</span>, index):</span>
<span id="cb139-31"><a href="#cb139-31" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb139-32"><a href="#cb139-32" aria-hidden="true" tabindex="-1"></a><span class="co">        Remove a note from the tune</span></span>
<span id="cb139-33"><a href="#cb139-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-34"><a href="#cb139-34" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters</span></span>
<span id="cb139-35"><a href="#cb139-35" aria-hidden="true" tabindex="-1"></a><span class="co">        ----------</span></span>
<span id="cb139-36"><a href="#cb139-36" aria-hidden="true" tabindex="-1"></a><span class="co">        index : int</span></span>
<span id="cb139-37"><a href="#cb139-37" aria-hidden="true" tabindex="-1"></a><span class="co">            index of the note to remove</span></span>
<span id="cb139-38"><a href="#cb139-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-39"><a href="#cb139-39" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns</span></span>
<span id="cb139-40"><a href="#cb139-40" aria-hidden="true" tabindex="-1"></a><span class="co">        -------</span></span>
<span id="cb139-41"><a href="#cb139-41" aria-hidden="true" tabindex="-1"></a><span class="co">        Note</span></span>
<span id="cb139-42"><a href="#cb139-42" aria-hidden="true" tabindex="-1"></a><span class="co">            the removed Note</span></span>
<span id="cb139-43"><a href="#cb139-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-44"><a href="#cb139-44" aria-hidden="true" tabindex="-1"></a><span class="co">        See Also</span></span>
<span id="cb139-45"><a href="#cb139-45" aria-hidden="true" tabindex="-1"></a><span class="co">        --------</span></span>
<span id="cb139-46"><a href="#cb139-46" aria-hidden="true" tabindex="-1"></a><span class="co">        Tune.add_note : insert or append a new note to a `Tune` instance</span></span>
<span id="cb139-47"><a href="#cb139-47" aria-hidden="true" tabindex="-1"></a><span class="co">        Tune.clear_tune : remove all notes in a `Tune` instance</span></span>
<span id="cb139-48"><a href="#cb139-48" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb139-49"><a href="#cb139-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb139-50"><a href="#cb139-50" aria-hidden="true" tabindex="-1"></a>            note <span class="op">=</span> <span class="va">self</span>.__notes.pop(index)</span>
<span id="cb139-51"><a href="#cb139-51" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.__length <span class="op">-=</span> note.duration</span>
<span id="cb139-52"><a href="#cb139-52" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> note</span>
<span id="cb139-53"><a href="#cb139-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">IndexError</span>:</span>
<span id="cb139-54"><a href="#cb139-54" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Failed to remove the </span><span class="sc">{0}</span><span class="st">-th note"</span>.<span class="bu">format</span>(index <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb139-55"><a href="#cb139-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-56"><a href="#cb139-56" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> clear_tune(<span class="va">self</span>):</span>
<span id="cb139-57"><a href="#cb139-57" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb139-58"><a href="#cb139-58" aria-hidden="true" tabindex="-1"></a><span class="co">        Clear all notes from the tune</span></span>
<span id="cb139-59"><a href="#cb139-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-60"><a href="#cb139-60" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns</span></span>
<span id="cb139-61"><a href="#cb139-61" aria-hidden="true" tabindex="-1"></a><span class="co">        -------</span></span>
<span id="cb139-62"><a href="#cb139-62" aria-hidden="true" tabindex="-1"></a><span class="co">        None</span></span>
<span id="cb139-63"><a href="#cb139-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-64"><a href="#cb139-64" aria-hidden="true" tabindex="-1"></a><span class="co">        See Also</span></span>
<span id="cb139-65"><a href="#cb139-65" aria-hidden="true" tabindex="-1"></a><span class="co">        --------</span></span>
<span id="cb139-66"><a href="#cb139-66" aria-hidden="true" tabindex="-1"></a><span class="co">        Tune.remove_note : remove a note at a given index from a `Tune`</span></span>
<span id="cb139-67"><a href="#cb139-67" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb139-68"><a href="#cb139-68" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__notes.clear()</span>
<span id="cb139-69"><a href="#cb139-69" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__length <span class="op">=</span> <span class="dv">0</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>The first <code>add_note</code> takes a note, and an optional index. If the index is specified the note is inserted into the list (at the specified index), otherwise we append it. The second <code>remove_note</code> <em>requires</em> an index, and removes the note at that index. The removed note is returned as part of this process. We also provide some error handling in case the provided index does not actually exist. Last we provide a <code>clear_tune</code> method which simply removes all the notes</p>
<p>The arguably most important function for the <code>Tune</code> class however is <code>play</code> which simply plays the tune</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> play(<span class="va">self</span>):</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a><span class="co">        Plays the tune</span></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns</span></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a><span class="co">        -------</span></span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a><span class="co">        None</span></span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> note <span class="kw">in</span> <span class="va">self</span>.__notes:</span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a>            note.play()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>We define our main menu function as,</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb141"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_main_menu():</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>    first_option_id <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>    last_option_id <span class="op">=</span> <span class="dv">7</span></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>    main_menu_template <span class="op">=</span> <span class="st">"""Tune Editor</span></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a><span class="st">Current Tune: </span><span class="sc">{0}</span></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a><span class="st">1. New Tune</span></span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a><span class="st">2. List Tunes</span></span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a><span class="st">3. Select Tune</span></span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a><span class="st">4. Play Tune</span></span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a><span class="st">5. Edit Tune</span></span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a><span class="st">6. Delete Tune</span></span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a><span class="st">7. Exit program</span></span>
<span id="cb141-15"><a href="#cb141-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-16"><a href="#cb141-16" aria-hidden="true" tabindex="-1"></a><span class="st">Enter your command: """</span></span>
<span id="cb141-17"><a href="#cb141-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-18"><a href="#cb141-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb141-19"><a href="#cb141-19" aria-hidden="true" tabindex="-1"></a>        command <span class="op">=</span> BTCInput.read_int_ranged(</span>
<span id="cb141-20"><a href="#cb141-20" aria-hidden="true" tabindex="-1"></a>            main_menu_template.<span class="bu">format</span>(current_tune.name),</span>
<span id="cb141-21"><a href="#cb141-21" aria-hidden="true" tabindex="-1"></a>            min_value<span class="op">=</span>first_option_id,</span>
<span id="cb141-22"><a href="#cb141-22" aria-hidden="true" tabindex="-1"></a>            max_value<span class="op">=</span>last_option_id,</span>
<span id="cb141-23"><a href="#cb141-23" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb141-24"><a href="#cb141-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> command <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb141-25"><a href="#cb141-25" aria-hidden="true" tabindex="-1"></a>            new_tune()</span>
<span id="cb141-26"><a href="#cb141-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> command <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb141-27"><a href="#cb141-27" aria-hidden="true" tabindex="-1"></a>            list_tunes()</span>
<span id="cb141-28"><a href="#cb141-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> command <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb141-29"><a href="#cb141-29" aria-hidden="true" tabindex="-1"></a>            select_tune()</span>
<span id="cb141-30"><a href="#cb141-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> command <span class="op">==</span> <span class="dv">7</span>:</span>
<span id="cb141-31"><a href="#cb141-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb141-32"><a href="#cb141-32" aria-hidden="true" tabindex="-1"></a>                save_tunes(tune_file_name)</span>
<span id="cb141-33"><a href="#cb141-33" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span>:  <span class="co"># noqa: E722</span></span>
<span id="cb141-34"><a href="#cb141-34" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">"Failed to save tunes"</span>)</span>
<span id="cb141-35"><a href="#cb141-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb141-36"><a href="#cb141-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> current_tune.name <span class="op">==</span> <span class="st">"None"</span>:</span>
<span id="cb141-37"><a href="#cb141-37" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"No tune currently selected"</span>)</span>
<span id="cb141-38"><a href="#cb141-38" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb141-39"><a href="#cb141-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> command <span class="op">==</span> <span class="dv">4</span>:</span>
<span id="cb141-40"><a href="#cb141-40" aria-hidden="true" tabindex="-1"></a>            current_tune.play()</span>
<span id="cb141-41"><a href="#cb141-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> command <span class="op">==</span> <span class="dv">5</span>:</span>
<span id="cb141-42"><a href="#cb141-42" aria-hidden="true" tabindex="-1"></a>            run_edit_menu()</span>
<span id="cb141-43"><a href="#cb141-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> command <span class="op">==</span> <span class="dv">6</span>:</span>
<span id="cb141-44"><a href="#cb141-44" aria-hidden="true" tabindex="-1"></a>            delete_tune()</span>
<span id="cb141-45"><a href="#cb141-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb141-46"><a href="#cb141-46" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(</span>
<span id="cb141-47"><a href="#cb141-47" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Unexpected command id: </span><span class="sc">{0}</span><span class="st"> found in Main Menu"</span>.<span class="bu">format</span>(command)</span>
<span id="cb141-48"><a href="#cb141-48" aria-hidden="true" tabindex="-1"></a>            )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>We use the same <code>save</code> and <code>load</code> paradigm as with all the previous examples so we won’t look at that code again. Of the functions here we have,</p>
<ol type="1">
<li><p><code>new_tune</code></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a> <span class="kw">def</span> valid_tune_name(name):</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>     <span class="co">"""</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="co">     Verifies that a tune name is available</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a><span class="co">     Tune names must be unique</span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a><span class="co">     Parameters</span></span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a><span class="co">     ----------</span></span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a><span class="co">     name : str</span></span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a><span class="co">         proposed name for a tune</span></span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a><span class="co">     Returns</span></span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a><span class="co">     -------</span></span>
<span id="cb142-14"><a href="#cb142-14" aria-hidden="true" tabindex="-1"></a><span class="co">     bool</span></span>
<span id="cb142-15"><a href="#cb142-15" aria-hidden="true" tabindex="-1"></a><span class="co">         `True` if tune name is valid else, `False`</span></span>
<span id="cb142-16"><a href="#cb142-16" aria-hidden="true" tabindex="-1"></a><span class="co">     """</span></span>
<span id="cb142-17"><a href="#cb142-17" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> name <span class="op">==</span> <span class="st">"None"</span>:</span>
<span id="cb142-18"><a href="#cb142-18" aria-hidden="true" tabindex="-1"></a>         <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb142-19"><a href="#cb142-19" aria-hidden="true" tabindex="-1"></a>     <span class="cf">for</span> tune <span class="kw">in</span> tunes:</span>
<span id="cb142-20"><a href="#cb142-20" aria-hidden="true" tabindex="-1"></a>         <span class="cf">if</span> name <span class="op">==</span> tune.name:</span>
<span id="cb142-21"><a href="#cb142-21" aria-hidden="true" tabindex="-1"></a>             <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb142-22"><a href="#cb142-22" aria-hidden="true" tabindex="-1"></a>     <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb142-23"><a href="#cb142-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-24"><a href="#cb142-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-25"><a href="#cb142-25" aria-hidden="true" tabindex="-1"></a> <span class="kw">def</span> prompt_valid_name(prompt):</span>
<span id="cb142-26"><a href="#cb142-26" aria-hidden="true" tabindex="-1"></a>     <span class="co">"""</span></span>
<span id="cb142-27"><a href="#cb142-27" aria-hidden="true" tabindex="-1"></a><span class="co">     Prompts the user for a valid tune name</span></span>
<span id="cb142-28"><a href="#cb142-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-29"><a href="#cb142-29" aria-hidden="true" tabindex="-1"></a><span class="co">     Loops until a valid name is provided</span></span>
<span id="cb142-30"><a href="#cb142-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-31"><a href="#cb142-31" aria-hidden="true" tabindex="-1"></a><span class="co">     Parameters</span></span>
<span id="cb142-32"><a href="#cb142-32" aria-hidden="true" tabindex="-1"></a><span class="co">     ----------</span></span>
<span id="cb142-33"><a href="#cb142-33" aria-hidden="true" tabindex="-1"></a><span class="co">     prompt : str</span></span>
<span id="cb142-34"><a href="#cb142-34" aria-hidden="true" tabindex="-1"></a><span class="co">         prompt to display to the user</span></span>
<span id="cb142-35"><a href="#cb142-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-36"><a href="#cb142-36" aria-hidden="true" tabindex="-1"></a><span class="co">     Returns</span></span>
<span id="cb142-37"><a href="#cb142-37" aria-hidden="true" tabindex="-1"></a><span class="co">     -------</span></span>
<span id="cb142-38"><a href="#cb142-38" aria-hidden="true" tabindex="-1"></a><span class="co">     str</span></span>
<span id="cb142-39"><a href="#cb142-39" aria-hidden="true" tabindex="-1"></a><span class="co">         string containing a valid tune name</span></span>
<span id="cb142-40"><a href="#cb142-40" aria-hidden="true" tabindex="-1"></a><span class="co">     """</span></span>
<span id="cb142-41"><a href="#cb142-41" aria-hidden="true" tabindex="-1"></a>     tune_name <span class="op">=</span> BTCInput.read_text(prompt)</span>
<span id="cb142-42"><a href="#cb142-42" aria-hidden="true" tabindex="-1"></a>     <span class="cf">while</span> <span class="kw">not</span> valid_tune_name(tune_name):</span>
<span id="cb142-43"><a href="#cb142-43" aria-hidden="true" tabindex="-1"></a>         <span class="bu">print</span>(<span class="st">"That tune name is already in use"</span>)</span>
<span id="cb142-44"><a href="#cb142-44" aria-hidden="true" tabindex="-1"></a>         tune_name <span class="op">=</span> BTCInput.read_text(prompt)</span>
<span id="cb142-45"><a href="#cb142-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-46"><a href="#cb142-46" aria-hidden="true" tabindex="-1"></a>     <span class="cf">return</span> tune_name</span>
<span id="cb142-47"><a href="#cb142-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-48"><a href="#cb142-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-49"><a href="#cb142-49" aria-hidden="true" tabindex="-1"></a> <span class="kw">def</span> new_tune():</span>
<span id="cb142-50"><a href="#cb142-50" aria-hidden="true" tabindex="-1"></a>     <span class="co">"""</span></span>
<span id="cb142-51"><a href="#cb142-51" aria-hidden="true" tabindex="-1"></a><span class="co">     Create a new tune and make it the active tune</span></span>
<span id="cb142-52"><a href="#cb142-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-53"><a href="#cb142-53" aria-hidden="true" tabindex="-1"></a><span class="co">     Prompts the user for a new name for the tune, and ensures its valid</span></span>
<span id="cb142-54"><a href="#cb142-54" aria-hidden="true" tabindex="-1"></a><span class="co">     then constructs a Tune and sets it as the current active tune</span></span>
<span id="cb142-55"><a href="#cb142-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-56"><a href="#cb142-56" aria-hidden="true" tabindex="-1"></a><span class="co">     Returns</span></span>
<span id="cb142-57"><a href="#cb142-57" aria-hidden="true" tabindex="-1"></a><span class="co">     -------</span></span>
<span id="cb142-58"><a href="#cb142-58" aria-hidden="true" tabindex="-1"></a><span class="co">     None</span></span>
<span id="cb142-59"><a href="#cb142-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-60"><a href="#cb142-60" aria-hidden="true" tabindex="-1"></a><span class="co">     See Also</span></span>
<span id="cb142-61"><a href="#cb142-61" aria-hidden="true" tabindex="-1"></a><span class="co">     --------</span></span>
<span id="cb142-62"><a href="#cb142-62" aria-hidden="true" tabindex="-1"></a><span class="co">     valid_tune_name : validates a tune name</span></span>
<span id="cb142-63"><a href="#cb142-63" aria-hidden="true" tabindex="-1"></a><span class="co">     Tune : class used to represent a tune</span></span>
<span id="cb142-64"><a href="#cb142-64" aria-hidden="true" tabindex="-1"></a><span class="co">     """</span></span>
<span id="cb142-65"><a href="#cb142-65" aria-hidden="true" tabindex="-1"></a>     <span class="bu">print</span>(<span class="st">"New tune"</span>)</span>
<span id="cb142-66"><a href="#cb142-66" aria-hidden="true" tabindex="-1"></a>     <span class="kw">global</span> current_tune</span>
<span id="cb142-67"><a href="#cb142-67" aria-hidden="true" tabindex="-1"></a>     new_tune_name <span class="op">=</span> prompt_valid_name(<span class="st">"Enter the tune name: "</span>)</span>
<span id="cb142-68"><a href="#cb142-68" aria-hidden="true" tabindex="-1"></a>     new_tune <span class="op">=</span> Tune(new_tune_name)</span>
<span id="cb142-69"><a href="#cb142-69" aria-hidden="true" tabindex="-1"></a>     current_tune <span class="op">=</span> new_tune</span>
<span id="cb142-70"><a href="#cb142-70" aria-hidden="true" tabindex="-1"></a>     tunes.append(new_tune)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>We start by defining a function <code>valid_tune_name</code>
<ul>
<li>boolean function that ensures a proposed name is unique</li>
<li>returns <code>True</code> if the name is valid, else <code>False</code></li>
</ul></li>
<li>We then wrap this in <code>prompt_valid_name</code>
<ul>
<li>Since we want to reuse the code that gets a name from a user later</li>
<li>Prompts the user for a valid name, looping until one is received</li>
<li>Returns the valid name</li>
</ul></li>
<li>Our <code>new_tune</code> is now simple
<ul>
<li>call <code>prompt_valid_name</code> to get a new name</li>
<li>Create a new <code>Tune</code> object</li>
<li>set the current tune to this new object</li>
<li>Add it to the tunes list</li>
</ul></li>
</ul></li>
<li><p><code>list_tunes</code></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb143"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a> <span class="kw">def</span> filter_tunes_by_name(search_name):</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>     <span class="co">"""</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="co">     Finds tunes matching a search name</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a><span class="co">     Tunes are matched if their name is prefixed by the search name</span></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a><span class="co">     after normalisation (striping whitespace and lowercasing)</span></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a><span class="co">     Parameters</span></span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a><span class="co">     ----------</span></span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a><span class="co">     search_name : str</span></span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a><span class="co">         name to search for (search uses prefix matching)</span></span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a><span class="co">     Returns</span></span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a><span class="co">     -------</span></span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a><span class="co">     list[Tune]</span></span>
<span id="cb143-16"><a href="#cb143-16" aria-hidden="true" tabindex="-1"></a><span class="co">         list of tunes matching the name. If no matches</span></span>
<span id="cb143-17"><a href="#cb143-17" aria-hidden="true" tabindex="-1"></a><span class="co">         exist the list is empty</span></span>
<span id="cb143-18"><a href="#cb143-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-19"><a href="#cb143-19" aria-hidden="true" tabindex="-1"></a><span class="co">     """</span></span>
<span id="cb143-20"><a href="#cb143-20" aria-hidden="true" tabindex="-1"></a>     search_name <span class="op">=</span> search_name.strip().lower()</span>
<span id="cb143-21"><a href="#cb143-21" aria-hidden="true" tabindex="-1"></a>     <span class="bu">print</span>(search_name)</span>
<span id="cb143-22"><a href="#cb143-22" aria-hidden="true" tabindex="-1"></a>     matched_tunes <span class="op">=</span> []</span>
<span id="cb143-23"><a href="#cb143-23" aria-hidden="true" tabindex="-1"></a>     <span class="cf">for</span> tune <span class="kw">in</span> tunes:</span>
<span id="cb143-24"><a href="#cb143-24" aria-hidden="true" tabindex="-1"></a>         tune_name <span class="op">=</span> tune.name.strip().lower()</span>
<span id="cb143-25"><a href="#cb143-25" aria-hidden="true" tabindex="-1"></a>         <span class="cf">if</span> tune_name.startswith(search_name):</span>
<span id="cb143-26"><a href="#cb143-26" aria-hidden="true" tabindex="-1"></a>             matched_tunes.append(tune)</span>
<span id="cb143-27"><a href="#cb143-27" aria-hidden="true" tabindex="-1"></a>     <span class="cf">return</span> matched_tunes</span>
<span id="cb143-28"><a href="#cb143-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-29"><a href="#cb143-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-30"><a href="#cb143-30" aria-hidden="true" tabindex="-1"></a> <span class="kw">def</span> list_tunes():</span>
<span id="cb143-31"><a href="#cb143-31" aria-hidden="true" tabindex="-1"></a>     <span class="co">"""</span></span>
<span id="cb143-32"><a href="#cb143-32" aria-hidden="true" tabindex="-1"></a><span class="co">     List all tunes matching a user-specified search string</span></span>
<span id="cb143-33"><a href="#cb143-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-34"><a href="#cb143-34" aria-hidden="true" tabindex="-1"></a><span class="co">     Returns</span></span>
<span id="cb143-35"><a href="#cb143-35" aria-hidden="true" tabindex="-1"></a><span class="co">     -------</span></span>
<span id="cb143-36"><a href="#cb143-36" aria-hidden="true" tabindex="-1"></a><span class="co">     None</span></span>
<span id="cb143-37"><a href="#cb143-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-38"><a href="#cb143-38" aria-hidden="true" tabindex="-1"></a><span class="co">     See Also</span></span>
<span id="cb143-39"><a href="#cb143-39" aria-hidden="true" tabindex="-1"></a><span class="co">     --------</span></span>
<span id="cb143-40"><a href="#cb143-40" aria-hidden="true" tabindex="-1"></a><span class="co">     filter_tunes_by_name : handles searching for tunes by name</span></span>
<span id="cb143-41"><a href="#cb143-41" aria-hidden="true" tabindex="-1"></a><span class="co">     """</span></span>
<span id="cb143-42"><a href="#cb143-42" aria-hidden="true" tabindex="-1"></a>     <span class="bu">print</span>(<span class="st">"List tunes"</span>)</span>
<span id="cb143-43"><a href="#cb143-43" aria-hidden="true" tabindex="-1"></a>     search_name <span class="op">=</span> BTCInput.read_text(<span class="st">"Tune names to search (press enter for all): "</span>)</span>
<span id="cb143-44"><a href="#cb143-44" aria-hidden="true" tabindex="-1"></a>     matched_tunes <span class="op">=</span> filter_tunes_by_name(search_name)</span>
<span id="cb143-45"><a href="#cb143-45" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> <span class="bu">len</span>(matched_tunes) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb143-46"><a href="#cb143-46" aria-hidden="true" tabindex="-1"></a>         <span class="bu">print</span>(<span class="st">"No matches found"</span>)</span>
<span id="cb143-47"><a href="#cb143-47" aria-hidden="true" tabindex="-1"></a>         <span class="cf">return</span></span>
<span id="cb143-48"><a href="#cb143-48" aria-hidden="true" tabindex="-1"></a>     <span class="bu">print</span>(<span class="st">"Found </span><span class="sc">{0}</span><span class="st"> matches"</span>.<span class="bu">format</span>(<span class="bu">len</span>(matched_tunes)))</span>
<span id="cb143-49"><a href="#cb143-49" aria-hidden="true" tabindex="-1"></a>     <span class="cf">for</span> tune <span class="kw">in</span> matched_tunes:</span>
<span id="cb143-50"><a href="#cb143-50" aria-hidden="true" tabindex="-1"></a>         <span class="bu">print</span>(<span class="st">"- </span><span class="sc">{0}</span><span class="st"> (</span><span class="sc">{1:.2f}</span><span class="st"> s)"</span>.<span class="bu">format</span>(tune.name, tune.length))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>We use the usual pattern of defining a <code>filter_tunes_by_name</code> function to perform the search</li>
<li>We then print out the matches as per usual</li>
</ul></li>
<li><p><code>select_tune</code></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a> <span class="kw">def</span> select_tune():</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>     <span class="co">"""</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="co">     Select a tune from tunes matching a user-specified search string</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a><span class="co">     Returns</span></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a><span class="co">     -------</span></span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a><span class="co">     None</span></span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a><span class="co">     See Also</span></span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a><span class="co">     --------</span></span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a><span class="co">     filter_tunes_by_name : handles searching for tunes by name</span></span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a><span class="co">     """</span></span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a>     <span class="bu">print</span>(<span class="st">"Select tune"</span>)</span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a>     search_name <span class="op">=</span> BTCInput.read_text(<span class="st">"Enter name of tune to select: "</span>)</span>
<span id="cb144-15"><a href="#cb144-15" aria-hidden="true" tabindex="-1"></a>     matched_tunes <span class="op">=</span> filter_tunes_by_name(search_name)</span>
<span id="cb144-16"><a href="#cb144-16" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> <span class="bu">len</span>(matched_tunes) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb144-17"><a href="#cb144-17" aria-hidden="true" tabindex="-1"></a>         <span class="bu">print</span>(<span class="st">"No matches found"</span>)</span>
<span id="cb144-18"><a href="#cb144-18" aria-hidden="true" tabindex="-1"></a>         <span class="cf">return</span></span>
<span id="cb144-19"><a href="#cb144-19" aria-hidden="true" tabindex="-1"></a>     <span class="bu">print</span>(<span class="st">"Found </span><span class="sc">{0}</span><span class="st"> matches"</span>.<span class="bu">format</span>(<span class="bu">len</span>(matched_tunes)))</span>
<span id="cb144-20"><a href="#cb144-20" aria-hidden="true" tabindex="-1"></a>     <span class="cf">for</span> tune <span class="kw">in</span> matched_tunes:</span>
<span id="cb144-21"><a href="#cb144-21" aria-hidden="true" tabindex="-1"></a>         select <span class="op">=</span> BTCInput.read_int_ranged(</span>
<span id="cb144-22"><a href="#cb144-22" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Tune: </span><span class="sc">{0}</span><span class="st">, select this tune? (1 - Yes, 0 - No): "</span>.<span class="bu">format</span>(tune.name),</span>
<span id="cb144-23"><a href="#cb144-23" aria-hidden="true" tabindex="-1"></a>             min_value<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb144-24"><a href="#cb144-24" aria-hidden="true" tabindex="-1"></a>             max_value<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb144-25"><a href="#cb144-25" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb144-26"><a href="#cb144-26" aria-hidden="true" tabindex="-1"></a>         <span class="cf">if</span> select:</span>
<span id="cb144-27"><a href="#cb144-27" aria-hidden="true" tabindex="-1"></a>             <span class="kw">global</span> current_tune</span>
<span id="cb144-28"><a href="#cb144-28" aria-hidden="true" tabindex="-1"></a>             current_tune <span class="op">=</span> tune</span>
<span id="cb144-29"><a href="#cb144-29" aria-hidden="true" tabindex="-1"></a>             <span class="cf">break</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Uses <code>filter_tunes_by_name</code> to get matching tunes</li>
<li>User is then prompted for each match if they want to make this the new current tune</li>
<li>Execution stops once they’ve decided to select a new track</li>
</ul></li>
<li><p><code>delete_tune</code></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb145"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a> <span class="kw">def</span> delete_tune():</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>     <span class="co">"""</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="co">     Optionally delete tunes matching a user-specified search string</span></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a><span class="co">     Returns</span></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a><span class="co">     -------</span></span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a><span class="co">     None</span></span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a><span class="co">     See Also</span></span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a><span class="co">     --------</span></span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a><span class="co">     filter_tunes_by_name : handles searching for tunes by name</span></span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a><span class="co">     """</span></span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a>     <span class="bu">print</span>(<span class="st">"Delete tune"</span>)</span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a>     search_name <span class="op">=</span> BTCInput.read_text(<span class="st">"Enter name of tune to select: "</span>)</span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a>     matched_tunes <span class="op">=</span> filter_tunes_by_name(search_name)</span>
<span id="cb145-16"><a href="#cb145-16" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> <span class="bu">len</span>(matched_tunes) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb145-17"><a href="#cb145-17" aria-hidden="true" tabindex="-1"></a>         <span class="bu">print</span>(<span class="st">"No matches found"</span>)</span>
<span id="cb145-18"><a href="#cb145-18" aria-hidden="true" tabindex="-1"></a>         <span class="cf">return</span></span>
<span id="cb145-19"><a href="#cb145-19" aria-hidden="true" tabindex="-1"></a>     <span class="bu">print</span>(<span class="st">"Found </span><span class="sc">{0}</span><span class="st"> matches"</span>.<span class="bu">format</span>(<span class="bu">len</span>(matched_tunes)))</span>
<span id="cb145-20"><a href="#cb145-20" aria-hidden="true" tabindex="-1"></a>     <span class="cf">for</span> tune <span class="kw">in</span> tunes:</span>
<span id="cb145-21"><a href="#cb145-21" aria-hidden="true" tabindex="-1"></a>         select <span class="op">=</span> BTCInput.read_int_ranged(</span>
<span id="cb145-22"><a href="#cb145-22" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Tune: </span><span class="sc">{0}</span><span class="st">, delete this tune? (1 - Yes, 0 - No): "</span>.<span class="bu">format</span>(tune.name),</span>
<span id="cb145-23"><a href="#cb145-23" aria-hidden="true" tabindex="-1"></a>             min_value<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb145-24"><a href="#cb145-24" aria-hidden="true" tabindex="-1"></a>             max_value<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb145-25"><a href="#cb145-25" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb145-26"><a href="#cb145-26" aria-hidden="true" tabindex="-1"></a>         <span class="cf">if</span> select:</span>
<span id="cb145-27"><a href="#cb145-27" aria-hidden="true" tabindex="-1"></a>             <span class="kw">global</span> current_tune</span>
<span id="cb145-28"><a href="#cb145-28" aria-hidden="true" tabindex="-1"></a>             <span class="cf">if</span> tune <span class="op">==</span> current_tune:</span>
<span id="cb145-29"><a href="#cb145-29" aria-hidden="true" tabindex="-1"></a>                 current_tune <span class="op">=</span> no_tune</span>
<span id="cb145-30"><a href="#cb145-30" aria-hidden="true" tabindex="-1"></a>             tunes.remove(tune)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Again, use <code>filter_tunes_by_name</code> to match names</li>
<li>Then prompt the user if they want to delete</li>
<li>Only caveat we have to be careful is that if we delete the currently selected tune we have to set the current tune to <code>no_tune</code> (a null object)</li>
</ul></li>
</ol>
<p>Now, the last thing we have to look at is the edit menu. Our edit menu looks as follows,</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_edit_menu():</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>    first_option_id <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>    last_option_id <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>    edit_tune_menu_template <span class="op">=</span> <span class="st">"""Editing Tune</span></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a><span class="st">Current Tune: </span><span class="sc">{0}</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a><span class="st">1. Rename Tune</span></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a><span class="st">2. Display Tune</span></span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a><span class="st">3. Play Tune</span></span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a><span class="st">4. New Note</span></span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a><span class="st">5. Edit Note</span></span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a><span class="st">6. Remove Note</span></span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a><span class="st">7. Clear Tune</span></span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a><span class="st">8. Finish Editing</span></span>
<span id="cb146-15"><a href="#cb146-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-16"><a href="#cb146-16" aria-hidden="true" tabindex="-1"></a><span class="st">Enter your command: """</span></span>
<span id="cb146-17"><a href="#cb146-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb146-18"><a href="#cb146-18" aria-hidden="true" tabindex="-1"></a>        command <span class="op">=</span> BTCInput.read_int_ranged(</span>
<span id="cb146-19"><a href="#cb146-19" aria-hidden="true" tabindex="-1"></a>            edit_tune_menu_template.<span class="bu">format</span>(current_tune.name),</span>
<span id="cb146-20"><a href="#cb146-20" aria-hidden="true" tabindex="-1"></a>            min_value<span class="op">=</span>first_option_id,</span>
<span id="cb146-21"><a href="#cb146-21" aria-hidden="true" tabindex="-1"></a>            max_value<span class="op">=</span>last_option_id,</span>
<span id="cb146-22"><a href="#cb146-22" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb146-23"><a href="#cb146-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-24"><a href="#cb146-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> command <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb146-25"><a href="#cb146-25" aria-hidden="true" tabindex="-1"></a>            rename_tune()</span>
<span id="cb146-26"><a href="#cb146-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> command <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb146-27"><a href="#cb146-27" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(current_tune)</span>
<span id="cb146-28"><a href="#cb146-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> command <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb146-29"><a href="#cb146-29" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Playing"</span>, current_tune.name)</span>
<span id="cb146-30"><a href="#cb146-30" aria-hidden="true" tabindex="-1"></a>            current_tune.play()</span>
<span id="cb146-31"><a href="#cb146-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> command <span class="op">==</span> <span class="dv">4</span>:</span>
<span id="cb146-32"><a href="#cb146-32" aria-hidden="true" tabindex="-1"></a>            add_note_to_tune()</span>
<span id="cb146-33"><a href="#cb146-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> command <span class="op">==</span> <span class="dv">5</span>:</span>
<span id="cb146-34"><a href="#cb146-34" aria-hidden="true" tabindex="-1"></a>            edit_note()</span>
<span id="cb146-35"><a href="#cb146-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> command <span class="op">==</span> <span class="dv">6</span>:</span>
<span id="cb146-36"><a href="#cb146-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> current_tune.number_of_notes <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb146-37"><a href="#cb146-37" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">"No notes to remove"</span>)</span>
<span id="cb146-38"><a href="#cb146-38" aria-hidden="true" tabindex="-1"></a>            remove_note()</span>
<span id="cb146-39"><a href="#cb146-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> command <span class="op">==</span> <span class="dv">7</span>:</span>
<span id="cb146-40"><a href="#cb146-40" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Cleared"</span>, current_tune.name)</span>
<span id="cb146-41"><a href="#cb146-41" aria-hidden="true" tabindex="-1"></a>            current_tune.clear_tune()</span>
<span id="cb146-42"><a href="#cb146-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> command <span class="op">==</span> <span class="dv">8</span>:</span>
<span id="cb146-43"><a href="#cb146-43" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb146-44"><a href="#cb146-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb146-45"><a href="#cb146-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(</span>
<span id="cb146-46"><a href="#cb146-46" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Unexpected command id: </span><span class="sc">{0}</span><span class="st"> found in Edit Menu"</span>.<span class="bu">format</span>(command)</span>
<span id="cb146-47"><a href="#cb146-47" aria-hidden="true" tabindex="-1"></a>            )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Lets work through these functions</p>
<ol type="1">
<li><p><code>rename_tune</code></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb147"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a> <span class="kw">def</span> rename_tune():</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>     <span class="co">"""</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a><span class="co">     Rename the current tune to a user prompted string</span></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a><span class="co">     Returns</span></span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a><span class="co">     -------</span></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a><span class="co">     None</span></span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a><span class="co">     """</span></span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a>     <span class="bu">print</span>(<span class="st">"Rename current tune"</span>)</span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a>     new_name <span class="op">=</span> prompt_valid_name(<span class="st">"Enter new name (or . to leave unchanged): "</span>)</span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> new_name <span class="op">!=</span> <span class="st">"."</span>:</span>
<span id="cb147-12"><a href="#cb147-12" aria-hidden="true" tabindex="-1"></a>         current_tune.name <span class="op">=</span> new_name</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Reuses the <code>prompt_valid_name</code> function from <code>new_tune</code> to get a new name
<ul>
<li>This has the issue that we can’t write the same name as the current tune</li>
<li>So use <code>.</code> to indicate that we don’t actually want to change</li>
</ul></li>
</ul></li>
<li><p><code>add_note_to_tune</code></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a> <span class="kw">def</span> get_new_note_from_user():</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>     <span class="co">"""</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="co">     Prompts the user for a new Note</span></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a><span class="co">     The user is prompted for the note and duration, and the input validated</span></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a><span class="co">     to ensure that a valid Note object is created</span></span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a><span class="co">     Returns</span></span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a><span class="co">     -------</span></span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a><span class="co">     Note</span></span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a><span class="co">         Note object containing the user specified note id and duration</span></span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a><span class="co">     """</span></span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-14"><a href="#cb148-14" aria-hidden="true" tabindex="-1"></a>     note_prompt <span class="op">=</span> <span class="st">"Enter note (</span><span class="sc">{0}</span><span class="st"> - </span><span class="sc">{1}</span><span class="st">): "</span>.<span class="bu">format</span>(Note.min_note_id, Note.max_note_id)</span>
<span id="cb148-15"><a href="#cb148-15" aria-hidden="true" tabindex="-1"></a>     note <span class="op">=</span> BTCInput.read_int_ranged(</span>
<span id="cb148-16"><a href="#cb148-16" aria-hidden="true" tabindex="-1"></a>         prompt<span class="op">=</span>note_prompt, min_value<span class="op">=</span>Note.min_note_id, max_value<span class="op">=</span>Note.max_note_id</span>
<span id="cb148-17"><a href="#cb148-17" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb148-18"><a href="#cb148-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-19"><a href="#cb148-19" aria-hidden="true" tabindex="-1"></a>     min_note_length <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb148-20"><a href="#cb148-20" aria-hidden="true" tabindex="-1"></a>     max_note_length <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb148-21"><a href="#cb148-21" aria-hidden="true" tabindex="-1"></a>     duration_prompt <span class="op">=</span> <span class="st">"Enter duration (</span><span class="sc">{0}</span><span class="st"> - </span><span class="sc">{1}</span><span class="st">): "</span>.<span class="bu">format</span>(</span>
<span id="cb148-22"><a href="#cb148-22" aria-hidden="true" tabindex="-1"></a>         min_note_length, max_note_length</span>
<span id="cb148-23"><a href="#cb148-23" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb148-24"><a href="#cb148-24" aria-hidden="true" tabindex="-1"></a>     duration <span class="op">=</span> BTCInput.read_float_ranged(</span>
<span id="cb148-25"><a href="#cb148-25" aria-hidden="true" tabindex="-1"></a>         duration_prompt, min_value<span class="op">=</span>min_note_length, max_value<span class="op">=</span>max_note_length</span>
<span id="cb148-26"><a href="#cb148-26" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb148-27"><a href="#cb148-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-28"><a href="#cb148-28" aria-hidden="true" tabindex="-1"></a>     <span class="cf">return</span> Note(note, duration)</span>
<span id="cb148-29"><a href="#cb148-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-30"><a href="#cb148-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-31"><a href="#cb148-31" aria-hidden="true" tabindex="-1"></a> <span class="kw">def</span> add_note_to_tune():</span>
<span id="cb148-32"><a href="#cb148-32" aria-hidden="true" tabindex="-1"></a>     <span class="co">"""</span></span>
<span id="cb148-33"><a href="#cb148-33" aria-hidden="true" tabindex="-1"></a><span class="co">     Adds a note to the current tune</span></span>
<span id="cb148-34"><a href="#cb148-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-35"><a href="#cb148-35" aria-hidden="true" tabindex="-1"></a><span class="co">     Prompts the user to specify a new note as well as an index of</span></span>
<span id="cb148-36"><a href="#cb148-36" aria-hidden="true" tabindex="-1"></a><span class="co">     where to insert the note in the tune (`-1` indicating append). The created</span></span>
<span id="cb148-37"><a href="#cb148-37" aria-hidden="true" tabindex="-1"></a><span class="co">     note is then added to the current tune at the indicated index (or appended)</span></span>
<span id="cb148-38"><a href="#cb148-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-39"><a href="#cb148-39" aria-hidden="true" tabindex="-1"></a><span class="co">     Returns</span></span>
<span id="cb148-40"><a href="#cb148-40" aria-hidden="true" tabindex="-1"></a><span class="co">     -------</span></span>
<span id="cb148-41"><a href="#cb148-41" aria-hidden="true" tabindex="-1"></a><span class="co">     None</span></span>
<span id="cb148-42"><a href="#cb148-42" aria-hidden="true" tabindex="-1"></a><span class="co">     """</span></span>
<span id="cb148-43"><a href="#cb148-43" aria-hidden="true" tabindex="-1"></a>     <span class="bu">print</span>(<span class="st">"Add note to current tune"</span>)</span>
<span id="cb148-44"><a href="#cb148-44" aria-hidden="true" tabindex="-1"></a>     new_note <span class="op">=</span> get_new_note_from_user()</span>
<span id="cb148-45"><a href="#cb148-45" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> current_tune.number_of_notes <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb148-46"><a href="#cb148-46" aria-hidden="true" tabindex="-1"></a>         current_tune.add_note(new_note)</span>
<span id="cb148-47"><a href="#cb148-47" aria-hidden="true" tabindex="-1"></a>         <span class="bu">print</span>(<span class="st">"Added note:"</span>, new_note)</span>
<span id="cb148-48"><a href="#cb148-48" aria-hidden="true" tabindex="-1"></a>         <span class="cf">return</span></span>
<span id="cb148-49"><a href="#cb148-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-50"><a href="#cb148-50" aria-hidden="true" tabindex="-1"></a>     insert_prompt <span class="op">=</span> <span class="st">"Enter index to add note (0 - </span><span class="sc">{0}</span><span class="st">) or -1 to append: "</span>.<span class="bu">format</span>(</span>
<span id="cb148-51"><a href="#cb148-51" aria-hidden="true" tabindex="-1"></a>         current_tune.number_of_notes <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb148-52"><a href="#cb148-52" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb148-53"><a href="#cb148-53" aria-hidden="true" tabindex="-1"></a>     insertion_idx <span class="op">=</span> BTCInput.read_int_ranged(</span>
<span id="cb148-54"><a href="#cb148-54" aria-hidden="true" tabindex="-1"></a>         insert_prompt, <span class="op">-</span><span class="dv">1</span>, current_tune.number_of_notes <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb148-55"><a href="#cb148-55" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb148-56"><a href="#cb148-56" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> insertion_idx <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb148-57"><a href="#cb148-57" aria-hidden="true" tabindex="-1"></a>         insertion_idx <span class="op">=</span> <span class="va">None</span></span>
<span id="cb148-58"><a href="#cb148-58" aria-hidden="true" tabindex="-1"></a>     current_tune.add_note(new_note, insertion_idx)</span>
<span id="cb148-59"><a href="#cb148-59" aria-hidden="true" tabindex="-1"></a>     <span class="bu">print</span>(<span class="st">"Added note:"</span>, new_note)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>We start by defining a function <code>get_new_note_from_user</code>
<ul>
<li>Gets a valid <code>Note</code> object from the user</li>
<li>Uses the class attributes on <code>Note</code> to limit the user’s input for the note id</li>
<li>Enforces a program set limit on the duration</li>
</ul></li>
<li>Then define <code>add_note_to_tune</code>
<ul>
<li>We get a new note from the user</li>
<li>If there’s no notes on the <code>Tune</code> we can immediately add the note to the tune</li>
<li>Otherwise we prompt the user for the index to add
<ul>
<li><span class="math inline">\(-1\)</span> is used to indicate that the value should be appended</li>
</ul></li>
<li>Can then call the <code>add_note</code> method on the <code>Tune</code> object</li>
</ul></li>
</ul></li>
<li><p><code>edit_note</code></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb149"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a> <span class="kw">def</span> edit_note():</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>     <span class="co">"""</span></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a><span class="co">     Modifies an existing note in the current tune</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a><span class="co">     Prompts the user for the index of the existing note to overwrite and</span></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a><span class="co">     then the details of the new note</span></span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a><span class="co">     Returns</span></span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a><span class="co">     -------</span></span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a><span class="co">     None</span></span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a><span class="co">     """</span></span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a>     <span class="bu">print</span>(<span class="st">"Edit note in current tune"</span>)</span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> current_tune.number_of_notes <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a>         <span class="bu">print</span>(<span class="st">"There are no notes in the current tune to edit"</span>)</span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a>         <span class="cf">return</span></span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-17"><a href="#cb149-17" aria-hidden="true" tabindex="-1"></a>     edit_prompt <span class="op">=</span> <span class="st">"Enter index of note to edit (0 - </span><span class="sc">{0}</span><span class="st">): "</span>.<span class="bu">format</span>(</span>
<span id="cb149-18"><a href="#cb149-18" aria-hidden="true" tabindex="-1"></a>         current_tune.number_of_notes <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb149-19"><a href="#cb149-19" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb149-20"><a href="#cb149-20" aria-hidden="true" tabindex="-1"></a>     insertion_idx <span class="op">=</span> BTCInput.read_int_ranged(</span>
<span id="cb149-21"><a href="#cb149-21" aria-hidden="true" tabindex="-1"></a>         edit_prompt, <span class="dv">0</span>, current_tune.number_of_notes <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb149-22"><a href="#cb149-22" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb149-23"><a href="#cb149-23" aria-hidden="true" tabindex="-1"></a>     old_note <span class="op">=</span> current_tune.remove_note(insertion_idx)</span>
<span id="cb149-24"><a href="#cb149-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-25"><a href="#cb149-25" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> insertion_idx <span class="op">==</span> current_tune.number_of_notes:</span>
<span id="cb149-26"><a href="#cb149-26" aria-hidden="true" tabindex="-1"></a>         insertion_idx <span class="op">=</span> <span class="va">None</span>  <span class="co"># we removed the last index, so now need to append</span></span>
<span id="cb149-27"><a href="#cb149-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-28"><a href="#cb149-28" aria-hidden="true" tabindex="-1"></a>     new_note <span class="op">=</span> get_new_note_from_user()</span>
<span id="cb149-29"><a href="#cb149-29" aria-hidden="true" tabindex="-1"></a>     current_tune.add_note(new_note, insertion_idx)</span>
<span id="cb149-30"><a href="#cb149-30" aria-hidden="true" tabindex="-1"></a>     <span class="bu">print</span>(<span class="st">"Note successfully edited"</span>)</span>
<span id="cb149-31"><a href="#cb149-31" aria-hidden="true" tabindex="-1"></a>     <span class="bu">print</span>(<span class="st">"Note was:"</span>, old_note)</span>
<span id="cb149-32"><a href="#cb149-32" aria-hidden="true" tabindex="-1"></a>     <span class="bu">print</span>(<span class="st">"Note now:"</span>, new_note)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Works similar to <code>add_note_to_tune</code>
<ul>
<li>This time however we first prompt the user for which note they want to edit</li>
</ul></li>
<li>We create a new <code>Note</code></li>
<li>“Editing” a note is achieved by removing the old note, and inserting the new note, where the old one was</li>
</ul></li>
<li><p><code>remove_note</code></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb150"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a> <span class="kw">def</span> remove_note():</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>     <span class="co">"""</span></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a><span class="co">     Remove the note at a user prompted index from the current tune</span></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a><span class="co">     Returns</span></span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a><span class="co">     -------</span></span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a><span class="co">     None</span></span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a><span class="co">     """</span></span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a>     <span class="bu">print</span>(<span class="st">"Remove note from current tune"</span>)</span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a>     remove_prompt <span class="op">=</span> <span class="st">"Enter index of note to remove (0 - </span><span class="sc">{0}</span><span class="st">): "</span>.<span class="bu">format</span>(</span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a>         current_tune.number_of_notes <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb150-13"><a href="#cb150-13" aria-hidden="true" tabindex="-1"></a>     remove_idx <span class="op">=</span> BTCInput.read_int_ranged(</span>
<span id="cb150-14"><a href="#cb150-14" aria-hidden="true" tabindex="-1"></a>         remove_prompt, <span class="dv">0</span>, current_tune.number_of_notes <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb150-15"><a href="#cb150-15" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb150-16"><a href="#cb150-16" aria-hidden="true" tabindex="-1"></a>     current_tune.remove_note(remove_idx)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Calling code responsible for ensuring that we don’t call this on an empty tune</li>
<li>Removes the note at the user prompted index</li>
</ul></li>
</ol>
<p>With those functions worked through that covers pretty much all the functionality of the program. You can see the full implementation in <a href="./Exercises/03_TuneCreator/TuneCreator.py">TuneCreator.py</a>. The associated pickle file should load the <a href="#make-something-happen-make-your-own-music">example tunes</a> we created earlier which you can play and edit to test the program</p>
</section>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<ul>
<li>Classes can be used to store data attributes
<ul>
<li>When a class instance is created, the data is stored in the object</li>
<li>The <code>__init__</code> or constructor is a function that can be used to set instance attributes at creation</li>
</ul></li>
<li>Classes can contain method attributes
<ul>
<li>an object can asked to perform a function by calling the method</li>
<li>methods are effectively functions that contain a reference to the object itself as a first argument
<ul>
<li>Traditionally called <code>self</code></li>
</ul></li>
</ul></li>
<li>Classes should strive to be <em>cohesive</em>
<ul>
<li>Methods let us create cohesive classes</li>
<li>Cohesive classes are less reliant on the internals of other classes</li>
<li>self contained objects can validate method calls or data assignments</li>
</ul></li>
<li>Invalid data or failed methods can be handled in two ways
<ul>
<li>return a status message
<ul>
<li>User has the option of ignoring it</li>
</ul></li>
<li>raise an exception
<ul>
<li>User is forced to handle it or the program crashes</li>
</ul></li>
</ul></li>
<li>Python provides mechanisms for protecting data
<ul>
<li>No absolute runtime guarantees</li>
<li><code>_</code> indicates an attribute is supposed to be private to a class</li>
<li><code>__</code> name mangles a variable making it harder to access outside the class</li>
</ul></li>
<li>Static methods can be defined on a class and called without a specific instance</li>
<li>Useful for creating validation methods, that do not rely on specific instance values</li>
<li>Properties let us write methods that behave like attributes
<ul>
<li>Can be used to return values that can be calculated on the fly</li>
<li>Return read-only versions of data attributes</li>
<li>perform data validation on data attribute assignment while still keeping the same syntax i.e.&nbsp;<code>obj.param = new_value</code></li>
</ul></li>
<li>Version management is important whenever you want to store classes that might change long-term
<ul>
<li>You should incorporate methods for upgrading older versions of a class to a new version</li>
</ul></li>
<li>The <code>__str__</code> method is used to define how a class is represented as a string</li>
<li>Python string formatting provides a simple way for creating strings containing formatted variable values</li>
<li>Iterators are objects that can produce elements of a sequence for iteration
<ul>
<li>Iterators can come from a list or a different iterator</li>
</ul></li>
<li><code>map</code> can be used to create an iterator that applies a function to an existing iteration</li>
<li><code>join</code> can be used to merge a list of strings into a larger string</li>
</ul>
</section>
<section id="questions-and-answers" class="level2">
<h2 class="anchored" data-anchor-id="questions-and-answers">Questions and Answers</h2>
<ol type="1">
<li><p><em>Why doesn’t python provide a way for a programmer to completely protect data attributes in an object?</em></p>
<ul>
<li>The creator of python didn’t believe in the traditional object-oriented concepts of public, protected and private variables</li>
<li>Even these techniques can’t protect against a malicious actor with access to your source code
<ul>
<li>They could modify a public function to reveal a private variable</li>
<li>Or they could just add one</li>
</ul></li>
<li>It is important to still be able to review code to ensure it is secure</li>
</ul></li>
<li><p><em>When would we use a property in a program?</em></p>
<ul>
<li>Properties let us control how data attributes are accessed</li>
<li>Properties let us write traditional <code>get</code> and <code>set</code> methods that still behave like simple data attributes</li>
<li>We can also define <em>read-only</em> properties that have no set methods</li>
<li>Properties are good when you want to manage access to data (or validate it) but without the user having to call methods</li>
</ul></li>
<li><p><em>When would we create static class attributes?</em></p>
<ul>
<li>Static class data attributes are useful to store information about a class
<ul>
<li>i.e.&nbsp;independent on any specific object instance</li>
</ul></li>
<li>A good example is data validation values
<ul>
<li>These will typically be common across all instances</li>
</ul></li>
<li>Similarly static method attributes are good for performing this validation</li>
</ul></li>
<li><p><em>Must all objects be highly cohesive?</em></p>
<ul>
<li>Not strictly</li>
<li>It’s about scale
<ul>
<li>For a small program, that does one thing, that will be used once (or a few times by one person)</li>
<li>Little harm in being uncohesive</li>
<li>The time spent making it cohesive as opposed to making it is probably wasted</li>
</ul></li>
<li>An overriding rule is to keep it simple</li>
<li>If a program is likely to be maintained, or developed by multiple people
<ul>
<li>Probably beneficial</li>
<li>Short-term costs of good design are better than the long-term of maintaining a poor design</li>
</ul></li>
<li><a href="#create-a-time-tracker">Time Tracker</a> is pretty close to final product quality</li>
</ul></li>
<li><p><em>What is an iterator again?</em></p>
<ul>
<li>An <em>iterator</em> is an object that provides the <code>__next__</code> method
<ul>
<li>Provides the next value in a sequence</li>
</ul></li>
<li>Some objects, e.g.&nbsp;<code>list</code> behave as iterators</li>
<li>Some methods, e.g.&nbsp;<code>map</code> and <code>range</code> return objects that behave as iterators</li>
<li>Python constructs like <code>for</code> that use iterators can work on <em>any</em> type of iterator
<ul>
<li>So long as it fulfills the protocol (<code>__next__</code> method and raises <code>StopIteration</code>)</li>
<li>construction doesn’t know <em>what</em> its dealing with, just sees the <code>__next__</code> method</li>
<li><code>StopIteration</code> raised once there are no more elements left</li>
</ul></li>
</ul></li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>